- analysis: 'The main focus of the paper is fault detection in automated irrigation
    systems using frequency domain analysis. The paper explores two techniques for
    determining soil moisture content using frequency domain analysis and discusses
    how these techniques can be used to automatically detect probe damage or moisture
    intrusion into the probe''s housing by analyzing changes in the relationship between
    the two techniques'' measurements.


    The paper also discusses how the probe''s cost can be kept below 10 Euros. However,
    the cost of the implementation and maintenance of the automated irrigation system
    as a whole is not discussed.


    Additionally, it is worth noting that the paper does not discuss the accuracy
    of the soil moisture content measurements obtained using the two techniques. Hence,
    the suitability of the proposed fault detection method for practical applications
    cannot be fully evaluated based on the information provided in the paper.'
  authors:
  - Oates M.J.
  - Ramadan K.
  - Molina-Martínez J.M.
  - Ruiz-Canales A.
  citation_count: '22'
  description: Frequency Domain Analysis can be used to determine the moisture content
    of soils. At least two techniques can be used, the first using the soil capacitance
    as part of a low pass filter, measuring the attenuation of a fixed frequency signal,
    the second using the soil capacitance as the controlling component in a variable
    frequency oscillator. Whilst the two techniques demonstrate differing sensitivities
    to different conditions, they demonstrate an acceptably stable reciprocal relationship
    to each other over a wide range of soil moisture conditions. With insulated probes,
    it is possible under field conditions for these probes to be damaged or for moisture
    to creep into the electronics housing. Either of these conditions make the soil
    capacitor appear to ‘leak’ by providing a lower electrically resistive path in
    parallel with the soil capacitance. This resistance affects the measurements of
    the two techniques described above in different ways and thus readings from the
    sensors diverge from their normal relationships. These variations are measureable
    and thus the fault condition can be automatically detected. This can be used to
    flag potential problems in the soil moisture measurements raising an alarm condition,
    or stopping unnecessary irrigation based on erroneous results from a damaged sensor.
    This paper presents results demonstrating these phenomena using a Frequency Domain
    capacitance based sensor costing less than 10 Euros.
  doi: 10.1016/j.agwat.2016.12.002
  full_citation: 'Automatic fault detection in a low cost frequency domain (capacitance
    based) soil moisture sensor

    M.J. Oatesa,∗, K. Ramadana,∗, J.M. Molina-Martíneza, A. Ruiz-Canalesa,∗

    Agricultural Water Management, Volume 183, 31 March 2017, Pages 41-48'
  full_text: '>

    "Skip to main content Skip to article Journals & Books Search Register Sign in
    Brought to you by: University of Nebraska-Lincoln View PDF Download full issue
    Outline Highlights Abstract Keywords 1. Introduction 2. Material and methods 3.
    Results and discussion 4. Conclusions References Cited by (22) Figures (8) Show
    2 more figures Tables (7) Table 1 Table 2 Table 3 Table 4 Table 5 Table 6 Show
    all tables Agricultural Water Management Volume 183, 31 March 2017, Pages 41-48
    Automatic fault detection in a low cost frequency domain (capacitance based) soil
    moisture sensor Author links open overlay panel M.J. Oates a b, K. Ramadan a b,
    J.M. Molina-Martínez c, A. Ruiz-Canales a b Show more Add to Mendeley Share Cite
    https://doi.org/10.1016/j.agwat.2016.12.002 Get rights and content Highlights
    • Two techniques were used for measuring the soil moisture based in Frequency
    Domain Soil Moisture Sensor. • The first used the soil capacitance as part of
    a low pass filter, measuring the attenuation of a fixed frequency signal. • The
    other was using the soil capacitance as the controlling component in a variable
    frequency oscillator. • These techniques provide an automatic way to detect sensor
    damage that can prevent mistakes in irrigation management. Abstract Frequency
    Domain Analysis can be used to determine the moisture content of soils. At least
    two techniques can be used, the first using the soil capacitance as part of a
    low pass filter, measuring the attenuation of a fixed frequency signal, the second
    using the soil capacitance as the controlling component in a variable frequency
    oscillator. Whilst the two techniques demonstrate differing sensitivities to different
    conditions, they demonstrate an acceptably stable reciprocal relationship to each
    other over a wide range of soil moisture conditions. With insulated probes, it
    is possible under field conditions for these probes to be damaged or for moisture
    to creep into the electronics housing. Either of these conditions make the soil
    capacitor appear to ‘leak’ by providing a lower electrically resistive path in
    parallel with the soil capacitance. This resistance affects the measurements of
    the two techniques described above in different ways and thus readings from the
    sensors diverge from their normal relationships. These variations are measureable
    and thus the fault condition can be automatically detected. This can be used to
    flag potential problems in the soil moisture measurements raising an alarm condition,
    or stopping unnecessary irrigation based on erroneous results from a damaged sensor.
    This paper presents results demonstrating these phenomena using a Frequency Domain
    capacitance based sensor costing less than 10 Euros. Previous article in issue
    Next article in issue Keywords FDRIrrigation water managementCalibrationSustainability
    1. Introduction In irrigation management, there are varied techniques for determining
    the water requirements of a crop. These measuring techniques include the determination
    of water requirements by obtaining the volume of water based on a water balance.
    In general, these techniques can be divided into direct measurement or indirect
    measurement of the water requirements of a crop. An example of the first technique
    is lysimetry (Schaetzl and Rothstein, 2016). In this case, there is a direct measuring
    of a parameter (weight, volume, pressure, among others) that is varying over time.
    The indirect techniques are based on indirect measurement of the parameters of
    the water balance. The indirect determining of soil water balance in a crop can
    be obtained by several techniques: remote sensing (Maes et al., 2016); use of
    plant sensors (Torres et al., 2016); use of meteorological sensors (Gao et al.,
    2016) among others and a combination of the previous cited. Another technique
    for determining the water balance based in indirect measurements is the measuring
    of soil moisture. The use of soil-based water measurements is used in a various
    devices (Ojha et al., 2015, Jaguey et al., 2015, Navarro-Hellin et al., 2015,
    Tarange et al., 2015). The ultimate objective of these techniques is to provide
    farmers with information about the most appropriate volumes of irrigation to apply
    in each phenological period of the crop, depending on the desired yield levels
    and other parameters. For determining soil moisture, a great range of sensors
    are used (Vienken et al., 2013). There is a wide range of electrically based soil
    moisture measurement techniques well established in the fields of geophysical
    surveying (Linck and Fassbinder, 2014, Lehmann et al., 2014) and agronomy (Fatas
    et al., 2014, Baghdadi et al., 2014), These include resistivity based methods
    such as the Wenner (Jiao-Jun et al., 2014) and Schlumberger Arrays (Mosuro et
    al., 2012); capacitance based methods such as Frequency Domain Reflectometry (FDR)
    (Al-Asadi and Mouazen, 2014, Jaria and Madramootoo, 2013); Time Domain Reflectometry
    (TDR) (Janik et al., 2014); as well as Radiation based techniques such as the
    Neutron Probe (Kodikara et al., 2014). Whilst low cost implementations of resistive
    based sensors have been suggested in the past (Austin and Rhoades, 1979, Igboama
    and Ugwu, 2011), commercial implementations of these units (for example the Landviser®
    Landmapper®, that include interpretation software for vertical electrical properties
    of the soil) are expensive (typically $500–$1600), lack integrated data-logging
    capabilities, or are simply unavailable. Frequency Domain Reflectometry (FDR)
    or the frequency domain capacitance probe, is used to determine the moisture content
    of soils. The principle of operation of the Frequency Domain capacitance probe
    relies on the fact that the dielectric constant between water and air differs
    by a factor of 80. Thus the presence of water in the soil between the probe plates
    produces a highly significant change in its capacitance, the higher the water
    concentration, the higher the capacitance. This capacitance can then be measured
    by electrical means. As the probe is electrically insulated, there is no direct
    current flow within the soil, and thus the conductive effect of ion based salts
    in the soil is minimized. However different soil types can be expected to display
    different properties (Hanson and Peters, 2000). These capacitance based probes
    are critically dependent on the insulation provided between their plates. Should
    this become damaged, the sensor would give erroneous results, which could however
    still appear to be in normal operational range. This would lead to erroneous irrigation
    decisions. This paper investigates how this damage can be automatically detected
    despite the individual readings appearing to be within normal ranges. For this
    purpose, a low cost Frequency Domain sensor system was designed and implemented
    in an experimental plot. The manuscript includes, firstly, the description of
    the two electrical methods that are used to determine the effective capacitance
    of the probe for the designed sensor system. Moreover, the description of five
    experiments to illustrate the fault detection in the designed sensor system will
    be developed. Subsequently, the obtained results in the five cited experiments
    are discussed. Finally, some conclusions about the experiments and the possibilities
    of the employment of this device for irrigation management are added. 2. Material
    and methods A low cost Frequency Domain sensor system for measuring the soil moisture
    was designed and implemented and this is described in detail in Vázquez de León
    et al., 2015. For the experiments in soil (Experiments 2, 4 and 5 that are explained
    below), an insulated probe was used inserted vertically with its top buried 3
    cm into a hi-silica, clay based soil in an experimental plot without crops. The
    location of the cited soil of the experimental plot is latitude: 37° 57′ 29.60″N
    and longitude: 0° 48′ 4.55″W. The average altitude is 130 m a.s.l. This is located
    in San Miguel de Salinas (Alicante), in the South Eastern Spain. The main part
    of the designed soil moisture sensor system is the probe. The probe consisted
    of a 20 mm × 60 mm printed circuit board (PCB) with two double sided, parallel
    7 mm wide tapered prongs insulated by two coats of varnish, with the PCB, but
    not the plating of the prongs, joined together at the top. The two prongs are
    separated by an air gap of 6 mm. The effective plate area is 500 mm2. This was
    connected to the sensor electronics via a 30 cm multi-strand 0.75 mm2 mains cable
    soldered to the probe. This was surrounded by hot glue to eliminate sharp edges
    before the varnish was applied. To summarise, two electrical methods are used
    here to determine the effective capacitance of the probe. The first involves using
    the probe as the capacitive component of a low pass filter. An Arduino microcontroller
    outputs a fixed frequency square-wave of 250 kHz on pin D3 (and later 125 kHz,
    83.3 kHz and 62.5 kHz). These frequencies were selected to be as high as practical,
    given the limited Gain Bandwidth Product of the LM358 low cost Operational Amplifier,
    and also to be aligned with the corner frequency of the resulting low pass filter.
    The signal is then passed into a 47 K ohm resistor which then connects to one
    terminal of the FDR capacitive probe. The other end of the probe is connected
    to the electrical ground. The junction of the probe and the 47 K resistor is also
    connected to the +ve input of one of the operational amplifiers. This amplifier
    is configured as a near unity gain buffer with a 330R feedback resistor from the
    output to the −ve input. The output is then connected via a 1N4001 diode to a
    ‘peak detector'' circuit consisting of a 1.8 M resistor and 100 nF capacitor connected
    in parallel and both connected to the electrical ground. The output is also connected
    to an analogue to digital converter (ADC) input of the microcontroller. This voltage
    is sampled after a stabilization period of 20 ms after the square-wave signal
    is applied. Once the signal strength has been sampled, the square-wave signal
    is stopped and the microcontroller pin returned to a high impedance state. These
    signal strengths are referred to as SS250, SS125, SS83 and SS62 respectively.
    The second method uses the probe as the capacitive element in an oscillator circuit,
    repeatedly charging and discharging the capacitor as the voltage passes between
    two controlled thresholds. The time taken for the voltage to rise and fall between
    these thresholds is measured on pin D5 over four, half wave oscillation cycles
    to provide an indication of the capacitance value. These are referred to as Time
    to Charge (Tc) and Time to Discharge (Td) respectively and represent double the
    actual periods to improve resolution. For this method the 47 K resistor and the
    first amplifier play no significant part as both are followed by high impedance
    pathways. The Frequency Domain capacitive probe is connected between electrical
    ground and the −ve input of the second amplifier. This is in turn connected via
    a 270 K feedback resistor to the output of the second amplifier. This output is
    also fed back to the +ve input of the second amplifier to change the target threshold
    at which the amplifier switches output state. This threshold is also determined
    by the midpoint of the potential divider from the microcontroller control pin
    output D4, and 0 v, consisting of two further 470 K resistors. The oscillator
    is effectively switched on by setting control pin output D4 high. See Fig. 1.
    Download : Download high-res image (192KB) Download : Download full-size image
    Fig. 1. Circuit diagram of a single probe sensor. The microcontroller used in
    these experiments was an Arduino Pro Mini PCB®, running at 5 v and 16 MHz. Temperature
    measurements were made using a DS18B20 waterproof digital temperature probe, inserted
    3 cm into the soil sample. The unit is powered by 4 AA batteries and an NRF24L01
    2.4 GHz radio transceiver Using a low quiescent current regulator, direct pin
    control of the LM358 power supply, removing the Arduino ‘Power On'' LED and placing
    the radio and microcontroller in sleep mode between readings, this can provide
    power for in excess of 4 months, providing a stand-alone, RF based sensor system
    for less than 10 Euros. Using a CD4052B CMOS dual 4 into 1 analogue switch, 4
    probes can be routed to the amplifiers for negligible cost, or alternatively 2
    probes can be connected allowing their terminals to be crossed over should soil
    polarisation issues become a problem. This can provide data for neighboring locations
    or at multiple depths into the soil. The 4 probe sensor system can cost less than
    12 Euros including IP56 rated box, Frequency Domain probes, DS18B20 temperature
    sensor, LM358 operational amplifier, electronic interfaces and microcontroller.
    This paper describes results from 5 experiments for testing the previously cited
    device. Experiments 1 and 3 were developed in a laboratory. Several components
    (capacitors and resistors respectively) of the main electronic circuit of this
    device are substituted and tested in order to simulate the probe (Experiment 1)
    and simulate damage in the insulation of the probe (Experiment 3). Experiments
    2, 4 and 5 were developed in the experimental plot. In these three experiments
    an insulated probe installed in the field was used. Experiment 1 measures the
    Time to Charge (Tc, in micro seconds), Time to Discharge (Td, in micro seconds)
    & Signal Strength at specified frequencies (SSxxx) with a range of ceramic capacitors
    (from 33 pF to 470 pF) acting as the ‘probe’. Signal strengths were measured in
    approximately 5 mV steps, in the range 0–5 v, however to fit into a convenient
    8 bit byte with improved resolution, the values had an offset of 390 (1.95 V)
    subtracted from them and were then divided by 1.25. This was applied to all Signal
    Strength values to give the SSxxx values reported here. Signal Strengths are also
    shown here as their rescaled reciprocal (rSSxxx = 8000/SSxxx) so that ‘dry soil’
    readings are lower than ‘wet soil’ readings to provide easier comparison with
    the Tc and Td readings. Experiment 2 measures Time to Charge, Discharge & Signal
    Strength with the insulated probe inserted into a hi-silica, clay based soil at
    different moisture levels. Experiment 3 measures Time to Charge, Discharge & Signal
    Strength with capacitors and a range resistors placed in parallel to simulate
    damage to the insulation of either the probe surface or its wiring or moisture
    intrusion into the box of the monitoring electronics. For experiments 1–3 results
    are an average of at least 5 readings, where no deviation greater than 2% was
    observed. In Experiments 4 & 5, readings were taken every 2 min. Experiment 4
    shows results from a 6 day trial using the insulated probe under field conditions
    with 2 irrigation events. Experiment 5 shows results from a sensor deliberately
    manufactured to fail after a short time, inserted into soil that was then watered.
    These two last experiments try to simulate two very common conditions during the
    water management in an irrigation system: irrigation event and fault detection.
    3. Results and discussion Fig. 2 shows the clearly linear relationship between
    the Time to Charge or Discharge for the capacitor against the value of the Capacitance.
    This is not at all surprising, the difference in the slopes being a feature of
    the different resistances though which the current must flow. It also shows the
    near-linear relationship between the rescaled reciprocal of the signal strength
    and the capacitance, however it is clear that the rSS125 plot (reciprocal of Signal
    Strength at 125 kHz) is the straightest line, the rSS250 slope decreasing with
    increased capacitance, whilst the rSS62 slope clearly increases with capacitance.
    The reciprocal signal strength values are here multiplied by 8000 to provide values
    in a comparable numerical range with those of the Time to Charge and Discharge.
    Therefore, as the rSS125 readings and Time to Charge (Tc) and Discharge (Td) all
    appear linear with Capacitance, so the rSS125 readings should appear linear with
    respect to Tc & Td. This is demonstrated in Fig. 3. The slope of the Tc line with
    respect to rSS125 is 0.9728 whilst for Td is 0.5534. Download : Download high-res
    image (205KB) Download : Download full-size image Fig. 2. Time to Discharge and
    Charge and Reciprocal Signal Strengths at different frequencies vs. Capacitance.
    Download : Download high-res image (144KB) Download : Download full-size image
    Fig. 3. Td and Tc vs. rSS125 with Capacitors. It is also clear that there is a
    linear relationship between Td and Tc. Indeed regression analysis shows that with
    an offset of 12.6, Tc is approximately 1.76 times the value of Td. This is shown
    in Table 1 together with a column showing the ratio if this offset is raised to
    16. The reason for this will be explained below. Table 1. Readings and metrics
    with Capacitors. rSS125 Td Tc (Tc + 12.6)/Td (Tc + 16)/Td 35.24229 28 37 1.771429
    1.892857 43.95604 35 48 1.731429 1.828571 60.60606 44 63 1.718182 1.795455 77.6699
    50 78 1.812000 1.880000 105.2632 65 103 1.778462 1.830769 129.0323 79 124 1.729114
    1.772152 177.7778 104 170 1.755769 1.788462 222.2222 135 225 1.760000 1.785185
    Fig. 4 shows the relationship between Td & Tc with respect to rSS125 this time
    from Experiment 2 with the capacitors replaced by the two pronged insulated sensors
    in a soil sample at different levels of moisture. Download : Download high-res
    image (120KB) Download : Download full-size image Fig. 4. Td & Tc vs rSS125 in
    soil. It is clear that this relationship is no longer linear with the initial
    slopes of both the Td and Tc values being considerably greater in this soil experiment
    than in the Capacitor experiment starting at 1.87 for Tc and 1.07 for Td. This
    is calculated from the first 2 sets of readings for each line in Fig. 4. This
    clearly indicates that the soil does not always behave like a simple capacitor.
    As the Fixed Frequency technique operates at considerably higher frequencies than
    the variable frequency technique (more typically 2 kHz–8 kHz) and it is known
    that soil shows a variation in permittivity at different frequencies (Klein and
    Santamarina, 1997, Myounghak et al., 2007), this is to be expected. However the
    Tc to Td ratio remains fairly constant with regression analysis delivering a Tc
    offset of 18.9 which gives a slope of 1.90. This is shown in Table 2, together
    with a column showing the ratio for an offset of 16. As the Tc to Td slopes for
    both Capacitors and Soil are similar, ratio values for a compromise offset of
    16 (approximate average of 12.6 and 18.9) are also given, as was done in Table
    1. This now gives a common metric for both experiments delivering a value in the
    arbitrarily chosen range between 1.75 and 2.05 (1.9 ± 0.15) regardless of soil
    moisture level and temperature. Table 2. Readings and metrics with Soil. rSS125
    Td Tc (Tc + 18.9)/Td (Tc + 16)/Td 42.78075 38 55 1.944737 1.868421 54.42177 55
    88 1.943636 1.890909 66.66667 70 113 1.884286 1.842857 83.33333 86 142 1.87093
    1.837209 103.8961 104 176 1.874038 1.846154 125 113 192 1.866372 1.840708 160
    120 208 1.890833 1.866667 177.7778 122 223 1.982787 1.959016 The results in Fig.
    4 are clearly not linear, however as the offset used to scale the raw Signal Strength
    readings was arbitrarily determined to allow the values to fit in the 0–255 range,
    by changing this rescaling to be ‘Signal Strength − 200/1.25’ (ie. making the
    rSS calculation = 8000/(SS125 + 150), a far better linearised result is obtained.
    This is shown in Fig. 5. Download : Download high-res image (155KB) Download :
    Download full-size image Fig. 5. Linearised Td & Tc vs. rSS125 in soil. Table
    3, Table 4, Table 5 show a selection of results from Experiment 3, as described
    in Material and Methods, where each capacitor value is also bridged in parallel
    with a resistor ranging from 680 K Ohm to 4M7 ohm. This is to simulate damage
    to the insulation of either the probe surface or its wiring or moisture intrusion
    into the box of the monitoring electronics. In all cases, the 680 K resistor caused
    oscillation to stop and so an error indicating value of 499uS is returned. Thus
    only the rSS values are of any interest for this resistor. In all cases it can
    be seen that the smaller the resistor value, the larger the returned rSS value,
    and that this effect increases with increased frequency of the signal. This is
    because the resistor value changes the ‘corner frequency’ of the filter. Valid
    Td values are seen to fall with lower resistor value, whilst Tc values increase,
    as the resistor allows charge to leak from the capacitor thus taking longer to
    charge, but speeding up discharge. What is most important however is that in all
    3 cases shown here (and all other capacitor values tried), whilst the ‘Just cable’
    value for the (Tc + 16)/Td metric is in the ‘valid’ range between 1.75 and 2.05,
    even the 4M7 ohm resistor pushes this metric above 2.12, and even lower values
    of resistor push this value even higher, until invalid Td values are reached.
    This effectively allows the sensor to detect a breach in the electrical insulation
    even when Td, Tc and rSS values all appear to be within valid ranges. Table 3.
    rSS, Td Tc and metric values vs resistors in parallel with the 33 pF Capacitor.
    Resistance rSS250 rSS125 rSS83 rSS62 Td Tc (Tc + 16)/Td 680 K 91.95402 46.24277
    35.55556 34.18803 499 499 1.0320641 1M2 84.21053 43.71585 34.48276 33.61345 28
    102 4.2142857 2M0 80.80808 42.55319 34.18803 33.4728 30 64 2.6666667 4M7 77.6699
    41.45078 34.18803 33.61345 31 50 2.1290323 Just cable 74.76636 40.60914 34.04255
    33.61345 32 45 1.90625 Table 4. rSS, Td Tc and metric values vs resistors in parallel
    with the 115 pF Capacitor. Resistance rSS250 rSS125 rSS83 rSS62 Td Tc (Tc + 16)/Td
    680 K 285.7143 108.1081 67.79661 51.28205 499 499 1.0320641 1M2 228.5714 98.76543
    64 48.48485 47 199 4.5744681 2M0 200 93.02326 61.53846 47.33728 49 122 2.8163265
    4M7 186.0465 89.88764 59.70149 46.24277 52 97 2.1730769 Just cable 173.913 86.02151
    58.39416 45.19774 54 84 1.8518519 Table 5. rSS, Td Tc and metric values vs resistors
    in parallel with the 470 pF Capacitor. Resistance rSS250 rSS125 rSS83 rSS62 Td
    Tc (Tc + 16)/Td 680 K 8000 571.4286 275.8621 181.8182 499 499 1.0320641 1M2 1000
    380.9524 222.2222 156.8627 113 499 4.5575221 2M0 615.3846 320 195.122 142.8571
    121 335 2.9008264 4M7 470.5882 275.8621 177.7778 133.3333 129 263 2.1627907 Just
    cable 421.0526 250 170.2128 129.0323 137 229 1.7883212 Table 6 shows the rSS,
    Td, Tc and metric values for each of the 8 capacitors with the 4M7 ohm resistor
    in parallel with the capacitor. It should be noted that the (Tc + 16)/Td metric
    has now risen above the 2.05 threshold to at least 2.12 for all capacitor values,
    allowing the sensor to detect a breach in the electrical insulation even though
    Td, Tc and rSS values all appear to be within valid ranges. The Tc vs rSS125 slope
    is 0.927 and the Td vs rSS125 slope is 0.414, little changed from the 0.973 and
    0.553 seen for the capacitors without parallel resistors. Table 6. rSS, Td Tc
    and metric values vs Capacitances in parallel with the 4M7 Ohm Resistor. Capacitance
    rSS125 Td Tc (Tc + 16)/Td 33 41.66667 31 50 2.129032 55 52.28758 36 63 2.194444
    82 71.42857 45 80 2.133333 115 90.90909 52 97 2.173077 173 119.403 64 124 2.1875
    220 153.8462 77 154 2.207792 320 200 96 191 2.15625 470 285.7143 129 263 2.162791
    Table 7 shows the rSS, Td, Tc and metric values for each of the 8 capacitors with
    the 1M2 ohm resistor in parallel with the capacitor. It should be noted that the
    (Tc + 16)/Td metric is now well above the 2.05 threshold at least 4.21 for all
    capacitor values, allowing the sensor to detect a breach in the electrical insulation
    even though Td, Tc and rSS values all appear to be within valid ranges. The Tc
    vs rSS125 slope is now 1.643, closer to the 1.87 value seen for soil, however
    the Td vs rSS125 slope value has now fallen to 0.3375, well below the 1.07 seen
    for soil and even less than that seen with the 4M7 ohm resistor. It is worth noting
    that as the resistance has decreased, the Tc slope has increased whilst the Td
    slope has decreased, because the resistor allows charge to leak from the capacitor
    thus taking longer to charge, but speeding up discharge. Table 7. rSS, Td Tc and
    metric values vs Capacitances in parallel with the 1M2 Ohm Resistor. Capacitance
    rSS124 Td Tc (Tc + 16)/Td 33 43.95604 28 102 4.214286 55 55.55556 32 126 4.4375
    82 76.92308 40 163 4.475 115 100 47 199 4.574468 173 137.931 56 260 4.928571 220
    181.8182 66 320 5.090909 320 258.0645 83 406 5.084337 470 400 113 499 4.557522
    Fig. 6 shows the Td & Tc vs rSS125 readings with 1M2 resistor & all 8 values of
    capacitance. In contrast with Fig. 3, it can clearly be seen that the slopes of
    both plots are reducing with increased capacitance and that Tc and rSS125 readings
    are significantly increased (by factor of approximately 2). However the capacitor
    based readings and slopes are still significantly different from those of the
    soil based experiment (Fig. 4) suggesting that further experiments with other
    soil types might yield more varied results. Provided the (Tc + 16)/Td metric remains
    stable, other metrics may then be derivable which may be usable to distinguish
    specific soil types and/or compositions. Further experiments in this area are
    planned. Download : Download high-res image (141KB) Download : Download full-size
    image Fig. 6. Td & Tc vs. rSS125 for Capacitors with 1M2 ohm parallel resistor.
    Fig. 7 shows the results from Experiment 4, a 6 day field trial of the system
    in which data was collected every 2 min. For the first 4 days (readings 1 thru
    3200) the soil is allowed to dry naturally by evaporation. The daily temperature
    cycles of the soil and the inside the box of the monitoring electronics are shown
    at the top of the plot ranging from around 20–45 ° centigrade. The next plot shows
    the (Tc + 16)/Td metric multiplied by 100 to give plotted values comparable with
    the Td & rSS125 readings. This value can be seen to range between 175 and 205
    (1.75 and 2.05) regardless of soil or box temperature and remains within these
    limits after both irrigation events (at around readings 3260 & 3960). Both the
    rSS125 and Td readings can clearly be seen to fall over the first 4 days, being
    affected slightly by temperature, and this effect is explored in another communication
    (Oates et al., 2016). However both techniques are seen to strongly respond to
    the irrigation events on the mornings of day 5 and 6. The (Tc + 16)/Td metric
    however, remains within the acceptable 1.75–2.05 range. In fact the drop seen
    in the metric around reading 3250 actually occurs 7 readings after the step change
    in rSS125 and Td (some 35 min) and is more attributable to the change in electronics
    temperature Tbox. Indeed similar but smaller drops in the metric can be seen on
    non-irrigation days 3 and 4 coinciding with rapid morning temperature increases.
    The effects of temperature on these probes is investigated and reported on in
    Oates et al. (2016). Download : Download high-res image (260KB) Download : Download
    full-size image Fig. 7. Results from 6 day field trial in soil with 2 irrigation
    events. Finally, results are given with a 2 prong sensor deliberately manufactured
    to fail after a short time. The varnish coating was made incomplete around the
    hot glue surrounding the electrical connections between the cable and the sensor
    itself. This allowed for water ingress slowly seeping into the sensor allowing
    a resistive path for the charging and discharging currents. This resistance would
    become lower and lower as more water seeped into the sensor. Fig. 8 shows the
    raw SS125 value, the Td and Tc values and the (Tc + 16)/Td metric value (in black).
    Water is added to the soil after only a few readings, which is seen to change
    the SS125, Td and Tc values at reading 4, but with little change in our ratio
    metric. However around reading 126 the SS125 value is seen to fall slightly with
    the Td value also falling and Tc rising. At this point, the metric value first
    rises above our 2.05 limit, indicating a problem with the sensor. After this,
    the Td and Tc values continue to diverge with the metric value reaching over 4
    by reading 142. After this, Tc (and hence metric) values start to become erratic
    due to a feature of the logging software using an overload value of 499 for individual
    readings that exceed its normal range, as the result is averaged over 16 readings.
    Download : Download high-res image (191KB) Download : Download full-size image
    Fig. 8. Results from a deliberately damaged sensor field trial in soil. 4. Conclusions
    By utilising two different capacitive measurement techniques on the same probe,
    one based on a fixed frequency principle the other on a variable frequency, distinction
    of experimental conditions can be determined. In terms of raw resolution, the
    fixed frequency Signal Strength technique is more sensitive to dry soil conditions
    than the variable frequency Time to Charge/Discharge technique. By looking at
    the ratio of Time to Charge vs Time to Discharge, it can be determined if the
    probe or sensor electronics have been affected by damage or condensation regardless
    of soil or box temperature or the soil moisture level. This is true even though
    the readings themselves appear to be within normal ranges. This provides an automatic
    way to detect sensor damage and likely imminent failure. This is essential to
    avoid incorrect or inappropriate irrigation and can be used to allow the sensor
    to transmit a ‘detected error’ condition. This paper provides the principles of
    a very simple fault detector in a capacitance soil moisture sensor system. The
    installation in the sensor system of a device that detect the values of the ratio
    ‘Time to Charge vs Time to Discharge’ out of a determined range can avoid the
    bad operation of these sensors. Subsequently, the irrigation water management
    can be improved. Additionally, these techniques provide farmers with information
    about the most appropriate volumes of irrigation to apply in each phenological
    period of the crop. Furthermore, the study provides the basis for future experiments
    where researchers could take into account new soil types, irrigation systems,
    crop management, among others, in order to improve the final device. References
    Al-Asadi and Mouazen, 2014 R.A. Al-Asadi, A.M. Mouazen Combining frequency domain
    reflectometry and visible and near infrared spectroscopy for assessment of soil
    bulk density Soil Tillage Res., 135 (2014), pp. 60-70 View PDFView articleView
    in ScopusGoogle Scholar Austin and Rhoades, 1979 R.S. Austin, J.D. Rhoades A compact
    low cost circuit for reading four-electrode salinity sensors J. Soil Sci. Soc.
    Am., 43 (1979), pp. 808-809 CrossRefGoogle Scholar Baghdadi et al., 2014 N. Baghdadi,
    P. Dubois-Fernandez, X. Dupuis, M. Zribi Sensitivity of main polarimetric parameters
    of multifrequency polarimetric SAR data to soil moisture and surface roughness
    over bare agricultural soils IEEE Geosci. Remote Sens. Lett., 10 (4) (2014), pp.
    731-735 Google Scholar Fatas et al., 2014 E. Fatas, J. Vicente, B. Latorre, F.
    Lera, V. Vinals, M.V. Lopez, N. Blanco, C. Pena, C. Gonzalez-Cebollada, D. Moret-Fernandez
    TDR-LAB 2.0 Improved TDR Software for soil water content and electrical conductivity
    measurements Proc. Environ. Sci., 19 (2014), pp. 474-483 FOUR DECADES OF PROGRESS
    IN MONITORING AND MODELING OF PROCESSES IN THE SOIL-PLANT-ATMOSPHERE SYSTEM: APPLICATIONS
    AND CHALLENGES Google Scholar Gao et al., 2016 X.L. Gao, S.Z. Peng, W.G. Wang,
    J.Z. Xu, S.H. Yang Spatial and temporal distribution characteristics of reference
    evapotranspiration trends in Karst area: a case study in Guizhou Province, China
    Meteorol. Atmos. Phys., 128 (5) (2016), pp. 677-688 CrossRefView in ScopusGoogle
    Scholar Hanson and Peters, 2000 B.R. Hanson, D.W. Peters Soil types affects accuracy
    of dielectric moisture sensors Calif. Agric., 54 (3) (2000), pp. 43-47 CrossRefGoogle
    Scholar Igboama and Ugwu, 2011 W.N. Igboama, N.U. Ugwu Fabrication of resistivity
    meter and its evaluation Am. J. Sci. Ind. Res., 2 (5) (2011), pp. 713-717 CrossRefGoogle
    Scholar Jaguey et al., 2015 J.G. Jaguey, J.F. Villa-Medina, A. Lopez-Guzman, M.A.
    Porta-Gandara Smartphone irrigation sensor IEEE Sens. J., 15 (9) (2015), pp. 5122-5127
    View in ScopusGoogle Scholar Janik et al., 2014 G. Janik, W. Skierucha, M. Blas,
    M. Sobik, M. Albert, M. Dubicki, A. Zawada TDR technique for estimating the intensity
    of effective non rainfall Int. Agrophys., 28 (1) (2014), pp. 23-37 CrossRefView
    in ScopusGoogle Scholar Jaria and Madramootoo, 2013 F. Jaria, C.A. Madramootoo
    Thresholds for irrigation management of processing tomatoes using soil moisture
    sensors in Southwestern Ontario Trans. ASABE, 56 (1) (2013), pp. 155-166 View
    in ScopusGoogle Scholar Jiao-Jun et al., 2014 Z. Jiao-Jun, K. Hong-Zhang, Y. Gonda
    Application of Wenner configuration to estimate soil water content in pine plantations
    on sandy land Pedosphere, 17 (6) (2014), pp. 801-812 Google Scholar Klein and
    Santamarina, 1997 K. Klein, J.C. Santamarina Methods for broad-band dielectric
    permittivity measurements (soil–water mixtures, 5 Hz to 1. 3 GHz) Geotech. Test.
    J., 20 (2) (1997), pp. 168-178 CrossRefView in ScopusGoogle Scholar Kodikara et
    al., 2014 J. Kodikara, P. Rajeev, D. Chan, C. Gallage Soil moisture monitoring
    at the field scale using neutron probe Can. Geotech. J., 51 (3) (2014), pp. 332-345
    CrossRefView in ScopusGoogle Scholar Lehmann et al., 2014 P. Lehmann, F. Gambazzi,
    B. Suski, L. Baron, A. Askarinejad, S.M. Springman, K. Holliger, D. Or Evolution
    of soil wetting patterns preceding a hydrologically induced landslide inferred
    from electrical resistivity survey and point measurements of volumetric water
    content and pore water pressure WaterResour. Res., 49 (12) (2014), pp. 7992-8004
    Google Scholar Linck and Fassbinder, 2014 R. Linck, J.W.E. Fassbinder Determination
    of the influence of soil parameters and sample density on ground-penetrating radar:
    a case study of a Roman picket in Lower Bavaria Archaeol. Anthropol. Sci., 6 (1)
    (2014), pp. 93-106 CrossRefView in ScopusGoogle Scholar Maes et al., 2016 W.H.
    Maes, A. Baert, A.R. Huete, P.E.H. Minchin, W.P. Snelgar, K. Steppe A new wet
    reference target method for continuous infrared thermography of vegetations Agric.
    Forest Meteorol., 226 (2016), pp. 119-131 View PDFView articleView in ScopusGoogle
    Scholar Mosuro et al., 2012 G.O. Mosuro, O.O. Bayewu, M.O. Oloruntola Application
    of vertical electric soundings for foundation investigation in a basement complex
    terrain: a case study of Ijebu Igbo, Southwestern Nigeria Near-Surface Geophysics
    and Environment Protection (2012), pp. 29-34 Google Scholar Myounghak et al.,
    2007 O. Myounghak, K. Yongsung, P. Junboum Factors affecting the complex permittivity
    spectrum of soil at a low frequency range of 1 kHz–10 MHz Environ. Geol., 51 (January
    (5)) (2007), pp. 821-833 Google Scholar Navarro-Hellin et al., 2015 H. Navarro-Hellin,
    R. Torres-Sanchez, F. Soto-Valles, C. Albaladejo-Perez, J.A. Lopez-Riquelme, R.
    Domingo-Miguel A wireless sensors architecture for efficient irrigation water
    management Agric. Water Manage., 151 (2015), pp. 64-74 View PDFView articleView
    in ScopusGoogle Scholar Oates et al., 2016 M. Oates, A. Fernandez Lopez, A. Ruiz
    Canales, A.L. Vazquez de Leon Temperature compensation in a low cost FDR based
    Soil Moisture Sensor Procs of SNIH16, II Simposio Nacional De Ingeniería Hortícola.
    Sociedad Española De Ciencias Hortícolas. Actas De Horticultura, 72, Almería (Spain),
    February 10–12 (2016) Google Scholar Ojha et al., 2015 T. Ojha, S. Misra, N.S.
    Raghuwanshi Wireless sensor networks for agriculture: the state-of-the-art in
    practice and future challenges Comput. Electron. Agric., 118 (2015), pp. 66-84
    View PDFView articleView in ScopusGoogle Scholar Schaetzl and Rothstein, 2016
    R.J. Schaetzl, D.E. Rothstein Temporal variation in the strength of podzolization
    as indicated by lysimeter data Geoderma, 282 (2016), pp. 26-36 View PDFView articleView
    in ScopusGoogle Scholar Tarange et al., 2015 Web based Automatic Irrigation System
    using wireless sensor network and Embedded Linux board. 2015 INTERNATIONAL CONFERENCED
    ON CIRCUITS, POWER AND COMPUTING TECHNOLOGIES (ICCPCT-2015). Noorul Islam Univ,
    Noorul Islam Ctr Higher Educ, Dept Elect & Elect Engn; IEEE. Google Scholar Torres
    et al., 2016 V. Torres, I. Palacios, J.C. Iriarte, I. Liberal, L.G. Santesteban,
    C. Miranda, J.B. Royo, R. Gonzalo Monitoring water status of grapevine by means
    of THz waves J. Infrared Millimeter Waves, 37 (5) (2016), pp. 507-513 CrossRefView
    in ScopusGoogle Scholar Vázquez de León et al., 2015 Vázquez de León A., Oates,
    M., Molina Martínez J.M. and Ruiz Canales A., 2015. Frequency response and cost
    trade-off for a low-cost FDR capacitance based sensor for soil moisture measurement
    and irrigation control, Procs VIII Congress AgroIngenieria (in press). Google
    Scholar Vienken et al., 2013 T. Vienken, E. Reboulet, C. Leven, M. Kreck, L. Zschornack,
    P. Dietrich Field comparison of selected methods for vertical soil water content
    profiling J. Hydrol., 501 (2013), pp. 205-212 View PDFView articleView in ScopusGoogle
    Scholar Cited by (22) Data reliability and fault diagnostic for air quality monitoring
    station based on low cost sensors and active redundancy 2023, Measurement: Journal
    of the International Measurement Confederation Show abstract Effect of soil moisture
    content on thermal performance of ground source heat exchangers: An electromagnetism
    topology-based analysis 2023, Energy Reports Show abstract Temperature tracer
    method in structural health monitoring: A review 2022, Measurement: Journal of
    the International Measurement Confederation Citation Excerpt : However, the drying
    method cannot quickly measure the moisture content of the in-situ soil, and is
    only suitable for laboratory or indoor measurement. In recent years, capacitance
    method [61–65] based on capacitance sensing principle has also received great
    attention. This method mainly uses capacitance sensor to measure the capacitance
    of the circuit with rock and soil as the medium. Show abstract Sensors and frequencies
    of soil water content measurement affecting agro-hydrological simulations and
    irrigation management 2022, Computers and Electronics in Agriculture Citation
    Excerpt : Although TDR sensors present good precision on the SWC estimation, these
    instruments present a high acquisition cost. Therefore, capacitive sensors are
    an alternative, as they can be built at low-cost and with embedded platforms and
    of easy access (Oates et al., 2017; Nagahage et al., 2019; Placidi et al., 2020).
    The capacitive sensors are constituted by an oscillator that quantifies square
    shape waves, relative to charge or discharge of its capacitors. Show abstract
    Physico-mechanical properties of thick paleosol in Q<inf>1</inf> strata of the
    Chinese Loess Plateau and their variations during tunnel excavation 2021, Engineering
    Geology Citation Excerpt : The FDR WCS is based on the principle of electromagnetic
    pulse. According to the propagating frequency of electromagnetic waves in the
    soil, the FDR WCS measures the apparent permittivity of the soil to obtain the
    volume water content of the soil (Skierucha and Wilczek, 2010; Susha Lekshmi et
    al., 2014; Oatesa et al., 2017). On the basis of the measured volume water content,
    the mass water content of the soil was calculated indoors according to the relationship
    between volume water content and mass water content. Show abstract A calibration-free
    capacitive moisture detection method for multiple soil environments 2021, Measurement:
    Journal of the International Measurement Confederation Show abstract View all
    citing articles on Scopus View Abstract © 2016 Elsevier B.V. All rights reserved.
    Part of special issue Special Issue: Advances on ICTs for Water Management in
    Agriculture: Overseen by: J.E. Fernández Edited by Manuel Ferrández-Villena, Antonio
    Ruiz-Canales Download full issue Other articles from this issue Energy and water
    management for drip-irrigation of tomatoes in a semi- arid district 31 March 2017
    Imene Yahyaoui, …, Marcello Vieira Segatto View PDF Evaluation of event-based
    irrigation system control scheme for tomato crops in greenhouses 31 March 2017
    A. Pawlowski, …, S. Dormido View PDF Irrigation management of greenhouse zucchini
    with different soil matric potential level. Agronomic and environmental effects
    31 March 2017 J.I. Contreras, …, R. Baeza View PDF View more articles Recommended
    articles Article Metrics Citations Citation Indexes: 22 Captures Readers: 60 View
    details About ScienceDirect Remote access Shopping cart Advertise Contact and
    support Terms and conditions Privacy policy Cookies are used by this site. Cookie
    settings | Your Privacy Choices All content on this site: Copyright © 2024 Elsevier
    B.V., its licensors, and contributors. All rights are reserved, including those
    for text and data mining, AI training, and similar technologies. For all open
    access content, the Creative Commons licensing terms apply."'
  inline_citation: null
  journal: Agricultural Water Management
  limitations: The paper does not discuss the accuracy of the soil moisture content
    measurements obtained using the two techniques. Hence, the suitability of the
    proposed fault detection method for practical applications cannot be fully evaluated
    based on the information provided in the paper.
  relevance_score: 0.8
  relevance_score1: 0
  relevance_score2: 0
  title: Automatic fault detection in a low cost frequency domain (capacitance based)
    soil moisture sensor
  verbatim_quote1: '"With insulated probes, it is possible under field conditions
    for these probes to be damaged or for moisture to creep into the electronics housing.
    Either of these conditions make the soil capacitor appear to ‘leak’ by providing
    a lower electrically resistive path in parallel with the soil capacitance."'
  verbatim_quote2: '"This resistance affects the measurements of the two techniques
    described above in different ways and thus readings from the sensors diverge from
    their normal relationships."'
  verbatim_quote3: '"These variations are measurable and thus the fault condition
    can be automatically detected."'
- analysis: "The paper provides a methodology for detecting and isolating fault events\
    \ in irrigation canals through data reconciliation. Fault detection methods are\
    \ investigated based on local or global data reconciliation for detection of sensor/actuator\
    \ faults and unmeasured withdrawals, respectively, and their combination for event\
    \ isolation. A case study is presented using data from the Canal de Gignac to\
    \ evaluate and demonstrate the methodology with respect to static and dynamic\
    \ data reconciliation and a combination of local and global approaches for fault\
    \ detection. The methodology has the benefit of being applicable in scenarios\
    \ with limited sensor information for validation and is assessed for use in real-time\
    \ fault detection and isolation for automated irrigation canal management. \n\n\
    The paper contributes to the literature by offering a combined approach that addresses\
    \ limitations in prior research methods. Specifically, the methodology can distinguish\
    \ between unmeasured withdrawals and sensor or actuator faults, which is a unique\
    \ element and improvement over current methods."
  authors:
  - Bedjaoui N.
  - Litrico X.
  - Koenig D.
  - Ribot-Bruno J.
  - Malaterre P.O.
  citation_count: '11'
  description: This paper deals with the problem of fault detection and isolation
    in irrigation canals. We have developed a method which combines static and dynamic
    data reconciliation for the validation of measurements, detection, and isolation
    of sensors and actuator faults and reconstruction of missing data. Static data
    reconciliation uses static models at a regulation gate to validate measurements
    and detect sensor and actuator faults. It also enabled us to detect a drift in
    the stage discharge rating curve. The dynamic data reconciliation uses additional
    measurements and a dynamic model of the canal in order to validate measurements
    and detect faults and withdrawals. The combination of the two methods allowed
    us to distinguish between withdrawals and faults. Both methods are evaluated on
    measurements from a real irrigation canal located in the South of France. © 2008
    ASCE.
  doi: 10.1061/(ASCE)0733-9437(2008)134:6(778)
  full_citation: Bedjaoui, N. et al. (2008). Static and Dynamic Data Reconciliation
    for an Irrigation Canal. Journal of Irrigation and Drainage Engineering, 134(6),
    778–787. https://doi.org/10.1061/(ASCE)0733-9437(2008)134:6(778)
  full_text: '>

    "This website uses cookies to ensure you get the best experience on our website.
    Learn more GOT IT! Access provided by University of Nebraska-Lincoln Search term(s)
    SEARCH Login / Register Skip main navigation JOURNALS BOOKS MAGAZINES AUTHOR CENTER
    USER SERVICES TOPICS SUBMIT SUBSCRIBE RECOMMEND JOURNAL HOME CURRENT ISSUE ALL
    ISSUES ABOUT HomeJournal of Irrigation and Drainage EngineeringArchiveVol. 134,
    No. 6 PREVIOUS ARTICLE NEXT ARTICLE TECHNICAL PAPERS Dec 1, 2008 Static and Dynamic
    Data Reconciliation for an Irrigation Canal Authors: N. Bedjaoui nadia.bedjaoui@cemagref.fr,
    X. Litrico xavier.litrico@cemagref.fr, D. Koenig damien.koenig@inpg.fr, J. Ribot-Bruno
    jose.ribot-bruno@cemagref.fr, and P.-O. Malaterre pierre-olivier.malaterre@cemagref.frAUTHOR
    AFFILIATIONS Publication: Journal of Irrigation and Drainage Engineering Volume
    134, Issue 6 https://doi.org/10.1061/(ASCE)0733-9437(2008)134:6(778) 76 10 PDF
    Journal of Irrigation and Drainage Engineering Volume 134, Issue 6 December 2008
    Abstract Introduction Problem Statement Data Reconciliation Application to Canal
    de Gignac Conclusion Notation Acknowledgments References Information & Authors
    Metrics & Citations References Media Tables Share Abstract This paper deals with
    the problem of fault detection and isolation in irrigation canals. We have developed
    a method which combines static and dynamic data reconciliation for the validation
    of measurements, detection, and isolation of sensors and actuator faults and reconstruction
    of missing data. Static data reconciliation uses static models at a regulation
    gate to validate measurements and detect sensor and actuator faults. It also enabled
    us to detect a drift in the stage discharge rating curve. The dynamic data reconciliation
    uses additional measurements and a dynamic model of the canal in order to validate
    measurements and detect faults and withdrawals. The combination of the two methods
    allowed us to distinguish between withdrawals and faults. Both methods are evaluated
    on measurements from a real irrigation canal located in the South of France. Introduction
    Irrigation represents more than 80% of world fresh water consumption, and most
    of the irrigation systems use an open channel to convey water from the source
    to the users. The majority of open-channel irrigation canals are managed manually,
    with large water losses leading to low efficiency. It is widely accepted that
    automation can improve water distribution and reduce operational water losses
    (Plusquellec et al. 1994). But automated systems need to be closely monitored,
    in order to ensure a proper functioning and detect faults that may affect sensors
    or actuators. It may appear simple to detect a fault for a human supervisor. This
    may be true for a simple system with perfect measurements. In practice, however,
    a measurement is never perfect but always affected by noise. In this case, it
    is not so easy even for a human supervisor to determine whether a measurement
    is erroneous—the presence of faults—or reliable—the absence of faults. A solution
    that is often used, for example, in aeronautics is to equip the system with redundant
    sensors. Using multiple sensors to measure the same physical variable enables
    us to detect whether one sensor is faulty. This method is very simple (only based
    on material), but it is, however, rather expensive, and very few canals are equipped
    with redundant sensors. This is why it is interesting to develop a method based
    on analytical redundancy, which uses one sensor for each measured variable, and
    various models that express physical links between those variables. The general
    research line on this subject is called fault detection and isolation (FDI), since
    the objectives are (1) to detect possible faults; and (2) to isolate them if possible.
    In practice, the main faults that can occur in an irrigation canal are of three
    kinds: 1. Actuator fault (e.g., a floating object that tampers the gate), which
    can be represented by a bias on the inputs; 2. Sensor fault (here on the water
    level measurements), which can be represented by a bias on the output; and 3.
    Unmeasured discharge withdrawal occurring at the downstream end of the pool. There
    are different ways to achieve supervision in order to detect and isolate such
    faults. In Koenig et al. (2005), a bank of unknown input observers is used to
    detect and isolate actuator faults. In Bedjaoui et al. (2006), the observers are
    improved to minimize the H ∞ norm of a specified transfer function in order to
    consider the case of coupled faults. In Deltour et al. (2005), a supervisory monitoring
    based on data reconciliation is developed for supervision of the Canal de Provence,
    a large scale system located in the south of France. It is an effective and simple
    method, which uses a nodal network model of the canal such that each node represents
    a mass balance equation. The method consists of checking the coherence of daily
    measurements with this model in order to validate measurements, detect and isolate
    gross errors, and reconstruct missing data. Such a method appears to be very interesting
    for a manager, but its main drawback is that it neglects the canal dynamics and
    is not able to detect errors in time. The main objective of this paper is then
    to improve this method by developing a generic methodology based on data reconciliation
    which achieves real-time fault detection and isolation for a supervised irrigation
    canal. We first perform static data reconciliation at regulation gates in order
    to detect and isolate sensors and actuators faults. We then use a dynamic model
    of open-channel flow in order to perform dynamic data reconciliation between two
    regulation gates. This enables us to detect unmeasured withdrawals. The proposed
    method is validated on real data from the Canal de Gignac, an irrigation canal
    located in the South of France, equipped with a set of sensors, automated gates,
    and a centralized supervisory control and data acquisition (SCADA) system. This
    paper is organized as follows: “Problem Statement” includes the problem statement
    and describes the developed methodology. “Data Reconciliation” explains the data
    reconciliation principle in the static and dynamic cases. “Application to Canal
    de Gignac” illustrates the main results of the methodology on real data from Gignac
    canal. Problem Statement An irrigation canal can be represented as a series of
    pools separated by regulation gates. In most canals, measurement devices such
    as water level sensors, gate position sensors, and in some cases velocity sensors
    are available close to the regulation gates. Fig. 1 represents a canal with gates,
    water level sensors h i , gate position sensors u i , and a velocity sensor v
    . Fig. 1. Schematic view of canal with two pools In this paper we consider three
    following kinds of faults that can occur in irrigation canals: 1. Actuator fault
    (e.g., a floating object that tampers the gate), which can affect the gate position
    u i ; 2. Sensor fault which can affect the water level measurements h i or the
    velocity measurement v ; and 3. Unmeasured discharge withdrawal occurring along
    the pool. The total withdrawal discharge can be represented at the downstream
    end of the pool represented as p i . It should be noted that locally, an actuator
    or a sensor fault has the same effect on the discharge that it has on a withdrawal.
    Indeed, a floating object that tampers the gate u 2 reduces the gate opening section,
    leading to a gate discharge lower than what it should be. This has locally the
    same effect as a withdrawal. In the same way, a bias occurring, for example, on
    a water level sensor h 1 will affect the discharge estimation given by the gate
    equation. If this fault is not detected, the manager may want to correct the discharge
    by adjusting the gate opening. This will have an effect on the water distribution,
    in the same way as an unpredicted variation of discharge withdrawal. It is therefore
    of utmost importance for the manager to be able to detect such faults, as soon
    as they occur if possible and be able to distinguish between them (to determine
    if it is a withdrawal, a sensor fault, or an actuator fault) which is not easy
    in practice. When analyzing the problem, we found that: locally (at regulation
    gates), one can only detect sensor or actuator faults but not withdrawals, since
    they don’t affect the discharge flowing through the gate; globally (on the whole
    pool), one can detect faults or withdrawals but cannot isolate them; and by combining
    both local and global analysis, one may distinguish withdrawals from sensor or
    actuator faults. The methodology developed in this paper is then based on the
    combination of two approaches as follows: 1. Local approach: where static data
    reconciliation based on analytical redundancy and local measurements is applied
    at regulation gates in order to detect and isolate sensor and actuator faults;
    2. Global approach: where dynamic data reconciliation based on linearized Saint-Venant
    equations of the pool is applied to the whole pool in order to detect withdrawals
    and faults; and 3. Combination of local and global approaches: in order to isolate
    withdrawals from sensor and actuator faults. In order to show the efficiency of
    the methodology developed, we give the main results of its application obtained
    from real data of the Canal de Gignac. But let us first present the principle
    of the data reconciliation method in static and dynamic cases. Data Reconciliation
    Roughly speaking, data reconciliation generates a set of data in coherence with
    the process model, from given measurements. The data obtained are then compared
    to the measurements to generate residuals. These residuals are checked using statistical
    tests, which may or not detect the presence of fault. General Framework for Data
    Reconciliation Data reconciliation requires a process model and the statistical
    characteristics of the measurements. The model is the set of physical relations
    between the system variables denoted by x 1 , . . , x n . When these variables
    are evaluated by sensors, they correspond to the measurements and are denoted
    y m 1 , … , y m n . A subscript index k is also used to denote the value of the
    variable at time k Δ t , where Δ t = sampling period of measurement. When the
    model is static, the variables are linked by a static relationship of the following
    form: M Y k = R (1) where Y k = [ y 1 k … y n k ] T = measurement vector; and
    M and R = matrix and vector of appropriate dimensions, respectively. When the
    model is dynamic, the system variables are linked by a dynamic relationship of
    the following form: X k + 1 = A X k Y k = C X k where X k = [ x 1 k … x n k ]
    T and X k + 1 = vector representations of the set of system variables (state vector),
    respectively, at time k Δ t and ( k + 1 ) Δ t ; ∊ Y ∊ R m = measurement vector;
    ∊ A ∊ R n × n = state matrix; and ∊ C ∊ R m × n = observation or measurement matrix.
    We model a sensor by an additive noise. Then, sensor i delivers a measurement
    y m i of variable y i such that y m i = y i + ϵ i This noise ϵ i is assumed to
    follows a Gaussian probability density function N with zero mean and a standard
    deviation σ i . Hence, the measurements vector Y m is affected by the Gaussian
    noise vector ϵ = [ ϵ 1 , … , ϵ n ] T with zero mean and variance-covariance matrix
    V Y m = Y + ϵ ϵ ∼ N ( 0 , V ) As the sensors are assumed to be independent, the
    variance-covariance matrix V is diagonal V = dia g ( σ 1 2 , ⋯ , σ n 2 ) In the
    following section, we detail the solution of data reconciliation in the static
    case. Static Data Reconciliation Principle Static reconciliation consists of obtaining
    estimated values Y ̂ close to the measurements Y m and which satisfy the static
    linear model Eq. (1). This can be formulated as an optimization problem with static
    constraints. The performance index to minimize is the quadratic error between
    the measurements Y m and the reconciled data Y ̂ . The constraints are given by
    the model Eq. (1). Mathematically, it reads min Y ̂ 1 2 ‖ Y m − Y ̂ ‖ V − 1 2
    M Y ̂ = R The solution is given by Wang et al. (2004) Y ̂ = ( I n − S M ) Y m
    + S R (4) where S = V M T ( M V M T ) − 1 and ∊ I n ∊ R n × n = identity matrix.
    This solution can easily be implemented in any computer language, in order to
    generate estimates Y ̂ that satisfy the model Eq. (1). A second step is to check
    the consistency of the measurements. This is done with statistical tests. Statistical
    Tests Statistical tests are used to check the consistency of the measurements.
    In practice, a threshold is needed to decide whenever an error is detected. This
    threshold is generally fixed for a given confidence level and for a given probability
    distribution. The following statistical tests are classically used to detect and
    localize the possible errors: 1. Global test: it allows us to check the global
    coherence of measurements with the model (Bagajewicz 2000). It uses the global
    residual r G defined by r G = M Y m − R In the absence of faults, this residual
    has the following properties: E ( r G ) = 0 and V r = Var ( r G ) = M V M T where
    E ( r G ) stands for the mean of r G and Var ( r G ) represents its variance and
    the quantity ϕ = r G T V r − 1 r G follows a χ 2 probability density function
    of n d degrees of freedom, where n d = n − n r , with n = number of measurements
    and n r = number of global residuals (Bagajewicz 2000) ϕ ∼ χ 2 ( n d ) The threshold
    is determined in the χ 2 table for a confidence level of 95% (for example). The
    test then consists of evaluating whether the variable ϕ remains lower than the
    threshold. This global test allows only fault detection. It cannot give more information
    [the number of erroneous measurement(s), the origin of the fault(s)]. It is why
    the nodal test is usually used. 2. Nodal test: when there is no error, each normalized
    global residual element r i = r G i ∕ V r i follows the centralized reduced Gaussian
    probability density function (Bagajewicz 2000) r i ∼ N ( 0 , 1 ) , ∀ i = 1 , n
    r As for the global test, we fix a threshold. For a reduced centered probability
    density function and for 95% of the confidence level, the threshold is ± 1.96
    . The nodal test then consists of checking if ∣ r i ∣ < 1.96 In the presence of
    fault(s), only the affected residuals cross the threshold. Consequently, this
    test suspects only the variables x i that compose these residuals and especially
    the common variables which can give an idea of the origin of the fault. Dynamic
    Data Reconciliation Principle In the control field, data reconciliation is a part
    of the general problem of state estimation in the dynamic systems. Generally,
    it is solved by the Kalman filter. Dynamic data reconciliation is based on a dynamic
    model of the form Eq. (2) Data reconciliation is solved by the Kalman filter (Dibo
    2005). The Kalman filter is a recursive method that computes state estimation
    and state variances (Benqlilou 2004). It uses the model [Eq. (2)] and supposes
    that the measurement vector Y m is affected by a white noise vector ϵ such that
    (Welch and Bishop 2004) Y m = Y + ϵ ϵ ∼ N ( 0 , V ) , E ( ϵ i ϵ j ) = 0 , j ≠
    i , i , j = 1 , n The Kalman filter is of the form X ̂ k + 1 = A X ̂ k + K ( Y
    k − Y ̂ k ) Y ̂ k = C X ̂ k where X ̂ k = state estimate of X k ; and K = filter
    gain determined by minimizing the variance Γ k of the estimation error e k (Welch
    and Bishop 2004) e k = X k − X ̂ k (6) min X ̂ { Γ k = E [ e k e k T ] } (7) The
    filter gain K is then obtained by K = Γ C T ( C Γ C T + V y ) − 1 where Γ = stationary
    solution of a Riccati equation. Statistical Test for Error Estimation The statistical
    test is used to determine if the quantity e y k is normal e y n ∼ N ( 0 , 1 )
    where e y n = e y k ∕ V e y k = normalized output estimation error; e y k = Y
    k − Y ̂ k = output estimation error; and V e y k = its variance. In this case,
    for a confidence level of 95% the threshold is ± 1.96 . In this section, we have
    given a summary of the data reconciliation method in the static and dynamic cases.
    In the next section, we will show its application to irrigation canals. Application
    to Canal de Gignac The Canal de Gignac is a real site that allows testing new
    modeling and control methods. It includes five stations among them the Belbezet
    and the Partiteur stations equipped with measurement and automatic control devices.
    At the Partiteur station, the canal is divided into two branches, the right bank
    (RB) and the left bank (LB). In each branch, we find an automatic regulation gate,
    two water level sensors, and a velocity sensor. The canal supervisor displays
    data and saves them into a database. In this paper, we are interested in validating
    measurements of the pool situated between Belbezet and Partiteur Right Bank. To
    this end, we proceed as follows: 1. We apply data reconciliation locally at the
    Partiteur Right Bank regulation gate; and 2. We use Kalman filtering for the whole
    pool Belbezet-Partiteur Right Bank. Let us first describe the available models
    and measurements. Description of Available Sensors The following sensors are available
    at the regulation gate: 1. Gate position sensor: the regulation gate (Fig. 2)
    is submerged. It is equipped with a motor which acts on the gate according to
    the automate consigns. The gate is also equipped with a position sensor; 2. Water
    level sensors: the water level sensors are piezo-resistive sensors, whose resistance
    varies with the water level; and 3. Velocity sensor: the velocity sensor is an
    ultrasonic sensor, which measures the average water velocity based on the transit
    time Δ T of an ultrasonic signal between points A and B in Figs. 3 and 4. The
    velocity is obtained with the following formula: V = L 2 cos α ( 1 T A B − 1 T
    B A ) where L = length A B ′ ; α = angle with respect to the flow direction; T
    A B = propagation time from A to B ′ ; and T B A = propagation time from B to
    A . A measure is usually given with an absolute or relative uncertainty. This
    uncertainty indicates the error of the sensor. This error can be deterministic
    represented by the systematic uncertainty, or stochastic due to the measurement
    noise. To compute the measurement variance, we use the fact that for a confidence
    level of 95%, the uncertainty is twice the standard deviation (Ragot et al. 1990)
    σ 2 = ( 1 2 Δ ) 2 The measurements variances are then given by σ h = 7 × 10 −
    3 m , σ u = 5 × 10 − 3 m , and σ v = 3 × 10 − 2 m ∕ s . Fig. 2. Partiteur Right
    Bank regulation gate Fig. 3. Principle of velocity sensor Fig. 4. Velocity sensor
    Description of Nonlinear Available Models of Flow Discharge There is no flow discharge
    sensor. The flow discharge is computed using models. We use the following three
    static flow discharge models: 1. The gate equation Q v = C d L U 2 2 g H 1 − H
    2 (8) where C d = discharge coefficient; L = gate width; g = gravity acceleration;
    U 2 = the gate opening; H 1 and H 2 = upstream and downstream water levels of
    the gate; and Q v = flow discharge. For the gate considered the parameters are
    given by C d = 0.68 and L = 1.53 m ; 2 The stage-discharge rating curve: the stage-discharge
    rating curve relates the discharge Q to the downstream water elevation H 2 . The
    stage-discharge rating curve is given by Q c t = a ( H 2 − H 0 ) b (9) where a
    , b = constants ; H 0 = water level for which the flow discharge is null; H 2
    represents the downstream water level of the gate; and Q c t = flow discharge.
    In our case, we have a = 1.95 × 10 ( − 4 + 2 b ) , b = 1.8126 , and H 0 = 1.4
    × 10 − 2 m ; and 3 The velocity model: the velocity model allows us, according
    to the straight line velocity V L (given by the velocity sensor) and the water
    level H , to determine the flow discharge Q by the equation Q c v = L c V L H
    ( c 1 + c 2 H + c 3 H 2 ) (10) where L c = canal width; and c 1 , c 2 , and c
    3 = coefficients determined experimentally ( L c = 1.33 m , c 1 = 1.8445 , c 2
    = − 1.9594 , and c 3 = 0.9383 ). Linearized Models for Data Reconciliation The
    previous models are nonlinear. In order to apply data reconciliation based on
    linear models, we linearize them around the operating point. This leads to the
    following: 1 Gate equation q 2 = k 1 h 1 + k 2 h 2 + k u u 2 (11) where k 1 ,
    k 2 , and k u = constants , obtained by differentiating Eq. (8) with respect to
    H 1 , H 2 , and U 2 , respectively; and h 1 , h 2 , u 2 , and q 2 = upstream water
    and downstream water level variations, gate opening variation, and discharge variation
    around the operating point, respectively; 2 Stage-discharge rating curve q 2 =
    k c t h 2 (12) where k c t = constant obtained by differentiating Eq. (9); and
    h 2 and q 2 = downstream water level and the discharge variations around the operating
    point; and 3 Velocity model q 2 = k h h 2 + k v v (13) where k h and k v = constants
    obtained by differentiating Eq. (10); and h 2 and v = water level variation located
    at the velocity sensor place and the velocity variation. Local Approach: Application
    of Static Data Reconciliation We now apply data reconciliation based on the three
    linearized models. A first reconciliation is performed to check whether the measurements
    are coherent with the model. Then, a bias is artificially added on the gate opening,
    to test whether the method can detect this bias. Finally, we show that our method
    also enables us to detect a slow drift in one of the models. We apply data reconciliation
    during 9 days (from April 16 to 24). The variables used in the data reconciliation
    are as follows. The state vector is given by Y = [ h 1 h 2 u 2 v q 2 ] T , the
    measurement vector by Y m = [ h 1 m h 2 m u m v m ] , and the discharge q 2 is
    not measured. Assuming that the sensors are independent, the variance-covariance
    matrix of Y is given by V = diag ( σ h 1 2 , σ h 2 2 , σ u 2 2 , σ v 2 ) Three
    models are available to compute the discharge q 2 : the gate model Eq. (11); the
    rating curve model Eq. (12), and the velocity model Eq. (13). After elimination
    of the unmeasured discharge q 2 , we obtain a model of the form M Y = R where
    R = 0 M = ( k 1 k 2 − k c t k u 0 0 k y − k c t 0 k v ) and consequently a global
    residual vector r G = M Y m − R of two elements r 1 G and r 2 G given by r 1 G
    = M 1 Y m − R 1 , with M 1 = ( k 1 k 2 − k c t k u 0 ) and R 1 = 0 and r 2 G =
    M 2 Y m − R 2 , with M 2 = ( 0 k h − k c t 0 k v ) and R 2 = 0 Before showing
    the test results, let us study the possible fault cases: the residual r 1 uses
    h 1 , h 2 , and u 2 while the residual r 2 uses only h 2 and v . In this case,
    we can have the following three different situations: 1 Only r 1 crosses the threshold:
    there exists an error on the upstream water level h 1 or the gate position measurement
    u 2 ; 2 Only r 2 crosses the threshold: there exists an error on the velocity
    measurement; and 3 Both r 1 and r 2 crosses the threshold: there exists an error
    on the downstream water level measurement h 2 . This can be summarized in Table
    1. Table 1. Decision Table   r 1 = 0 r 1 = 1 r 2 = 0 ∅ h 1 ∪ u 2 r 2 = 1 v h 2
    Let us now show the tests results. Data Reconciliation Results without Bias First,
    the global test is performed to check whether the global residual follows a χ
    2 law. Global Test The test is given by ϕ = r G T V r − 1 r G ∼ χ 2 ( 2 ) In this
    case, the threshold corresponding to a χ 2 probability density function of 2 degrees
    of freedom and for a confidence level of 95% ( α = 0.05 in the χ 2 table) is 5.85
    If ϕ > 5.85 , then there is detection of a fault The quantity ϕ is evaluated for
    a 9 day period (Fig. 5). Except for some punctual detections, the values of ϕ
    are always under the threshold which means that there is no fault. As the measurements
    are emitted to the supervisor through a network radio and phone transmission and
    saved in a database, the punctual detections may be due to a radio transmission
    interruption, absence of data in the database, or other external phenomena independent
    of sensors. Fig. 5. Global test As the global test validates the measurements,
    it is not necessary here to apply the nodal test. However, we show it here for
    a simple illustration. Nodal Test The nodal test is used to check that each normalized
    element of the global residual vector remains under the threshold If ∣ r 1 ∣ >
    1.96 or ∣ r 2 ∣ > 1.96 then there is detection of a fault Fig. 6 shows that except
    for punctual detection due to a previous explanation, the residuals do not cross
    the threshold. Consequently, there is no detection of any fault. Fig. 6. Nodal
    test Data Reconciliation Finally, one may reconcile the data with the models using
    static data reconciliation. Figs. 7–10 illustrate the original and reconciled
    measurements. The graphs show that the reconciled values are close to the measurement
    values. Once data reconciliation is performed, one may reconstruct the unmeasured
    data q 2 from the reconciled data. Fig. 7. Upstream water level variation Fig.
    8. Downstream water level variation Fig. 9. Gate position variation Fig. 10. Velocity
    variation Data Reconstruction Fig. 11 draws the estimated discharge. Fig. 11.
    Estimated discharge variation Data reconciliation has therefore been performed
    successfully to validate the measurements on a regulation gate of the Canal de
    Gignac. Let us now evaluate the ability of the method to detect a bias. Data Reconciliation
    Results with Bias In order to simulate faults, we have added a 5 cm bias on the
    gate position during a period of time. The same procedure as in the no fault case
    is applied. Global Test In the global test, the residual crosses the threshold
    when the fault occurs (Fig. 12). The global test therefore correctly detects the
    presence of a fault but it cannot isolate it, since we cannot determine which
    measurement is affected. Fig. 12. Global test Nodal Test Using the nodal test,
    we see that a bias is detected only on the residual r 1 (Fig. 13). According to
    the table decision (Table 1), one can suspect that the fault is on u 2 or h 1
    . But there is no more information that deduces that the fault is on u 2 . Consequently,
    we have partial isolation only. Fig. 13. Detection only on first residual Stage-Discharge
    Rating Curve Drift An interesting output of this method is that it may also detect
    slow drifts in the models. Indeed, when we consider data reconciliation on a longer
    time period ( 90 days ) , we have obtained the results depicted in Fig. 14 for
    the individual residuals. This figure shows that the two residuals r 1 and r 2
    progressively drift from their initial state to finish out of the nondetection
    zone which means fault detection. If we refer to the decision table (Table 1),
    one can conclude that the sensor h 2 is faulty. But it wasn’t the case. It was
    a model drift, and importantly, it was the rating curve model drift. This can
    be explained by the fact that this model is not time invariant, but time varying,
    since the friction changes with time: there are weeds that grow inside the canal,
    and that progressively changes its friction. The proposed method can therefore
    detect a model drift, in this specific case due to a change in the friction coefficient
    due to weeds growing in the canal. Fig. 14. Individual residuals r 1 and r 2 A
    possible way to overcome this model drift is to adapt the model for different
    periods of year (spring, summer, autumn). In this case, one may use a set of linear
    models to represent the system. Such developments are out of the scope of the
    present paper and will be considered in the perspectives. Global Approach: Application
    of Dynamic Data Reconciliation We now apply the dynamic reconciliation method
    to a pool of the Canal de Gignac. The system considered is the pool Belbezet-Partiteur,
    which is a 4.3 km long pool, with an average slope of 0.0004 and a general rectangular
    cross section of 2.5 m width. To simplify the study, we consider the system represented
    in Fig. 15 where: • q 1 =Belbezet discharge variation; • h 1 =upstream water level
    variation of the Partiteur regulation gate; • h 2 =downstream water level variation
    of the Partiteur regulation gate; • u 2 =Partiteur regulation gate position variation;
    and • p 1 =offtake discharge variation. Fig. 15. Schematic representation of one
    canal pool The available sensors are the water level sensors h 1 , h 2 , the position
    sensor u 2 , and the velocity sensor v . The measurements h 1 , h 2 , u 2 , and
    v are assumed to be affected by white noises ϵ h 1 , ϵ h 2 , ϵ u 2 , and ϵ v with
    zero mean and respective variances V h 1 , V h 2 , V u 2 , and V v , respectively.
    The discharge p 1 is not measured. The discharge q 1 is not measured but assumed
    to be reconciled locally by data reconciliation at the Belbezet regulation gate.
    This step is not detailed here, but is very similar to the static reconciliation
    exposed earlier in the paper. We therefore use the discharge q 1 as a measurement
    affected by a white noise ϵ q 1 with zero mean and variance V q 1 . The variance-covariance
    matrix then reads V = diag ( V q 1 , V u 2 , V h 1 , V h 2 ) Dynamic Modeling
    of Canal Pool In order to apply dynamic data reconciliation, the canal pool is
    represented by its dynamic model derived from the rational linearized Saint-Venant
    Eq. (14) coupled with the linearized gate Eq. (15) h 1 ( s ) = p 21 ( s ) q 1
    ( s ) + p 22 ( s ) ( q 2 ( s ) + p 1 ( s ) ) (14) where p 21 and p 22 = low -frequency
    approximations of the pool transfer functions defined in Litrico and Fromion (2004)
    q 2 ( s ) = k 1 h 1 ( s ) + k 2 h 2 ( s ) + k u u 2 ( s ) (15) The canal dynamic
    model is obtained from a combination of the rational linearized Saint-Venant Eq.
    (14) and the linearized gate Eq. (15). The resulting model is of the form X k
    + 1 = A X k Y k = C X k + ϵ k where ϵ = [ ϵ q 1 ϵ u 2 ϵ h 1 ϵ h 2 ] ; Y k = h
    1 k . The numerical values of the matrices A , C , and V are A = [ 0.8522 0 0
    0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0
    0 0 0 0.8522 0 0 0 0 0 0 0 0 0.8522 0 0 0 0 0 0 0 0 0.8522 ] C = [ 0 0 0 0 0.2935
    − 0.7843 0.2980 − 0.2935 ] and V = diag ( ( 0.05 ) 2 ( 0.005 ) 2 ( 0.015 ) 2 (
    0.05 ) 2 ) Based on this model, we reconcile the measurements using the Kalman
    filter [Eq. (5)], Then, we check the well reconciliation of the measurements through
    the error estimation test. Dynamic Data Reconciliation Results The database is
    taken as in the static case (from April 16 to April 23, 2006) and the results
    are illustrated in Fig. 16. We can clearly observe that there is a fault detection
    from the middle of the second day. Otherwise, we can determine that there is no
    fault. The eventual faults can be on h 1 , h 2 , v , u 2 , or p 1 . For more information
    on the fault origin, we look to the local data reconciliation results illustrated
    for the same period in Fig. 6. Fig. 16. Normalized estimation error e h n = (
    Y k − Y ̂ k ) ∕ V e h Combination (Local/Global) Approaches We use a combination
    of static and dynamic data reconciliation: the static data reconciliation based
    on the three models quoted and the dynamic data reconciliation based on the dynamic
    model of the pool coupled to the gate equation. As the static reconciliation does
    not show any detection and assuming that q 1 is reconciled, we can conclude that
    the expected fault is due to the presence of a withdrawal p 1 . To summarize all
    the results, we can determine the following: 1. The local approach based on static
    data reconciliation can: • Validate measurements; • Detect actuator and sensor
    faults only; • Detect drift model; and • Isolate partially or (totally in some
    cases) the faults; 2. The global approach based on dynamic data reconciliation
    can: • Validate the measurements; and • Detect actuator, sensor, and system faults
    (withdrawals); and 3. The combination of the two approaches can distinguish the
    withdrawals from the other faults. Conclusion This paper deals with sensor and
    actuator fault detection and isolation in irrigation canals using data reconciliation.
    We have first presented the problem statement and showed how we proceeded to develop
    a generic methodology for canals which are equipped with regulation, and then
    we presented the data reconciliation method in the static and dynamic cases. After
    that, we showed the main results obtained from its application to real data from
    the Canal de Gignac. The results showed that static data reconciliation based
    on the three discharge models which are: the discharge rating curve model, the
    gate equation, and the velocity model, enables us to validate the measurements,
    to detect faults, and to isolate them partially or totally. It also enables us
    to reconstruct the discharge, which is not measured and detect the stage discharge
    rating curve model drift. The drift may be due to the growth of weeds, consequently
    affecting the canal roughness. Dynamic data reconciliation based on Kalman filtering
    on the Belbezet-Partiteur pool of the Canal de Gignac uses a dynamic model derived
    from the linearized Saint-Venant model coupled with the linearized gate equation.
    We have shown that the method allows us to detect either withdrawals or faults
    but cannot isolate them. By combining the dynamic (global approach) and the static
    (local approach) data reconciliation, we showed that we are able to distinguish
    between them. Such a method can be generalized to help the manager of open-channel
    systems, in order to detect possible faults occurring on the system. Notation
    The following symbols are used in this paper: A = state matrix; a , b = constants
    obtained experimentally; C = observation matrix; C d = discharge coefficient;
    c 1 , c 2 , c 3 = constants obtained experimentally; E = mean; e = estimation
    error; g = gravity acceleration; H = absolute water level measurement (m); h =
    water level measurement deviation (m); I n = identity matrix of n × n dimension;
    k c t , k h , k v , k 1 , k 2 = constants obtained after models linearization;
    L = gate width; L c = canal width; M = matrix of appropriate dimension; N = Gaussian
    probability density function; p = offtake or withdrawal discharge deviation (
    m 3 ∕ s ) ; Q = steady-state discharge ( m 3 ∕ s ) ; q = discharge deviation (
    m 3 ∕ s ) ; R = vector of appropriate dimension; R = real space; r = residual;
    r G = global residual; t = time (s); U = absolute gate opening (m); u = gate opening
    deviation (m); V = absolute velocity ( m ∕ s ) ; V = variance-covariance matrix;
    Var = variance; V L = straight line velocity; V r = residual variance; v = velocity
    deviation ( m ∕ s ) ; X = state vector; x i = i th state variable; Y = vector
    of variables evaluated by sensors; Y m = vector of measurements of Y ; y i = i
    th variable evaluated by sensor; y m i = i th measurement of y i ; Γ = stationary
    solution of Riccati equation; Δ = measurement uncertainty; ϵ = measurement noise;
    σ = standard deviation; ϕ = quantity; χ 2 = chi 2 probability density function;
    ⊘ = empty space; ‖.‖ = Euclidian norm; and ∣.∣ = absolute value. T = notation
    for transpose; and ̂ = notation for estimated values; estim = subscript index
    for estimated variable value; i = notation for indexed variables; k = subscript
    index for time; n = subscript index for normalized variables; and real = subscript
    index for real variable value. Acknowledgments The writers acknowledge the financial
    support of Région Languedoc-Roussillon, Conseil Général de l’Hérault, Agence de
    l’Eau Rhône-Méditerranée-Corse, and Cemagref through the “Plateforme Expérimentale
    du Canal de Gignac.” References Bagajewicz, M. J. (2000). “A brief review of recent
    developments in data reconciliation and gross error detection /estimation.” Lat.
    Am. Appl. Res., 30, 335–342. Google Scholar Bedjaoui, N., Litrico, X., Koenig,
    D., and Malaterre, P.-O. (2006). “ H ∞ observer design for time-delay systems.
    Application to FDI for irrigation canals.” Proc., 45th IEEE Conf. on Decision
    and Control, San Diego. Go to Citation Google Scholar Benqlilou, C. (2004). “Data
    reconciliation as framework for chemical processes optimization and control.”
    Ph.D. thesis, Univ. Politecnica de Catalunya, Catalogna, Spain. Go to Citation
    Google Scholar Deltour, J.-L., Canivet, E., Sanfilippo, F., and Sau, J. (2005).
    “Data reconciliation on the complex hydraulic system of Canal de Provence.” J.
    Irrig. Drain. Eng., 131(3), 291–297. Go to Citation Crossref Google Scholar SHOW
    ALL REFERENCES Recommended Journal of Irrigation and Drainage EngineeringArticleNovember
    2010 Real-Time Implementation of Model Predictive Control on Maricopa-Stanfield
    Irrigation and Drainage District’s WM Canal Journal of Irrigation and Drainage
    EngineeringArticleFebruary 2007 Automatic Tuning of PI Controllers for an Irrigation
    Canal Pool Journal of Irrigation and Drainage EngineeringArticleNovember 1994
    Canal‐Control Needs: Example Journal of Irrigation and Drainage EngineeringArticleJune
    2006 Automatic Downstream Water-Level Feedback Control of Branching Canal Networks:
    Simulation Results Journal of Irrigation and Drainage EngineeringArticleFebruary
    2004 Simple Optimal Downstream Feedback Canal Controllers: ASCE Test Case Results
    View full text|Download PDF American Society of Civil Engineers 1801 Alexander
    Bell Drive Reston, VA 20191-4400 703-295-6300 | 800-548-2723 TERMS & CONDITIONS
    HELP PRIVACY SITEMAP TERMS OF USE SUBSCRIBE CONTACT US ACCESSIBILITY, DIVERSITY,
    EQUITY & INCLUSION Follow us @ASCEPublishing LinkedIn YouTube © 1996–2024 American
    Society of Civil Engineers"'
  inline_citation: Bedjaoui et al. (2008)
  journal: Journal of Irrigation and Drainage Engineering
  limitations: null
  relevance_score: 0.9
  relevance_score1: 0
  relevance_score2: 0
  title: Static and dynamic data reconciliation for an irrigation canal
  verbatim_quote1: This paper deals with the problem of fault detection and isolation
    in irrigation canals.
  verbatim_quote2: We have developed a method which combines static and dynamic data
    reconciliation for the validation of measurements, detection, and isolation of
    sensors and actuator faults and reconstruction of missing data.
  verbatim_quote3: '>'
