- DOI: https://doi.org/10.3390/w14060889
  analysis: '>'
  authors:
  - Jorge Lopez-Jimenez
  - Alain Vande Wouwer
  - Nicanor Quijano
  citation_count: 6
  full_citation: '>'
  full_text: ">\n\x01\x02\x03\x01\x04\x05\x06\a\b\x01\n\x01\x02\x03\x04\x05\x06\a\n\
    Citation: Lopez-Jimenez, J.; Vande\nWouwer, A.; Quijano, N. Dynamic\nModeling\
    \ of Crop–Soil Systems to\nDesign Monitoring and Automatic\nIrrigation Processes:\
    \ A Review with\nWorked Examples. Water 2022, 14,\n889. https://doi.org/10.3390/\n\
    w14060889\nAcademic Editors: Sara Álvarez and\nCristina Romero-Trigueros\nReceived:\
    \ 28 January 2022\nAccepted: 9 March 2022\nPublished: 12 March 2022\nPublisher’s\
    \ Note: MDPI stays neutral\nwith regard to jurisdictional claims in\npublished\
    \ maps and institutional afﬁl-\niations.\nCopyright:\n© 2022 by the authors.\n\
    Licensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed\n\
    under\nthe\nterms\nand\nconditions of the Creative Commons\nAttribution (CC BY)\
    \ license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nwater\nReview\n\
    Dynamic Modeling of Crop–Soil Systems to Design Monitoring\nand Automatic Irrigation\
    \ Processes: A Review with\nWorked Examples\nJorge Lopez-Jimenez 1,2\n, Alain\
    \ Vande Wouwer 2,*\nand Nicanor Quijano 1\n1\nDepartment of Electrical and Electronic\
    \ Engineering, Universidad de los Andes, Bogotá 111711, Colombia;\njorgelopez@uniandes.edu.co\
    \ (J.L.-J.); nquijano@uniandes.edu.co (N.Q.)\n2\nSystems, Estimation, Control,\
    \ and Optimization (SECO), University of Mons, 7000 Mons, Belgium\n*\nCorrespondence:\
    \ alain.vandewouwer@umons.ac.be\nAbstract: The smart use of water is a key factor\
    \ in increasing food production. Over the years,\nirrigation has relied on historical\
    \ data and traditional management policies. Control techniques have\nbeen exploited\
    \ to build automatic irrigation systems based on climatic records and weather\
    \ forecasts.\nHowever, climate change and new sources of information motivate\
    \ better irrigation strategies that\nmight take advantage of the new sources of\
    \ information in the spectrum of systems and control\nmethodologies in a more\
    \ systematic way. In this connection, two open questions deserve interest:\n(i)\
    \ How can one deal with the space–time variability of soil conditions? (ii) How\
    \ can one provide\nrobustness to an irrigation system under unexpected environmental\
    \ change? In this review, the\ndifferent elements of an automatic control system\
    \ are described, including the mathematical modeling\nof the crop–soil systems,\
    \ instrumentation and actuation, model identiﬁcation and validation from\nexperimental\
    \ data, estimation of non-measured variables and sensor fusion, and predictive\
    \ control\nbased on crop–soil and weather models. An overview of the literature\
    \ is given, and several speciﬁc\nexamples are worked out for illustration purposes.\n\
    Keywords: crop–soil modeling; sensors; system identiﬁcation; state estimation;\
    \ control systems;\nheterogeneous soil; smart irrigation\n1. Introduction\nThe\
    \ rise of the world population motivates the increase in food production. To achieve\n\
    this goal, irrigation plays a major role, since 70% of fresh water around the\
    \ world is used\nin agriculture [1]. A challenge is to increase production while\
    \ following a sustainable\nand efﬁcient strategy [2,3]. Efﬁcient irrigation has\
    \ a determinant impact on the water\nfootprint of agricultural production, which\
    \ depends not only on the amount of water that\nis used, but also on the way it\
    \ is exploited and on the water sources [4]. On the one hand,\nsustainability\
    \ is linked to water scarcity and climate change, since historical climatic data\n\
    may not be sufﬁcient to determine irrigation strategies. This issue was discussed\
    \ by [5],\nwhere the authors proposed an adaptive irrigation strategy. On the\
    \ other hand, the design\nof irrigation systems involves a proper interpretation\
    \ of the crop–soil system in order\nto propose an optimal irrigation policy. One\
    \ of the most relevant open challenges is the\nmanagement of land heterogeneity\
    \ related to topography and soil properties [6]. Over the\nyears, the representation\
    \ of crop–soil dynamics has been addressed with mathematical\nmodels, where the\
    \ cause–effect relations between environmental variables and plant/soil\ncomponents\
    \ have been incorporated. These models mainly include mass balance equations,\n\
    heuristic relationships, and statistical functions. The historical evolution of\
    \ these models\nwas described by [6–8]. Nevertheless, modeling of irrigation systems\
    \ has traditionally\nbeen limited to soil dynamics, neglecting the plants’ interactions\
    \ and effects [9], which\nhas led to sub-optimal solutions [10]. Consequently,\
    \ the design of irrigation systems can\nWater 2022, 14, 889. https://doi.org/10.3390/w14060889\n\
    https://www.mdpi.com/journal/water\nWater 2022, 14, 889\n2 of 37\nbe enhanced\
    \ by more comprehensive models that take interactions between the different\n\
    system compartments into account and by a more systematic use of system and control\n\
    theory to improve monitoring and predictive control.\nThis trend in smart farming\
    \ and precision agriculture has been boosted by the avail-\nability of more sources\
    \ of information, notably, through remote sensing [8,11,12], thus also\nleading\
    \ to the use of machine learning [13]. The applications of these tools have led\
    \ to\nimprovements in production performance, as discussed in [14].\nHowever,\
    \ there is still room for a full exploitation of system and control methodologies,\n\
    particularly in this new era of massive data sources, as recently pointed out\
    \ by [15]. In this\nlatter review article, the authors emphasized two research\
    \ directions, i.e., minimal resource\nusage and the exploitation of current technology\
    \ to build better management systems. The\nopen challenges include the resource\
    \ allocation problem, control-oriented modeling, and\nsensor and actuator placement.\n\
    In this present article, the last ten years of developments related to irrigation\
    \ in\nagricultural systems are reviewed by following the methodological structure\
    \ shown in\nFigure 1. The objective is to highlight the several steps leading\
    \ to an advanced control\nstrategy, including instrumentation, mathematical modeling,\
    \ model identiﬁcation and\nvalidation, state estimation (software sensors), and\
    \ model-based control. The main concepts\nare illustrated by numerical examples\
    \ that are carefully worked out. This review builds\nupon past reviews, such as\
    \ [16,17], which summarized fundamental control concepts\napplied to irrigation\
    \ systems.\nThe problem of irrigation can be divided into two subproblems, i.e.,\
    \ water transporta-\ntion and water usage. In this review article, the focus is\
    \ put on the latter subject, since a\ncomplete review about water transportation\
    \ was recently published [18], where the authors\npresented a comprehensive description\
    \ of an open-channel system that included modeling\nand control features.\nFigure\
    \ 1. Diagram of a general irrigation system, where solid black blocks indicate\
    \ physical elements,\nred blocks are sensors or measurement instruments, solid\
    \ black lines are physical interactions, red\ndashed lines are signals, and green\
    \ and yellow blocks are designed elements.\nThis paper is organized as follows.\
    \ In Section 2, the main components of simulation-\noriented models are extracted\
    \ to propose control-oriented models. Next, Section 3 presents\nthe sensing and\
    \ measurement elements. Afterwards, in Section 4, the system identiﬁcation\ntechniques\
    \ used to determine the model parameters are presented, with an emphasis on\n\
    Water 2022, 14, 889\n3 of 37\nparameter uncertainties and model validation. Section\
    \ 5 reviews state estimation and the\nreconstruction of non-measured variables.\
    \ Then, in Section 6, the most popular control\ntechniques are discussed. Section\
    \ 7 discusses spatial representation and soil heterogeneity.\nFinally, Section\
    \ 8 draws conclusions and perspectives.\n2. Dynamic Crop–Soil Model Components\n\
    Crop-growth models are developed to understand how environmental and manage-\n\
    ment factors affect food production. In a predictive irrigation policy, these\
    \ models are\na core component, as illustrated in Figure 1. Two types of models\
    \ can be distinguished:\n(i) simulation-oriented models (SOMs) and (ii) control-oriented\
    \ models (COMs). The goal of\nthe models in the ﬁrst category is to faithfully\
    \ mimic the system behavior and to understand\nthe phenomena inﬂuencing crop growth.\
    \ These models combine mechanistic descriptions\nof biophysical phenomena and\
    \ heuristic laws. In [19], the authors presented an extensive\nlist of crop-growth\
    \ models (however, more than 50% of these models have become obsolete\nover time).\
    \ The models in the second group are usually reduced or simpliﬁed versions of\n\
    the previous models. Only 12 of the most cited SOMs are usually considered to\
    \ build a\ncontrol-oriented framework (see Table 1) based on a hierarchy in growth\
    \ and production\nfactors proposed by [20]. These include growth-deﬁning factors,\
    \ growth-limiting factors,\nand growth-reducing factors. The growth-deﬁning factors\
    \ determine the maximum possi-\nble growth and are dependent on crop-speciﬁc parameters\
    \ and weather inﬂuences, such\nas temperature and solar radiation. The growth-limiting\
    \ factors are due to a shortage or\nexcess of water and nutrients such as nitrogen.\
    \ The growth-reducing factors are due to,\ne.g., weeds and pests. Some of the\
    \ mentioned factors are listed in Table 2 for representative\nSOMs, whose evolution\
    \ has been reviewed by [21]. Other related works, such as [22],\nused a dynamic\
    \ system approach to represent full agricultural production systems. These\nagricultural\
    \ production systems include livestock production, economic and labor modules,\n\
    environmental impact, and social components, which are outside of the scope of\
    \ this review.\nIn this review, we describe the crop dynamics for a homogeneous\
    \ portion of land by\nfollowing two approaches.\n2.1. Crop and Growth Models\n\
    Food production includes perennial and seasonal crops. As mentioned in the intro-\n\
    duction, water has a determinant inﬂuence on the development of both. For instance,\
    \ large\ncrops of almonds have been identiﬁed as the most signiﬁcant consumers\
    \ of freshwater,\nfollowed by large-scale seasonal crops of rice, alfalfa, sugarcane,\
    \ wheat, maize, and plan-\ntains [23]. Therefore, efﬁcient irrigation offers a\
    \ global beneﬁt for long- and short-term\ncrops. However, in short-term crops\
    \ (e.g., cereals and legumes), the excess or lack of\nwater can be catastrophic,\
    \ since the crop might be under irrecoverable conditions [24].\nConsequently,\
    \ most COMs are focused on seasonal and short-term crops.\nThe dynamics of crop\
    \ processes can be described by a system of differential or dif-\nference equations,\
    \ which represent the plant growth with at least three levels of detail.\nIn the\
    \ ﬁrst level, the crop growth is limited solely by weather conditions, primarily\
    \ solar\nradiation and air temperature. In the second level, growth is water-limited,\
    \ i.e., limited by\nthe shortage or excess of water supply, in addition to the\
    \ constraints imposed by weather\nconditions. In the third level, growth is also\
    \ limited by the shortage of nutrients—mainly,\nbut not limited to, nitrogen (N)—during\
    \ some lapses in the growing season. The shortage\nof other nutrients, such as\
    \ phosphorus or potassium, follows the same logic as for nitrogen,\nimposing more\
    \ restrictive bounds on the growth function. These levels are explained next.\n\
    Water 2022, 14, 889\n4 of 37\nTable 1. Main inputs and driving and output variables\
    \ for selected SOM crop models.\nModel\nInputs\nDriving Variable\nOutput Variables\n\
    References\nEnvironmental\nManipulated\nRadiation\nTemperatures\n(max, min)\n\
    Rainfall\nPrecipitation\nReference Evapo-\ntranspiration\nWind\nHumidity\nIrrigation\n\
    Moisture\nFertiliz-\nation\nOther\nYield\nOther\nAPEX\n✓\n✓\n✓\n✓\n✓\n✓\n✓\n•\
    \ Soil preparation\nCumulative\n✓\n• Carbon and nitrogen\ntransformations\n[25]\n\
    • Pesticide\ntemperature\n• Costs\n• Crop rotation\n• Tillage\nAPSIM\n✓\n✓\n✓\n\
    ✓\n✓\n✓\n• Vapor pressure\nThermal time\n✓\n• Dry matter\n[26]\naccumulation\n\
    AquaCrop\n✓\n✓\n✓\n✓\n• CO2 concentration\nWater content\n✓\n• Irrigation\n[27]\n\
    • Soil fertility level\nand ﬂuxes\n• Water losses\n• Weed management\n• Soil water\n\
    CropSyst\n✓\n✓\n✓\n• Soil proﬁle\nThermal time\n✓\n• Above-ground root biomass\n\
    accumulation\n[28]\n• Management of\nscheduled events\naccumulation\n• Fertilization\n\
    • Residue fate\nDAISY\n✓\n✓\n✓\n✓\n✓\n✓\n✓\n✓\n• Soil properties\nAir temperature\n\
    • Water balance\n[29]\n• Sowing/planting\n• Heat balance\n• Soil tillage\n• Solute\
    \ balance\n• Harvest\n• Pesticide fate\nDNDC\n✓\n✓\n✓\n✓\n✓\n✓\n✓\n• Redox potential\
    \ Eh\nAir temperature\n✓\n• Gas emissions\n[30,31]\n• Oxygen\nconcentration\n\
    • N leaching\n• Climate ﬁle\n• Weather\n• Soil proﬁle\n• Soil carbon sequestration\n\
    • Tillage\nDSSAT\n✓\n✓\n✓\n✓\n✓\n✓\n✓\n• CO2 concentration\nThermal time\n✓\n\
    • Weather\n[32]\n• Soil proﬁle\naccumulation\n• Soil proﬁle\n• Crop proﬁle\n•\
    \ Fertilization\n• Management proﬁle\n• Irrigation\nEPIC\n✓\n✓\n✓\n✓\n✓\n✓\n✓\n\
    • Soil proﬁle\nSolar\n✓\n• Productivity\n[33]\n• Soil erosion\nradiation\n• Waste\
    \ management\n• Pesticide\n• Plant competition\n• Homogeneous soil\nassumption\n\
    • Pesticide fate\n• Crop rotation\n• Furrow diking\n• Tillage\nWater 2022, 14,\
    \ 889\n5 of 37\nTable 1. Cont.\nModel\nInputs\nDriving Variable\nOutput Variables\n\
    References\nEnvironmental\nManipulated\nRadiation\nTemperatures\n(max, min)\n\
    Rainfall\nPrecipitation\nReference Evapo-\ntranspiration\nWind\nHumidity\nIrrigation\n\
    Moisture\nFertiliz-\nation\nOther\nYield\nOther\nSALUS\n✓\n✓\n✓\n✓\n✓\n• Tillage\n\
    Solar\n✓\n• Development stages\n[34]\n• Residue fate\nradiation\n• Fertilization\n\
    • Pesticide\n• N leaching\n• Soil erosion\n• Irrigation\nSTICS\n✓\n✓\n✓\n✓\n✓\n\
    ✓\n✓\n✓\nCropping\nPlant carbon\n✓\n• Nitrate leaching\n[35]\nschema\naccumulation\
    \ [36]\n• Drainage\nSWAP\n✓\n✓\n✓\n✓\n✓\n✓\n• Crop rotation\nThermal time\n• Dry\
    \ weight (stems/leaves)\n[37]\n• Solute transport\n• Water management\nWOFOST\n\
    ✓\n✓\n✓\n✓\n✓\n✓\n✓\n✓\n• CO2 concentration\nThermal time\n✓\n• Biomass\n[38]\n\
    • Vapor pressure\n• Water use\n• Management proﬁle\nTable 2. Main functions related\
    \ to the simulation processes of selected SOMs.\nModel\nWater Balance\nNutrient\
    \ Balance\nEvapotranspiration\nGrowth-Core Main State\nVariable\nBiomass or Yield\
    \ Formation\nStresses\nAPEX\nProbabilistic distribution\n•\nPenman (1948)\n•\n\
    Pemnam–Monteith\n(1965)\n•\nPriestly–Taylor (1972)\n•\nHargreaves (1985)\n•\n\
    Baier–Robertson (1965)\n•\nPhotosynthetically\nActive Radiation (PAR)\n•\nLeaf\
    \ Area Index (LAI)\nPotential increase in biomass\nMonteith 1977\n•\nErosion\n\
    •\nNitrogen\n•\nCarbon\n•\nPhosphorus\n•\nPesticide fate\nAPSIM\n•\nTipping bucket\
    \ (soil\nwater)\n•\nRichards equation\n(SWIM)\nNitrogen uptake rate\n•\nTranspiration\
    \ efﬁciency\n•\nVapor Pressure Deﬁcit\n(VPD)\n•\nTanner and Sinclair\n(1983)\n\
    •\nPriestley–Taylor (1972)\n•\nPemnam–Monteith\n•\nRadiation-use efﬁciency\n(RUE)\
    \ LAI\nPotential biomass accumulation\n•\nTemperature\n•\nNitrogen\n•\nCO2\n•\n\
    Water\n•\nVapor pressure\nAquaCrop\nSoil water balance\nSalt balance by transfer\
    \ of\nsolutes\n•\nPenman–Monteith\n(FAO56)\n•\nGreen canopy cover (CC)\n•\nWater\
    \ productivity (WP)\nCumulative crop transpiration\nlimited by biomass water\n\
    productivity\n•\nWater\n•\nTemperature\n•\nSoil fertility\n•\nSoil salinity\n\
    Water 2022, 14, 889\n6 of 37\nTable 2. Cont.\nModel\nWater Balance\nNutrient Balance\n\
    Evapotranspiration\nGrowth-Core Main State\nVariable\nBiomass or Yield Formation\n\
    Stresses\nCropSyst\n•\nFinite difference solution\nof Richards equation\n•\nWater\
    \ transport\ncascading approach\nN Transformations N\nabsorption rate Chemical\n\
    budget (salinity, pesticide)\n•\nPemnam–Monteith\n(1965)\n•\nPriestly–Taylor (1972)\n\
    •\nReduced Priestly–Taylor\n(only requires air\ntemperature)\n•\nPAR\n•\nLAI\n\
    •\nWater u-se efﬁciency\n(WUE)\n•\nLAI\nTanner and Sinclair (1983),\ndaily biomass\
    \ accumulation\nMonteith (1977) at low vapor\npressure deﬁcit\n•\nWater\n•\nVernalization\n\
    •\nTemperature\n•\nNitrogen\nDAISY\n•\nMass balance Richards\nequation\n•\nDarcy\
    \ equation\nNitrogen dynamics\n•\nFAO Penman–Monteith\n(1990)\n•\nMakkink equation\
    \ (1984)\n• Beer’s law\nAccumulation of dry matter\nand nitrogen\n•\nNitrogen\n\
    •\nWater\nDNDC\n• Algebraic equation\n•\nNitriﬁcation and\ndenitriﬁcation\n•\n\
    Fermentation\nWater-use efﬁciency limited by\nVPD [39]\n•\nMaximum net\nphotosynthesis\
    \ (Aber\nand Federer, 1992) [39]\n•\nLAI\nDaily cumulative temperature\nconditioned\
    \ by N demand\nuptake\nWater demand uptake\n•\nWater\nDSSAT\nMass-balance\n(Differential\
    \ equations by soil\nlayer)\n•\nSoil organic matter\n•\nNitrogen balance\n•\n\
    Priestly–Taylor (1972)\n•\nFAO Penman–Monteith\n(1990)\n•\nPenman FAO\n•\nDaily\
    \ canopy RUE\n•\nHourly hedgerow\nphotosynthesis light\ninterception (Boote and\n\
    Pickering, 1994)\nGrowing degree-days (GDD)\n•\nNitrogen\n•\nNutrient\n•\nWater\n\
    EPIC\n•\nPeak rate runoff\nequations\n•\nMass balance by soil\nlayer\nLeaching\
    \ equations\nSediment transport\nMineralization\n•\nPenman (1948)\n•\nPemnan–Monteith\
    \ (1965)\n•\nBaier–Robertson (1965)\n•\nPriestly–Taylor (1972)\n•\nHargreaves\
    \ (1985)\n•\nCrop interception of\nsolar radiation\n•\nLAI\nConversion of\nIntercepted\
    \ light to biomass\n•\nWater\n•\nNutrients\n•\nTemperature\n•\nAeration\n•\nRadiation\n\
    SALUS\n•\nMass balance\n•\nMineralization\n•\nMass balance\n•\nC:N ratios\n•\n\
    Penman (1948) (modiﬁed\nby Shuttleworth 2007)\n•\nLAI\n•\nRUE\n•\nBeer’s law analogy\n\
    Carbon assimilation\n•\nWater\n•\nNitrogen\nSTICS\n•\nMass balance equation\n\
    Functional ratio equation\n•\nPenman-Monteith\n(FAO56)\n•\nPriestley–Taylor (1972)\n\
    •\nBeer’s law analogy\n•\nLAI\nPlant carbon accumulation [40]\n•\nNitrogen\n•\n\
    Water thermal\nSWAP\n•\nRichards equation\n•\nSoil hydraulic functions\nNitrogen\
    \ cycle\n•\nPenman (1948)\n•\nPenman–Monteith\n(FAO56)\n•\nHargreaves (1985)\n\
    •\nMakkink equation (1984)\n•\nPriestley–Taylor (1972)\n•\nLAI\nDaily net assimilation\n\
    depending on the intercepted\nlight\n•\nDrought\n•\nSalinity\n•\nTranspiration\n\
    •\nOxygen\nWOFOST\n•\nMass balance by soil\nlayer\nSWAMP model for solute\ntransport\n\
    •\nPenman (1948)\n•\nPAR\n•\nLAI\nDaily net assimilation\ndepending on the intercepted\n\
    light\n•\nLight\n•\nWater\n•\nTemperature\n•\nNutrients\n•\nWeeds, pests, diseases\n\
    Water 2022, 14, 889\n7 of 37\n2.1.1. First Level\nThe time evolution of the biomass\
    \ y is related to the energy provided by sunlight:\ndy\ndt = µw\n \n1 − y\ny f\n\
    !\n,\n(1)\nwhere µ is the growth rate (i.e., the light-use efﬁciency (g/MJ)),\
    \ w is the daily intercepted\nsolar radiation (MJ/m2), and y f is the maximum\
    \ (or potential) biomass, which is related to\nthe crop species and the plant\
    \ density. After the limit of accumulation of solar energy is\nreached, the phenology\
    \ of the crop involves maturity and the natural aging process.\nThe stresses caused\
    \ by the lack or excess of environmental inputs, including the short-\nage of\
    \ nutrients (which can be remedied by fertilization), are accounted for by models\
    \ in\ntwo ways—first, by speeding up the aging process (e.g., shortening the maturity\
    \ time or\ncumulative temperature), and second, by using multiplicative factors\
    \ of the growth function.\nThese multiplicative stress factors are usually in\
    \ the range of [0, 1], where 1 represents a\nnon-stress condition and 0 represents\
    \ a maximum stress factor. The shape of stress factors is\nrelated to the mathematical\
    \ representation of the observed experimental impact (see Table 3).\nIt is important\
    \ to note that the multiplicative structure can present serious difficulties for\n\
    parameter identification.\nTable 3. Stress factor shapes, where 0 ≤ S ≤ 1 is the\
    \ relative stress level, α > 0 is the shape factor,\nSl and Su are the relative\
    \ stress levels at the lower and upper threshold, respectively, and β is the\n\
    rate factor.\nShape\nEquation\nUses\nReference\nLinear\nK = 1 − S\nWater drought\n\
    [41]\nWater-logging\n[42]\nSoil salinity\n[27]\nCO2 concentration\n[43,44]\nAir\
    \ temperature\n[45]\nConvex\nK = 1 − eαS−1\neα−1\nSoil fertility\n[31]\nWater\
    \ drought\n[27]\nLogistic\nK =\nSuSl\nSu+(Su−Sl)e−β(1−S)\nAir temperature\n[19,27]\n\
    Pests and diseases\n[46]\nOther models consider the temperature (T) as a driving\
    \ variable in order to describe\nmatter formation. The crop grows according to\
    \ the thermal pace, which corresponds to the\nnumber of days that the crop is\
    \ subject to a range of temperature that has been experimentally\nproven to be\
    \ optimal for stomatal exchanges. Crop growth is expressed as the product of\n\
    the solar radiation (w), the radiation-use efficiency (r), the growth function\
    \ G(T, t), and the\nstress function K(X, T, N, t) depending on water (X), temperature\
    \ (T), and nutrients (N),\ni.e.,\ndy\ndt = wrGK.\n(2)\nThe growth function G ∈\
    \ [0, 1] is formed by the combination of two logistic shapes:\none for the plant\
    \ vegetative growth from germination to the half of crop life with a positive\n\
    slope, and the second one for aging from the maturity to harvest with a negative\
    \ slope.\nThis type of model can be illustrated by considering the simple case\
    \ in [43]. Originally,\nthis model was presented in a discrete-time version that\
    \ used daily steps, as the environ-\nmental inputs were typically sensed and reported\
    \ daily. The potential growth function is\ngiven by\nG =\n\n\n\nθ1\n1+e−0.01(v−θ2)\
    \ ,\nv ≤ θ3\n2\nθ1\n1+e0.01(v+vs−θ3) ,\nv > θ3\n2 ,\n(3)\nWater 2022, 14, 889\n\
    8 of 37\nwhere v represents the cumulative temperature, θ1 is the maximum fraction\
    \ of radiation in-\nterception that the crop can reach, θ2 is the cumulative temperature\
    \ requirement for leaf area\ndevelopment to intercept 50% of radiation, θ3 is\
    \ the cumulative temperature requirement\nfrom sowing to maturity, and vs is the\
    \ temperature aging function accounting for the nega-\ntive effects of water and\
    \ temperature stresses. The stress function K, which penalizes the\ngrowth in\
    \ Equation (2), is represented as the product of single environmental stresses,\
    \ but\nalso includes an additional positive effect of CO2 (KCO2 ∈ [1, 1.3]), i.e.,\
    \ K = KTKXKNKCO2.\nAn example of wheat as a test crop that is sown on a deep loamy\
    \ soil is shown in\nFigure 2. Figure 2a shows the shape of the growth function\
    \ and senescence for non-stress\ncrop growth (K = 1) and two stress levels (K\
    \ < 1). The early senescence is directly related\nto stress amplitude. In correspondence,\
    \ Figure 2b shows the biomass evolution. Notice that\nany stress factor in Equation\
    \ (2) affects the growth function by narrowing the bell shape,\nbut also by attenuating\
    \ its height. Consequently, the presence of stress factors changes the\nslope\
    \ of the biomass production graph and its ﬁnal value.\n0\n20\n40\n60\n80\n100\n\
    120\n140\n160\nTime(days)\n0\n0.2\n0.4\n0.6\n0.8\n1\nGrowth\nNo stress\nLow stress\n\
    High stress\n0\n20\n40\n60\n80\n100\n120\n140\n160\nTime(days)\n0\n500\n1000\n\
    1500\n2000\n2500\nBiomass (ton h-1)\nNo stress\nLow stress\nHigh stress\n(a)\n\
    (b)\nFigure 2. Potential crop growth (ﬁrst-level description) and the stress effect\
    \ on senescence (including\nthe second and third levels) with the parameters θ1\
    \ = 0.95, θ2 = 480, and θ3 = 2200. (a) Growth\nengine shape under three levels\
    \ of stress and (b) the corresponding biomass production.\n2.1.2. Second Level\n\
    This level of model description involves water supply as a limiting growth factor.\n\
    Most of the water exchanges occur below the ground, which is why the water-in-soil\
    \ mass\nbalance equation is considered. This equation is the core of COMs, and\
    \ is often used to\ncompute the water stress factors. The water content in soil\
    \ x is computed by\ndx\ndt = −xT − xr − xd + u + wr,\n(4)\nwhere xT represents\
    \ the crop transpiration [47], xr represents the surface runoff, xd repre-\nsents\
    \ the drainage, u represents the irrigation, and wr represents the rainfall. As\
    \ mentioned\nearlier, a discrete-time version of the model equations is often\
    \ preferred for practical\npurposes. This discrete-time version can be obtained\
    \ using an explicit Euler method for\nnumerical integration, i.e.,\ndx\ndt = x(t\
    \ + ∆t) − x(t)\n∆t\n.\nEquation (4) with ∆t = 1 day and k as the discrete time\
    \ index, therefore, becomes\nx(k + 1) = x(k) − xT(k) − xr(k) − xd(k) + u(k) +\
    \ wr(k).\n(5)\nWater 2022, 14, 889\n9 of 37\nAn illustrative example of the behavior\
    \ of water ﬂuxes in a homogeneous area of soil\n(Equation (5)) is depicted in\
    \ Figure 3. The dynamics of water in soil are affected by rainfall\nand temperature\
    \ (not in the graph), where the negative effects (i.e., stresses for plants)\n\
    occur if the water in soil is above the ﬁeld capacity (saturation) and below the\
    \ wilting limit.\nNotice that for proper crop development, it is not necessary\
    \ to always ﬁll the soil up to the\nﬁeld holding capacity; instead, it is essential\
    \ to avoid soil dryness.\n0\n20\n40\n60\n80\n100\n120\n140\n160\nTime(days)\n\
    0\n20\n40\n60\n80\n100\nWater in soil (mm)\n0\n5\n10\n15\n20\n25\nOut flows (mm)\n\
    Water in soil\nRain\nField capacity\nWilting limit\nTranspiration\nRunoff\nDrainage\n\
    Figure 3. Water balance in a homogeneous soil with a reference root depth of 400\
    \ mm. The left axis\ncorresponds to water in soil, rainfall, and upper (ﬁeld capacity)\
    \ and lower (wilting limit) water limits.\nThe right-side axis corresponds to\
    \ the outgoing soil ﬂuxes (transpiration, runoff, and drainage). The\nvalues of\
    \ parameters used are α = 0.096, β = 0.55, η = 65, θ = 0.15, ζ = 400, and γ =\
    \ 0.06, in\naccordance with the full model description in Section 4.\nAn example\
    \ of a more elegant soil representation (i.e., with compartmental vertical\nlayers)\
    \ is the one proposed by AquaCrop [27]. In this latter model, the differential\
    \ ﬂow\nequation is replaced by a set of ﬁnite difference equations, which are\
    \ written in terms\nof the dependent variable x and the independent variable of\
    \ time (k). The vertical soil\nproﬁle is divided into m layers indexed from the\
    \ surface to the maximum depth considered\n(i = 1, ..., m), and the time k runs\
    \ from the sowing to the harvest day. This representation\nincludes the evaporation\
    \ effect in the surface layer and the rising effect due to the capillarity\nin\
    \ the presence of the water table. The moisture content xi(k) is determined for\
    \ each layer\nof the soil and for every time step as follows:\nxi(k) = xi(k −\
    \ 1) + xi\nT(k) + xi\nd(k) + xi\nf (k) + xi\nc(k) + xi\ne(k),\n(6)\nwhere the\
    \ superscript i is the index of the soil layer, xi\nT(k) is the crop transpiration,\
    \ xi\nd(k) is\nthe drainage of the soil proﬁle, xi\nf (k) is the water inﬁltration\
    \ into the soil proﬁle (after the\nsubtraction of surface runoff), xi\nc(k) is\
    \ the upward movement by capillary rise from a shal-\nlow groundwater table, and\
    \ xi\ne(k) represents the amount of water lost by soil evaporation.\nNotice that\
    \ the advantage of (6) over (5) is the separation of evaporation and transpiration,\n\
    which address the temperature effect in the top layers, and the vertical movements\
    \ of water.\nHowever, the price to pay is a large number of equations to solve.\n\
    2.1.3. Third Level\nIn this modeling level, the shortage of nitrogen (N) is considered.\
    \ Nitrogen is funda-\nmental for leaf development, production of chlorophyll,\
    \ and the synthesis of carbohydrates.\nHowever, nitrogen cycles in agriculture\
    \ are asynchronous and evolve at different rates.\nThere is a slow rate of natural\
    \ incorporation of nitrogen into the soil by microorganisms\nand nitrogen uptake\
    \ by plants, in contrast with the fast rates of nitrogen use inside the\nplants\
    \ and the nitrogen compounds withdrawn from the soil. Moreover, nitrogen provided\n\
    by fertilization is not fully retained in the soil, as only a fraction is used\
    \ by plants before\nemission of ammonia into the atmosphere and leaching losses\
    \ [48].\nWater 2022, 14, 889\n10 of 37\nThe nitrogen balance of the soil can be\
    \ represented as the difference between the\nnitrogen added by fertilization or\
    \ mineralization and the nitrogen removed by crop uptake\nand losses [49]. Therefore,\
    \ the rate of nitrogen in the soil (Ns) is given by:\ndNs\ndt = Nm + (αNR) − dNu\n\
    dt − Nl,\n(7)\nwhere Nm is the nitrogen supply through mineralization and biological\
    \ N ﬁxation, α is\nthe fertilizer nitrogen application rate, NR is the fertilizer\
    \ nitrogen recovery fraction, and\ndNu\ndt is the rate of nitrogen uptake by the\
    \ crop, which is calculated as the minimum of the\nN supply from the soil and\
    \ the N demand from the crop, and Nl represents the nitrogen\nlosses by leaching.\n\
    The net rate of change of nitrogen is\ndNn\ndt\n= dNu\ndt − Nt − Nd,\n(8)\nwhere\
    \ Nt is the nitrogen translocation and Nd is the loss due to death of the biomass.\n\
    A crop is assumed to experience N stress at N concentrations below a critical\
    \ value for\nunrestricted growth. To quantify crop response to nitrogen shortage,\
    \ a Nitrogen Nutrition\nIndex (NNI) is deﬁned, ranging from 0 (maximum N shortage)\
    \ to 1 (no N shortage)\nas follows:\nNNI = Nn − Nr\nNc − Nr\n,\n(9)\nwhere Nn,\
    \ Nc, and Nr are the actual, critical, and residual nitrogen content, respectively.\n\
    This index, as described in Section 2.1, can affect the growth function as a multiplicative\n\
    factor or as a modulator of the aging function.\n2.2. Compartmental Approach\n\
    A modeling approach that differs from the three levels of detail described in\
    \ the\nprevious subsections is the use of the concepts of storage compartments\
    \ or pools. In these\npools, the organic matter is divided into shoots, or aboveground\
    \ biomass (AGB), and\nroots [50]. This compartmental approach has the advantage\
    \ of discriminating phenological\ndevelopment before germination and after germination,\
    \ which is convenient for the use of\nremote sensing technology to measure state\
    \ variables. As the supply of carbon (C) creates a\ndemand for nitrogen (N), the\
    \ biomass above and below the ground can be divided into\nnitrogen and carbon\
    \ pools. In this case, the biomass (Y in kg m−2) can be decomposed into\nthe shoot\
    \ (YXsh) and root structures (YXrt), which are related to the C and N substrate\
    \ pools\nin shoots (YCSsh and YCSrt in kgC m−2) and roots (YNSsh and YNSrt in\
    \ kgN m−2). Shoot and\nroot substrate concentrations are deﬁned by\nCSsh =YCSsh\n\
    YXsh\n,\nNSsh =YNSsh\nYXsh\n,\nCSrt =YCSrt\nYXrt\n,\nNSrt =YNSrt\nYXrt\n,\nand\
    \ the differential equations of the state variables are:\nWater 2022, 14, 889\n\
    11 of 37\ndYCSsh\ndt\n= Pnet − fCXGXsh − OCSshrt − OCSsh−→T,\n(10a)\ndYCSrt\n\
    dt\n= OCSshrt − fCXGXrt − OCSrt−→T,\n(10b)\ndYNSrt\ndt\n= uN − fNXGXrt − ONSrtsh\
    \ − ONSrt−→T,\n(10c)\ndYNSsh\ndt\n= ONSrtsh − fNXGXsh − ONSsh−→T,\n(10d)\ndYXsh\n\
    dt\n= GXsh − OXsh−→Li,\n(10e)\ndYXrt\ndt\n= GXrt − OXrt−→Li,\n(10f)\ndYT\ndt =\
    \ GT, YT(0) = 0,\n(10g)\nwhere Pnet is the net photosynthetic rate (KgC m−2 d−1),\
    \ GXsh and GXrt, are the shoot and\nroot growth rates, fCX and fNX are the substrate\
    \ fluxes (kgC, N kg−1), OCSshrt is the flux of C\nfrom shoot to root, ONSshrt\
    \ is the flux of N from root to shoot (KgC, N m−2 d−1), OCSsh−→T,\nOCSrt−→T, ONSrt−→T,\
    \ and ONSsh−→T are the output fluxes of C and N from root and shoot to\nthe total\
    \ product (Kg C, N m−2 d−1), OXsh−→Li and OXrt−→Li are the litter fluxes by the\
    \ shoot\nand root structure senescence, and GT is the growth rate of the total\
    \ product (kg m−2 d−1).\nThis approach based on pools is attractive from a mathematical\
    \ point of view. However,\nit poses a challenge for the continuous measurement\
    \ of the related variables in the pools,\nparticularly the measurement of nitrogen\
    \ with nondestructive methods, which is still an\nopen research subject.\n2.3.\
    \ State-Space Representation and Variable Deﬁnition\nTo design irrigation strategies,\
    \ mathematical models can be built based on mass\nbalance equations and mechanistic\
    \ descriptions of crop–soil subprocesses, as illustrated\nin Table 2 for some\
    \ popular SOMs. These models can be cast into a standard nonlinear\nstate-space\
    \ representation:\n˙x(t) = f (x, u, θ),\nx(0) = x0,\n(11a)\ny(t) = h(x, θ),\n\
    (11b)\nwhere x is the vector of state variables, f (x, u, θ) is the vector of\
    \ functions that describe\nthe dynamics of the crop–soil system, u represents\
    \ the vector of inputs, including the\nenvironmental inputs ue and the artiﬁcial,\
    \ or manipulated, inputs ua, θ is the set of model\nparameters, y is the vector\
    \ of measurement outputs, and h(x, θ) is a vector of nonlinear\nfunctions relating\
    \ the state variables with the measurable variables. It is important to note\n\
    that the crop–soil system is a positive system, i.e., the trajectory of the state\
    \ variables starting\nfrom a positive initial condition always remains positive,\
    \ regardless of the values of the\ninput variables. However, crop–soil models\
    \ can preserve this fundamental property only if\nthey are properly formulated.\
    \ The environmental inputs cannot be inﬂuenced, but can be\nsensed at regular\
    \ time intervals (for instance daily), whereas the manipulated variables,\ne.g.,\
    \ fertilization or irrigation, allow one to act on the evolution of the soil–crop\
    \ system. In\nTable 2, the main modules (in many reported studies, the models\
    \ are actually not presented\nas a global system of equations, but more as a set\
    \ of software modules achieving the\ncomputation of the outcome of speciﬁc subprocesses)\
    \ of selected SOMs are presented based\non a functional decomposition of the soil–crop\
    \ subprocesses. Mass balance modules are\nsolutions of differential or difference\
    \ equations, whereas other modules are sets of algebraic\nequations or heuristic\
    \ formulations, e.g., modules for the evapotranspiration subprocess.\nPests, diseases,\
    \ and weeds may further limit crop production at all developmental stages.\nWater\
    \ 2022, 14, 889\n12 of 37\nHowever, these factors are not considered in detail\
    \ in this review, which is dedicated to\nmathematical modeling and control to\
    \ support irrigation.\nThe models have uncertainty related to the inputs, the\
    \ structure, and the model pa-\nrameters. These uncertainties can be formulated\
    \ as probability distributions and can be\naccounted for in the models. In [51],\
    \ the authors demonstrated that the uncertainty in the\nmodel structure was larger\
    \ than in the model parameters. However, as SOMs were devel-\noped for scientiﬁc\
    \ understanding as well as decision/policy support, the model uncertainty\nwas\
    \ limited to the bias in the ﬁnal output, and there was no tracking of how the\
    \ uncertainty\nwas propagated in the model. As an alternative, in [52], the authors\
    \ proposed the use of\nmulti-model ensembles (MMEs) to quantify model structural\
    \ uncertainty, showing that they\nrely on parts of models that are based on traditional\
    \ heuristics. In contrast, the uncertainty\nin a COM can be analyzed by considering\
    \ the state-space structure.\n3. Sensors and Instrumentation\nIn modern agricultural\
    \ systems, there is a network of interconnections among farmers,\nsensors, actuators,\
    \ machinery, and cultivated areas, forming a so-called cyber–physical–\nhuman\
    \ system (CPHS) [53]. In this context, farmers play a key role as decision makers\n\
    regarding the management of cultivated areas and food production in general. A\
    \ global\npicture is rpresented in Figure 4.\nFigure 4. Sensors, actuators, scheduling,\
    \ and control in the context of farm decision making. When au-\ntomatic irrigation\
    \ control is enforced, the feedback is implicit in this block, as the sensors\
    \ continuously\nretrieve data and signals from the ﬁeld to feed the control system.\n\
    Of course, the information provided by the sensors is a keystone for the development\n\
    of dynamic models, the estimation of parameters, and the development of more elaborate\n\
    monitoring and control schemes. For instance, soil moisture (SM) and soil water\
    \ content\n(SWC) are essential in irrigation. Traditionally, these variables were\
    \ measured using\nprobes, e.g., stick probes, neutron probes, phene cells, time-domain\
    \ reﬂectometers (TDRs),\nand tensiometers. The variables are related to physical\
    \ properties, such as capacitance,\nresistivity, heat conductance, and mechanical\
    \ force. Other methods involve collecting\nsamples to be analyzed ofﬂine, such\
    \ as gravimetric measurement, with the drawback of\nbeing noncontinuous in time\
    \ and space. However, more reliable remote methods have\ngained interest in the\
    \ last decade due to their coverage of large ﬁelds. These include\nground-penetrating\
    \ radar (GPR), aerial photography, multi- and hyperspectral imagery,\nand electromagnetic\
    \ induction (EMI). A list of common state variables included in SOMs,\nas well\
    \ as the possible types of sensing techniques, is provided in Table 4.\nWater\
    \ 2022, 14, 889\n13 of 37\nTable 4. Common state variables and typed of sensing\
    \ methods—D: direct measurement, P: proximity,\nand R: remote sensing.\nVariable\n\
    Description\nType\nReference\nSM\nSoil moisture\nD, R, P\n[54–57]\nLAI\nLeaf area\
    \ index\nR, P\n[58–60]\nET\nEvapotranspiration\nD, R\n[61,62]\nPAR\nPhotosynthetically\
    \ active radiation\nR\n[8,63]\nAGB\nAboveground biomass\nD, R\n[64–66]\nDVS\n\
    Developmental state\nD\n[11,67]\nNDVI\nNormalized vegetation index\nR\n[63,64,67]\n\
    EVI\nEnhanced vegetation index\nR\n[67,68]\nTSAVI\nTransformed soil-adjusted vegetation\
    \ index\nR\n[69,70]\nVI\nVegetation index\nR\n[63,71]\nLNA\nLeaf nitrogen accumulation\n\
    D, P\n[12,72]\nCC\nCanopy cover\nR\n[72,73]\nCNA\nCanopy nitrogen accumulation\n\
    R\n[12,72]\nVTCI\nVegetation temperature condition index\nR\n[11,74]\nSWC\nSoil\
    \ water content\nD, P\n[55,75,76]\nRH\nRelative humidity\nD, R, P\n[77,78]\nAGN\n\
    Aboveground nitrogen accumulation\nD, R\n[79,80]\nThe output equation of the state-space\
    \ representation (Equation (11b)) is described by\nthe nonlinear vector function\
    \ h(x, θ), whose structure will highly depend on the underlying\nphysical principles\
    \ and technology of the measurements. In some speciﬁc cases, this\nnonlinear equation\
    \ can reduce to a linear one in the form\ny = C(θ)x,\n(12)\nwhere C(θ) is a constant\
    \ matrix depending on parameter θ. As a practical example, let\nus consider the\
    \ soil moisture sensor presented in [81]. In this work, the output variable y\n\
    (relative soil moisture) is given by\ny = w\n\x12 γd\nγw\n\x13\n,\n(13)\nwhere\
    \ w is deﬁned as the ratio of the mass of moisture present in the soil sample\
    \ to the\ndried mass of the sample, γd is the dry unit weight of the soil, and\
    \ γw is the unit weight of\nwater. However, many of the output variables are not\
    \ linearly related to the state variables.\nThe data acquisition system includes\
    \ sensors, measurement instruments, transducers,\nand algorithms. The sensing\
    \ devices can retrieve information about physical variables\nthrough direct (i.e.,\
    \ ground sensors) or indirect contact (i.e., proximity or remote sensing).\nTraditionally,\
    \ direct measurements are restricted by the locations of the sensors. This issue\n\
    was discussed in [82,83], where the main conclusion was that direct measurements\
    \ are still\nrequired as a part of a monitoring and sensing system. Moreover,\
    \ there are soil properties\nthat can only be sensed directly, e.g., soil organic\
    \ carbon [84]. The big advantage of ground\nsensors is the precision and reliability\
    \ of measurements independently of environmental\nconditions. The drawback is\
    \ the limited capability of representing the heterogeneity of\na cropping area,\
    \ as the ground sensors are ﬁxed in particular locations. To alleviate this\n\
    latter issue, proximity sensors are used for their ﬂexibility. These sensors require\
    \ one to be\nclose to the crop and soil, but are portable and, therefore, can\
    \ be installed in unmanned\naerial vehicles (UAV), ground robots, or agricultural\
    \ machinery. However, portability\nand mobility cannot ensure a simultaneous and\
    \ global measurement of a cultivated area,\nand arrays of sensors—especially wireless\
    \ sensor networks, as suggested by [85,86]—can\nresolve this global picture. However,\
    \ this approach is, in turn, limited by the size of\nthe cropping ﬁeld. Hence,\
    \ remote sensing (RS) appears as the ultimate solution due to\nthe ability to\
    \ simultaneously encompass multiple measurements over diverse scales of\nWater\
    \ 2022, 14, 889\n14 of 37\ncropping land. These techniques are particularly well\
    \ suited for water-related variables in\nclimate change scenarios [87].\nRS is\
    \ a current research and development trend due to its advantages of capturing\n\
    large amounts of data all at once. RS gathers Earth observations (EOs), which\
    \ are limited by\nthe orbit and periodicity of satellites, and aerial imagery,\
    \ which is limited by the frequency\nof capture and weather conditions. In either\
    \ case, some variables must be inferred by\ncombining data from multiple sensors\
    \ in different wavelengths or other variables [67]. For\ninstance, in [61], the\
    \ evapotranspiration (ET) was derived from the solution of the energy\nbalance\
    \ equation by using short-wave and long-wave band inputs from satellite sensors\
    \ to\nestimate net radiation (Rn), soil heat ﬂux (G), and sensible heat ﬂux (H),\
    \ with the latent heat\nﬂux (LE) obtained as a residual (LE = Rn − G − H). The\
    \ LE could then be extrapolated\nfrom a quasi-instantaneous value at the time\
    \ of the satellite overpass to a daily ET value\nusing different methods, such\
    \ as the evaporative fraction or the reference ET fraction. For\nlarge-scale crops,\
    \ EOs are suited to collecting information that is simultaneously related to\n\
    crop and ﬁeld variables. However, the spatial resolution is an issue for non-ﬂat\
    \ land. A\ndescriptive presentation of the sensors embedded in active satellites\
    \ is provided in [12],\nwhich includes frequency range and spatial and temporal\
    \ resolution. Optical and thermal\nsensors are highly sensitive to climatic conditions.\
    \ For this reason, other sensors, such as\nsynthetic aperture radar (SAR), prove\
    \ to be an effective technique for monitoring crops\nand other agricultural targets,\
    \ as they do not depend on weather conditions [88]. This\ntechnology was discussed\
    \ in [71], which provided a review of the diverse vegetation\nindexes associated\
    \ with state variables and discussed the limitations linked to the current\ninformation\
    \ retrieved from SAR sensors and optical/thermal signals to derive variables\n\
    such as crop height (which is typically sensed by airborne instruments, such as\
    \ light\ndetection and ranging (LiDAR)).\nReviews of particular data acquisition\
    \ systems have recently been published. For\ninstance, the authors of [89] surveyed\
    \ soil moisture measurements by considering ground,\nproximal, and satellite remote\
    \ sensing. One of the main challenges is to combine point obser-\nvations, which\
    \ are commonly obtained with in situ techniques, such as simple gravimetric\n\
    sampling or various electromagnetic sensors, with a spatial representation of\
    \ the water\ndistribution. The problem is to properly capture spatial variability\
    \ without deploying too\nmany sensors. A possible solution is to combine ground-based\
    \ and airborne or spaceborne\nremote sensing techniques to provide a characterization\
    \ and monitoring of large-scale\nnear-surface soil properties and processes at\
    \ reasonable temporal and spatial resolutions.\nOther environmental and weather\
    \ variables can be retrieved from either portable or\nofﬁcial meteorological stations\
    \ with regional coverage near the ﬁeld. The portable stations\nlocated in the\
    \ ﬁeld have the advantage of reducing the uncertainty of some variables,\nas their\
    \ measurement precision is comparable to that of regional meteorological stations,\n\
    which are usually situated several kilometers away from the ﬁeld [90].\n4. Model\
    \ Identiﬁcation\nOnce a model structure has been established based on mass and\
    \ energy balances and\nthe use of physical and heuristic relations, the model\
    \ needs to be calibrated in order to ﬁt\nto the experimental observations. This\
    \ operation of model calibration is called parameter\nestimation or identiﬁcation\
    \ in the systems and control literature. System identiﬁcation\ngathers a set of\
    \ statistical techniques that allow the designer to assess the values of model\n\
    parameters based on signals and data from measurable inputs and outputs. Identiﬁcation\n\
    is a broad subject that is well documented in the literature, and we refer the\
    \ interested\nreader to a few monographs and textbooks, including [91,92].\nBasically,\
    \ system identiﬁcation proceeds in several steps, which can be iterated and\n\
    can be summarized as follows:\n•\ndata collection;\n•\ndeﬁnition of the model\
    \ objectives (simulation or control) and of the model structure;\n•\nidentiﬁability\
    \ study;\nWater 2022, 14, 889\n15 of 37\n•\nparameter estimation;\n•\nevaluation\
    \ of parameter uncertainties and of confidence intervals in the model prediction;\n\
    •\nmodel validation and cross-validation.\nThis section discusses the parameter\
    \ estimation problem of a crop–soil mathematical\nmodel with a known structure,\
    \ i.e., once the selection of an appropriate model struc-\nture has been achieved\
    \ by following the ideas in Section 2, starting with the question of\nparameter\
    \ identiﬁability.\n4.1. Identiﬁability\nInitially, an identiﬁability study will\
    \ indicate whether it is possible to determine\nthe parameter values from the\
    \ available data. More precisely, two types of identiﬁability\nstudies can be\
    \ achieved, i.e., structural and practical [93]. The ﬁrst assesses the possibility\
    \ of\nestimating the model parameters given ideal measurements, i.e., it allows\
    \ the determination\nof which output signals should be measured, assuming that\
    \ they are available in continuous\ntime and without noise. Several mathematical\
    \ approaches can be used to achieve this\nanalysis, and specialized software is\
    \ available, e.g., DAISY [94], GENSSI [95], SIAN [96],\nand STRIKE-GOLDD [97],\
    \ among others. To the best of our knowledge, these methods and\nsoftware have\
    \ rarely been used in the modeling of agricultural systems.\nPractical identiﬁability\
    \ deals with the possibility of assessing all or some of the model\nparameters\
    \ under realistic conditions, e.g., sampled data and measurement noise.\nThe basic\
    \ tool in this latter study is parametric sensitivity analysis, which can be local\n\
    [91] or global, and it takes account of the interactions between parameter effects\
    \ [98–100].\nSensitivity analysis has been applied in several studies of crop\
    \ models. For instance,\nin [101], the sensitivity of four yield outputs of the\
    \ APSIM-Sugar model to 13 parameters\nin rain-fed and irrigated conditions was\
    \ studied using a global sensitivity method based on\nthe decomposition of variance\
    \ of the outputs known as Gaussian process emulation. As\nsome crop models are\
    \ difﬁcult to analyze, as they are not fully mechanistic, but include\nempirical\
    \ rules, it might also be interesting to using automatic differentiation tools\
    \ to\nachieve sensitivity analysis, as demonstrated in [102].\nIn this paper,\
    \ we limit ourselves to a brief introduction of the basic concepts related to\n\
    a local analysis and consider the model m(t; θ), which is based on the vector\
    \ of parameters\nθ, of the measured output y(t):\ny(t) = m(t; θ) + ε(t).\n(14)\n\
    In the case of a Gaussian distribution of zero-mean white noise ε(t), the Fisher\
    \ Infor-\nmation Matrix (FIM) can be deﬁned as\nFθ =\nM\n∑\ni=1\n∂m⊤(ti, θ)\n\
    ∂θ\nΩ−1 ∂m(ti, θ)\n∂θ⊤\n,\n(15)\nwhere Ω is the covariance matrix of the measurement\
    \ errors ε(t), ∂m(θ)\n∂θ⊤\nrepresents the\nﬁrst-order parametric sensitivity matrix,\
    \ and M represents the number of data points.\nThe inverse of the FIM provides\
    \ a lower bound (the so-called Cramer–Rao bound) of the\ncovariance matrix of\
    \ the parameter estimation errors, i.e.,\nPθ ≻ F−1\nθ\n.\n(16)\nA parameter estimation\
    \ method that can achieve the Cramer–Rao lower bound is\ncalled efﬁcient. The\
    \ FIM is a covariance matrix and, as such, is positive semideﬁnite. The\nFIM can\
    \ be used to assess practical identiﬁability through a rank condition (a rank-deﬁcient\n\
    FIM indicates that the model is not identiﬁable with the data at hand). In turn,\
    \ if the\nparameters are identiﬁable, the Cramer–Rao bound can be used to provide\
    \ conﬁdence\nintervals for the estimated parameters (which are, unfortunately,\
    \ often not given in the\npublished literature on parameter identiﬁcation of crop\
    \ models). In general, the use of\nWater 2022, 14, 889\n16 of 37\n(local or global)\
    \ sensitivity analysis will be an important tool for determining the most\ninﬂuential\
    \ parameters of a model, which requires estimation based on experimental data\n\
    and may be re-estimated at a later stage if the environmental conditions have\
    \ changed.\nA challenge in the identiﬁcation of crop–soil models is to deal with\
    \ a large number\nof parameters. For instance, DSSAT [32] has more than 300 parameters,\
    \ STICS [103] has\n232 parameters, AquaCrop [104] has 29 parameters, and EPIC\
    \ [33] has 22 parameters.\nAn approach to reducing the number of parameters to\
    \ consider is to use speciﬁc crop\nmodels instead of generic models, e.g., CERES-Wheat\
    \ [47]. Another option is to derive\nmore compact models, which are usually called\
    \ summary crop models [6]. These summary\nmodels can be developed in several ways—ﬁrst,\
    \ as a simpliﬁcation of full-scale models, e.g.,\nFIELD presented by [105] as\
    \ a crop–soil subsystem based on APSIM [44] and mini-STICS, a\ncompact and limited\
    \ version of STICS [103] presented in [106]. Further, compact models\ncan be included\
    \ in additional software tools, e.g., the OptimiSTICS package [107]. In this\n\
    case, the aim is to guide the user into parameter estimation under various assumptions.\n\
    For instance, this software package was used in [108] to estimate a set of parameters\
    \ of\nthe STICS model. Alternatively, it is possible to build simple new generic\
    \ crop models\non a mechanistic basis, e.g., the simple model [43], which includes\
    \ 14 equations with 13\nparameters. In conclusion, the modeler will generally\
    \ have to either reduce the model under\nconsideration or to decide on a subset\
    \ of parameters to estimate in order to ensure practical\nparameter identiﬁability\
    \ before embarking on the actual parameter estimation task.\n4.2. Parameter Estimation\n\
    Parameter estimation is based on the minimization of the deviation between the\
    \ model\nprediction m(t; θ), which depends on a set of parameters θ, and the measured\
    \ outputs y(t).\nA general approach is the maximum likelihood estimator (MLE)\
    \ [91]:\nˆθ = arg min\nθ\n1\n2\nM\n∑\ni=1\n(y(ti) − m(ti, θ))TΩ−1(y(ti) − m(ti,\
    \ θ)),\n(17)\nwhere M is the number of data points and Ω is the covariance matrix\
    \ of the measurement errors.\nOther weighting matrices can be considered, leading\
    \ to weighted least-squares estimators.\nFor instance, the generalized least squares\
    \ (GLS) method was used in [109] to estimate\nthe parameters and to compute the\
    \ variance–covariance matrix of the cultivar parameters\nof APSIM [44] and DSSAT\
    \ [32]. In [108], a Bayesian approach was used to identify the\nparameter of the\
    \ STICS crop model [103] based on the Differential Evolution Adaptive\nMetropolis\
    \ (DREAM) algorithm [110], which is a variation of the Monte Carlo Markov\nChain\
    \ (MCMC) algorithm.\nOne of the main dangers in achieving parameter estimation\
    \ is the risk of local minima\nof the cost function, leading to biased parameter\
    \ estimates. This problem can be alleviated\nby using multistart strategies [111],\
    \ i.e., repeated optimization starting from a large set\nof initial parameter\
    \ guesses sampled in the design space, and through the use of global\noptimization\
    \ algorithms [112].\n4.3. Model Validation and Uncertainty Analysis\nAfter the\
    \ model parameters have been determined, model cross-validation should be\nachieved\
    \ by comparing the model prediction to a fresh, unseen dataset in order to ensure\n\
    that the model identiﬁcation has not been subjected to local minima. The uncertainty\
    \ of\nparameters should then be evaluated [113] by using various methodologies,\
    \ including the\nFisher Information Matrix and Monte Carlo analysis.\nIn [101],\
    \ an uncertainty propagation analysis was performed assuming both normal\nand\
    \ uniform distributions to conclude with a cross-validation. The results conﬁrm\
    \ the\ndistinct variation of parameter inﬂuence between climatic and management\
    \ conditions.\nThe generalized likelihood uncertainty estimation (GLUE) method\
    \ was used in [114] to\ngenerate 10,000 random parameter sets, including one calibrated\
    \ parameter set, to explore\nthe effects of parameter uncertainty on model output.\
    \ GLUE was also exploited in [115] to\nWater 2022, 14, 889\n17 of 37\nanalyze\
    \ the DSSAT-CERES model [116]. In [108], the posterior distributions of nine speciﬁc\n\
    crop parameters of the STICS model were sampled with the aim of assessing the\
    \ growth of\na winter wheat culture.\nIn addition, cross-validation is helpful\
    \ in dealing with the parameter overﬁtting\nproblem [117]. In [118], the authors\
    \ identiﬁed ten parameters of AquaCrop and used\nthe MCMC to infer the uncertainty\
    \ in the parameters by approximating the posterior\ndistribution function with\
    \ eight experimental datasets.\n4.4. Illustrative Example: Water Balance in Soil\n\
    To illustrate the previous concepts, the model introduced in Equation (5) is used\
    \ as an\nexample. This COM is based on water mass balance in soil. Considering\
    \ that measurements\nare available for transpiration (x1), runoff (x2), drainage\
    \ (x3), and available water in the\nroot zone (x4), the model can be expanded\
    \ as follows:\nx1(k) = min(α(x4(k) − ζ γ), w2(k)),\n(18a)\nx2(k) =\n( (w1(k)−0.2S)2\n\
    w1(k)+0.8S ,\nw1(k) > 0.2S\n0,\nw1(k) ≤ 0.2S,\n(18b)\nx3(k) =\n(\n−β(x4(k) + w1(k)\
    \ − x2(k) − ζ(γ + θ)),\nx4(k) + w1(k) − f2(k) > ζ(γ + θ)\n0,\nx4(k) + w1(k) −\
    \ x2(k) ≤ ζ(γ + θ),\n(18c)\nx4(k + 1) = x4(k) − x1(k) − x2(k) − x3(k) + u(k) +\
    \ w1(k),\n(18d)\ny(k) = [x1(k)\nx2(k)\nx3(k)\nx4(k)],\n(18e)\nwhere w1 is rainfall,\
    \ w2 is the reference grass evapotranspiration, and there is no irrigation,\n\
    i.e., u = 0. The set of parameters are the water uptake coefﬁcient α, the drainage\
    \ coefﬁcient\nβ, the runoff curve number η, the available water capacity θ, the\
    \ root zone depth ζ, and the\nwilting point γ. S = 25,400\nη−254 is the potential\
    \ maximum retention depending on the soil type.\nFirst, we conduct an uncertainty\
    \ and sensitivity analysis by applying Monte Carlo\nsimulations and a Sobol global\
    \ sensitivity method, as implemented in the Python library\nUncertainPy [119]\
    \ and the Sensitivity Analysis Library SALib [120]. In [121], the same\nmodel\
    \ (Equation (18)) was used to compute a drought index named ARID. The authors\n\
    proposed different probability density functions (PDFs) (i.e., uniform, normal,\
    \ triangular,\nand custom) for ﬁve parameters (i.e., α, β, η, θ, ζ) and performed\
    \ a Fourier amplitude\nsensitivity test to assess the uncertainty and sensitivity.\
    \ In contrast with this previous work,\nwe include the wilting point γ and consider\
    \ the cumulative available water in the root zone\nas an output variable, since\
    \ our objective is to determine the positive and negative impacts\nof water in\
    \ soil.\nThe uncertainty decreases from 40 to 24% when changing from uniform to\
    \ normal\ndistributions. The parameter β is the most relevant, with 36% participation\
    \ in the global\nsensitivity. ζ and α follow with 26% and 25%, respectively. The\
    \ full sensitivity test ranks\nthe inﬂuence of the parameters as β > ζ > α > η\
    \ > γ > θ, with negligible inﬂuence of the\nlast three. This result suggests that\
    \ the parameters related to the mechanical properties of\nsoil are more relevant\
    \ than the ones related to volume constraints.\nNext, we perform a parameter estimation\
    \ based on nonlinear least squares. The\nbasic assumption is that measurements\
    \ can be collected daily for the four xi(k) variables\n(i = 1, ..., 4). In the\
    \ framework of this example, we generate the measurements using the\nsame model\
    \ and add Gaussian noise to x1, x2, x3, and x4 corresponding to 8%, 3%, 5%, and\n\
    7% of the relative standard deviation, respectively. These noise levels are coherent\
    \ with\nthe corresponding instrumentation [55,122], but they are assumed to be\
    \ unknown to the\nprocess modeler such that a simple weighted least-square approach\
    \ is used here with a\nweighting matrix that takes account of the scaling of several\
    \ variables (the variables have\ndifferent orders of magnitude, and the scaling\
    \ avoids distortion in the contributions of the\ndifferent variables to the cost\
    \ function). Notice that the information content of the data\nat hand is crucial.\
    \ For x2, only seven measurements contain useful information, and for\nWater 2022,\
    \ 14, 889\n18 of 37\nx3, sixteen samples do so (see Figure 5b,c). The nominal\
    \ values of the process emulator\nparameters and their estimates are presented\
    \ in Table 5. Conﬁdence intervals of 95% are\ncomputed using the Fisher Information\
    \ Matrix. The model prediction is shown in Figure 5.\nTable 5. Parameters of the\
    \ process emulator, identiﬁed values, and 95% conﬁdence intervals.\nParameter\n\
    Description\nUnit\nNominal\nValue\nIdentiﬁed\nValue\nConﬁdence\nLb\nInterval\n\
    Ub\nDeviation\nα\nWater uptake coefﬁcient\n-\n0.096\n0.0869\n0.0792\n0.0947\n\
    8.9%\nβ\nDrainage coefﬁcient\n-\n0.55\n0.6545\n0.5825\n0.7265\n11.0%\nη\nRunoff\
    \ curve number\n-\n65\n64.9794\n62.8535\n67.1053\n3.3%\nθ\nAvailable water capacity\n\
    -\n0.24\n0.1990\n0.1791\n0.2189\n10.0%\nζ\nRoot zone depth\nmm\n600\n464.9227\n\
    422.1499\n507.6956\n9.2%\nγ\nWilting point\n-\n0.075\n0.0865\n0.0792\n0.0938\n\
    8.4%\n0\n50\n100\n150\n200\nTime(days)\n0\n1\n2\n3\n4\n5\nx1 (mm)\nsystem emulator\n\
    measurements\nidentified model\n0\n50\n100\n150\n200\nTime(days)\n0\n5\n10\n15\n\
    20\nx2 (mm)\nsystem emulator\nmeasurements\nidentified model\n(a)\n(b)\n0\n50\n\
    100\n150\n200\nTime(days)\n0\n5\n10\n15\n20\n25\nx3 (mm)\nsystem emulator\nmeasurements\n\
    identified model\n0\n50\n100\n150\n200\nTime(days)\n20\n40\n60\n80\n100\n120\n\
    140\n160\nx4 (mm)\nsystem emulator\nmeasurements\nidentified model\n(c)\n(d)\n\
    Figure 5. Direct validation: (a) transpiration, (b) runoff, (c) drainage, and\
    \ (d) available water in soil.\nRainfall and evapotranspiration were retrieved\
    \ from [123].\nA Monte Carlo simulation is used to assess the uncertainty of the\
    \ model prediction\nwith the identiﬁed parameter values of the parameters in their\
    \ 95% conﬁdence intervals.\nThe results are shown in Figure 6, where 20,000 runs\
    \ generate a shaded light-blue region\nand the solid blue line corresponds to\
    \ the identiﬁed parameters.\nAfterward, cross-validation is performed using a\
    \ new dataset. The results show that\nthe model with its previously estimated\
    \ parameters is able to reproduce the dynamic\nbehavior of the soil for other\
    \ climatic conditions with an error of less than 3%, as shown in\nFigure 7.\n\
    Water 2022, 14, 889\n19 of 37\n0\n50\n100\n150\n200\nTime(days)\n0\n1\n2\n3\n\
    4\n5\nx1 (mm)\n0\n50\n100\n150\n200\nTime(days)\n20\n40\n60\n80\n100\n120\n140\n\
    160\n180\nx4 (mm)\n(a)\n(b)\nFigure 6. Monte Carlo simulation for (a) transpiration\
    \ and (b) available water in soil. The dark blue\nline corresponds to the model\
    \ prediction with the identiﬁed parameter values.\n0\n50\n100\n150\n200\nTime(days)\n\
    0\n1\n2\n3\n4\n5\nx1 (mm)\ndata points\nmodel prediction\n0\n50\n100\n150\n200\n\
    Time(days)\n40\n60\n80\n100\n120\n140\n160\nx4 (mm)\ndata points\nmodel prediction\n\
    (a)\n(b)\nFigure 7. Cross-validation with a previously unseen (for the identiﬁcation\
    \ procedure) dataset [123]\nfor (a) transpiration and (b) available water in soil.\n\
    5. State Estimation and Software Sensors\nState estimation algorithms allow the\
    \ reconstruction of non-measured state variables\nin real time based on a model\
    \ of the system and some on-line measurements collected\nfrom available sensors.\
    \ In this way, a state estimator constitutes a so-called software\nsensor, in\
    \ contrast with a conventional hardware sensor. Aside from the estimation of\n\
    non-measured state variables, state estimators can also be used for the reconstruction\
    \ of\ndiscrete-time information in continuous time, the fusion of redundant information,\
    \ the\ndetection and isolation of hardware sensor faults, or the estimation of\
    \ model parameters.\nSome introductory surveys related to biological systems can\
    \ be found in [124,125], and a\nmonograph dedicated to crop systems is found in\
    \ [113].\nIn the literature, the notion of data assimilation is also sometimes\
    \ used to designate the\nprocess of combining a mathematical model with measurements\
    \ to improve the prediction\nof some state variables or to estimate the initial\
    \ condition of the model. Historically, data\nassimilation originates from the\
    \ ﬁeld of weather forecasting, and it shares many common\nfeatures with state\
    \ estimation techniques, even though the problem of reconstructing\nnon-measured\
    \ variables and the notion of observability are more typical of the literature\n\
    dedicated to state estimation. In this review, we will stick with the wording\
    \ of the system\nand control community and use state estimation instead of data\
    \ assimilation.\nA state estimator (also known as a state observer) usually has\
    \ the following extended\nLuenberger form:\n˙ˆx(t) = f ( ˆx(t), u(t)) + K(y(t)\
    \ − ˆy(t))\nˆx(0) = ˆx0,\n(19)\nWater 2022, 14, 889\n20 of 37\nwhich embeds a\
    \ copy of the dynamic system ˙x(t) = f (x, u) for predicting the state trajectory\n\
    and includes a correction term K(y − ˆy) that measures the deviation between the\
    \ hardware\nsensor information y and its prior estimate ˆy(t).\nMany state estimation\
    \ approaches have been proposed. Some of them take account\nof measurement noise\
    \ (such as Kalman ﬁlters or receding-horizon observers), model\nuncertainties\
    \ or disturbances (such as high-gain observers or sliding-mode observers), or\n\
    uncertainties in model parameters and inputs (such as interval observers). In\
    \ general, a\nsystem property called observability must be checked before embarking\
    \ on the selection\nand design of an estimator.\n5.1. Observability\nA system\
    \ is said to be observable if the current state vector can be estimated using\n\
    the information from the sensors collected over a ﬁnite period of time. Observability\
    \ is a\nstructural property of a system, but for nonlinear systems, this property\
    \ also depends on\nthe input signals.\nThere are several approaches to the observability\
    \ analysis of nonlinear systems. The ba-\nsic one is based on the differentiation\
    \ of the output and the construction of an observability\nmap. For output j of\
    \ system (11), the following set of derivatives can be computed:\nqj(x, u) =\n\
    \n\nyj(t)\n˙yj(t)\n...\ny\n(nqj−1)\nj\n(t)\n\n\n=\n\n\nqj,1(x,\
    \ u)\nqj,2(x, u)\n...\nqj,nqj (x, u)\n\n\n=\n\n\nhj(x)\n∂qj,1\n∂x\
    \ f (x, u) +\n∂qj,1\n∂u ˙u(t)\n...\n∂qj,nqj −1\n∂x\nf (x, u) +\n∂qj,nqj −1\n∂u\n\
    ˙u(t)\n\n\n.\n(20)\nThe observability map is given by:\nq(x, u) =\n\n\
    \nq1(x, u)\n...\nqny(x, u)\n\n,\ndim(q(x, u)) = nq =\nny\n∑\nj=1\nnqj ≥\
    \ nx.\n(21)\nIf a partition of the complete observability map is injective with\
    \ respect to the state\nvariables, then the system is observable. However, the\
    \ analytical solution of the nonlinear\nsystem is often difﬁcult, or even impossible,\
    \ to ﬁnd. Local observability can be checked\nthanks to the inverse mapping theorem\
    \ (local inverse):\nO(x, u) =\n∂q(x, u)\n∂x\n.\n(22)\nIf the Jacobian is nonsingular,\
    \ an inverse function exists in some neighborhood of x,\nand local observability\
    \ is proven.\nrank(O(x, u)) = nx\nor det(O(x, u)) ̸= 0.\n(23)\nNote that structural\
    \ identiﬁability can be studied as observability by considering the\nparameters\
    \ as state variables with zero dynamics [126].\nA second approach to global observability\
    \ analysis is provided by the use of a canonical\nform [127,128]:\nWater 2022,\
    \ 14, 889\n21 of 37\n˙x =\n\n\n˙x1\n...\n˙xi\n...\n˙xq−1\n˙xq\n\n\n\
    =\n\n\nf 1(x1, x2, u)\n...\nf i(x1, ..., xi+1, u)\n...\nf q−1(x1, ...,\
    \ xq, u)\nf q(x1, ..., xq, u)\n\n\n,\ny =\n\n\nh1(x1\nh2(x1 1)\n\
    1, x1\n2)\n...\nhn1(x1\n1, ..., x1\nn1)\n\n,\n(24)\nwhere\nxT =\nh\nx1, .\
    \ . . , xqi\n,\nf T =\nh\nf 1, . . . , f qi\n,\nxi,T =\nh\nxi\n1, . . . , xi\n\
    ni\ni\n,\nhT = [h1, . . . , hn1]\n∀i ∈ {1, ..., q},\nxi ∈ Rni,\nn1 ≥ n2 ≥ ...\
    \ ≥ nq,\n∑\n1≤i≤q\nni = nx.\nA system is said globally observable if\n∀j ∈ {1,\
    \ ..., n1} :\n∂hj\n∂x1\nj\n̸= 0.\n(25)\n∀i ∈ {1, ..., q − 1},\n∀(x, u) ∈ Rnx ×\
    \ Rnu :\nrank\n∂ f i(x, u)\n∂xi+1\n= ni+1.\n(26)\nMany systems naturally appear\
    \ in this form, or can be brought into this form by a\nchange of variables.\n\
    Finally, an alternative approach to studying global observability that includes\
    \ un-\nknown inputs (some system inputs can be uncertain or unknown, such as some\
    \ environmen-\ntal conditions) is provided in [129], where a dynamic interpretation\
    \ of state observability\nis developed.\nObservability Analysis of a Plant-Growth\
    \ Model\nTo illustrate these observability tests, let us consider a qualitative\
    \ mathematical model\nrepresenting the relationship between supplied water and\
    \ plant growth [130]. This model\nrelates the water in soil x1(t) with the water\
    \ inside the plant for its growth x2(t) and the\namount of dry matter x3(t). The\
    \ state-space representation is given by\n˙x1(t) = −θ1x1(t) − θ2\nx2(t)x1(t)\n\
    1 + θ3x2(t) + u(t),\n(27a)\n˙x2(t) = θ4\nx2(t)x1(t)\n1 + θ3x2(t) − θ5x2(t) − θ6x3(t)x2(t)\n\
    1 + θ7x3(t) ,\n(27b)\n˙x3(t) = θ8x3(t)x2(t)\n1 + θ7x3(t) − θ9x3(t),\n(27c)\ny(t)\
    \ = [x1(t) x3(t)],\n(27d)\nwhere it is assumed that the variables x1 and x3 can\
    \ be measured.\nIn this model, the water in soil is related to the biomass production.The\
    \ soil is modeled\nas a reservoir of water, and the changes are accounted for\
    \ in (27a). The ﬁrst term on the RHS\nrepresents the water going out by drainage\
    \ and evaporation, the second term represents\nthe plant water absorption per\
    \ unit of time, and the last term u(t) is the irrigation input.\nNext, the water\
    \ dynamics inside the plant are described by (27b), where the ﬁrst term on\nthe\
    \ RHS stands for the water absorbed by the plants, the second term represents\
    \ the water\nremoved by transpiration, and the last term relates the water used\
    \ to produce biomass.\nFinally, the change in biomass is accounted for in Equation\
    \ (27c), where the ﬁrst term on\nthe RHS represents the growth function, and the\
    \ last term represents the plant degradation.\nA complete description of the parameters\
    \ and variables is given in Table 6.\nWater 2022, 14, 889\n22 of 37\nTable 6.\
    \ Inputs, variables, and parameters of the generic model [130].\nName\nDescription\n\
    Unit\nValue\nu(t)\nIrrigation\n[mass × time−1]\nx1(t)\nWater in soil for plant\
    \ water consumption\n[mass × time−1]\nx2(t)\nWater inside the plant available\
    \ for its growth\n[mass × time−1]\nx3(t)\nBiomass (amount of dry matter)\n[mass\
    \ × time−1]\nθ1\nInner rate of decrease in the pond water\n[time]−1\n0.00001\n\
    θ2\nIntrinsic rate of water that goes to the plant\n[time × mass]−1\n2.0\nθ3\n\
    Limiting factor constant of x2(t)\n[mass]−1\n20.0\nθ4\nIntrinsic rate of increase\
    \ in the water inside the plant\n[time × mass]−1\n1.0\nθ5\nRate of decrease in\
    \ water inside the plant\n[time]−1\n0.1\nθ6\nIntrinsic rate of water decrease\
    \ by photosynthesis\n[time × mass]−1\n0.01\nθ7\nLimiting factor constant of x3(t)\n\
    [mass]−1\n0.1\nθ8\nIntrinsic growth rate per unit of water inside the plant\n\
    [time × mass]−1\n0.01\nθ9\nPlant degradation rate\n[time]−1\n0.0001\nObservability\
    \ can be locally assessed using the Jacobian of the observability map,\nconsidering\
    \ a constant input u(t) = u:\nO(x) = ∂\n∂x\n\x14y(t)\n˙y(t)\n\x15\n=\n\n\n\
    1\n0\n0\n0\n0\n1\n−θ1 −\nθ2x2\n1+θ3x2\nθ2θ3x1x2\n(1+θ3x2)2 −\nθ2x1\n1+θ3x2\n0\n\
    0\nθ8x3\n1+θ7x3\nθ8x2\n1+θ7x3 − θ9 −\nθ7θ8x2x3\n(1+θ7x3)2\n\n.\nWe can see\
    \ that rank(O(x)) = 3, provided that either the third or fourth line of the\n\
    Jacobian matrix is independent of the ﬁrst two lines. This will be the case if\
    \ x1 and x3\nare not simultaneously equal to zero over some periods of time. This\
    \ makes sense in an\nintuitive way, since this would correspond to the situation\
    \ where the sensors would return\nzero signals (thus providing no useful information\
    \ on the dynamical system).\nThe same conclusion can be reached using the canonical\
    \ form, rearranging the model\nequations in the following way:\n˙x1 =\n\n−θ1x1(t)\
    \ − θ2\nx2(t)x1(t)\n1+θ3x2(t) + u(t),\nθ8x3(t)x2(t)\n1+θ7x3(t) − θ9x3(t)\n\n\
    , ˙x2 =\n\x14\nθ4\nx2(t)x1(t)\n1 + θ3x2(t) − θ5x2(t) − θ6x3(t)x2(t)\n1 + θ7x3(t)\n\
    \x15\n,\n(28)\nwhich satisﬁes properties ((25) and (26)).\n5.2. Software Sensors\
    \ in Agriculture\nBayesian estimation strategies have been particularly popular\
    \ in the estimation of\nvariables in crop–soil systems. These techniques can be\
    \ classiﬁed as: (i) Kalman ﬁltering,\n(ii) variational inference, and (iii) sampling\
    \ algorithms [131]. Kalman ﬁltering, e.g., the\nKalman ﬁlter (KF) and the extended\
    \ Kalman ﬁlter (EKF), is based on linear or linearized\nmodels and the assumption\
    \ of Gaussian noise. The optimal estimator (or approximate\nestimator in the case\
    \ of the EKF) is provided in the form of the mean and is complemented\nby the\
    \ covariance of the estimation error, which is useful in assessing conﬁdence intervals.\n\
    In variational inference, the approximate posterior distribution of the state\
    \ (given the\nmeasurements) can be obtained through the solution of an optimization\
    \ problem. However,\nin crop models with nonlinear observation operators and non-Gaussian\
    \ observations or\nnon-Gaussian uncertainties, the assumption of normality in\
    \ the posterior might be a poor\nchoice. In these cases, approaches based on sampling,\
    \ such as the unscented Kalman ﬁlter\nor particle ﬁlters, might be preferable.\
    \ The ﬁrst will be appropriate for nonlinear models\nwith Gaussian observations,\
    \ while the second is appropriate for nonlinear systems with non-\nGaussian observations\
    \ at the price of higher computational expenses. An overview of these\nestimation\
    \ techniques and their applications to crop–soil models is given in Tables 7 and\
    \ 8.\nThe interested reader is also referred to the review papers in [8,11,132].\n\
    Water 2022, 14, 889\n23 of 37\nTable 7. Summary of the main Kalman family estimation\
    \ techniques.\nMethod\nMain Equations\nBasic Description\nEstimated\nVariables\n\
    Model\nReferences\nKF\nxk+1 = Fk+1,kxk + wk\nThe Kalman ﬁlter is an optimal estimator\
    \ for linear systems with Gaussian\nobservations. It provides the expectation\
    \ of the state and the covariance of\nthe estimation error. It proceeds in two\
    \ steps: prediction and correction. It\nexists in several forms: discrete time,\
    \ continuous time and continuous\n(prediction)–discrete (correction) time.\nNDVI\n\
    [133]\nyk = Hkxk + vk\nˆx−\nk = Fk,k−1 ˆx−\nk−1\nP−\nk = Fk,k−1Pk−1F⊤\nk,k−1 +\
    \ Qk−1\nGk = P−\nk H⊤\nk\n\x02\nHkP−\nk H⊤\nk + Rk\n\x03−1\nˆxk = ˆx−\nk + Gk\n\
    \0yk − Hk ˆx−\nk\n\x01\nPk = (I − GkHk)P−\nk\nEKF\nxk+1 = f(k, xk) + wk\nThe extended\
    \ Kalman ﬁlter is based on a model that is linearized along the\nstate estimate\
    \ trajectory. It requires the on-line computation of the Jacobian\nmatrices. It\
    \ is no longer an optimal estimator and may diverge. The EKF\nprovides a practical\
    \ and popular solution for nonlinear systems with\nGaussian observations.\nSM\n\
    [134]\nyk = h(k, xk) + vk\nSW\n[135]\nFk+1,k = ∂f(k,x)\n∂x\n|x=xk\nHk = ∂h(k,x)\n\
    ∂x\n|x=x−\nk\nˆx−\nk = f(k, ˆxk−1)\nP−\nk = Fk,k−1Pk−1F⊤\nk,k−1 + Qk−1\nGk = P−\n\
    k H⊤\nk\n\x02\nHkP−\nk H⊤\nk + Rk\n\x03−1\nˆxk = ˆx−\nk + Gkyk − h\n\0k, ˆx−\n\
    k\n\x01\nPk = (I − GkHk)P−\nk\nUKF\nXk−1 =\nh\nˆxk−1 ˆxk−1 ±\np\n(L + λ)Pk−1\n\
    i\nThe unscented Kalman ﬁlter propagates a few sampling points, called sigma\n\
    points, through the nonlinear model and computes the weighted sample’s\nmean and\
    \ covariance. The UKF does not require model linearization and\nprovides more\
    \ accurate and precise estimates in the case of nonlinear systems\nunder Gaussian\
    \ noise.\nLAI, SM\nSTICS\n[136]\nX ∗\nk|k−1 = F[Xk−1, uk−1]\nˆx−\nk = ∑2L\ni=0\
    \ W(m)\ni\nX ∗\ni,k|k−1\nP−\nk = ∑2L\ni=0 W(c)\ni\nh\nX ∗\ni,k|k−1 − ˆx−\nk\n\
    ih\nX ∗\ni,k|k−1 − ˆx−\nk\ni⊤\n+ Q\nYk|k−1 = H\n\0Xk|k−1\n\x01\nˆy−\nk = ∑2L\n\
    i=0 W(m)\ni\nYi,k|k−1\nPeykeyk = ∑2L\ni=0 W(c)\ni\n\x02Yi,k|k−1 − ˆy−\nk\n\x03\
    \x02Yi,k|k−1 − ˆy−\nk\n\x03⊤ + R\nPeykeyk = ∑2L\ni=0 W(c)\ni\n\x02Yi,k|k−1 − ˆy−\n\
    k\n\x03\x02Yi,k|k−1 − ˆy−\nk\n\x03⊤ + R\nPxkyk = ∑2L\ni=0 W(c)\ni\n\x02Xi,k|k−1\
    \ − ˆx−\nk\n\x03\x02Yi,k|k−1 − ˆy−\nk\n\x03⊤\nK = Pxkyk P−1\neykeyk\nˆxk = ˆx−\n\
    k + K\n\0yk − ˆy−\nk\n\x01\nPk = P−\nk − KPeykeykK⊤\nEnKF\nX−\nk =\n\0x1−\nk ,\
    \ ..., xN−\nk\n\x01\nThe ensemble Kalman ﬁlter is a Monte Carlo ﬁlter, which is\
    \ suitable for\nsystems with a large number of variables. It is well suited for\
    \ systems\ndescribed by partial differential equations and their discretization\
    \ by ﬁnite\ndifference or element techniques. It assumes Gaussian observations.\n\
    LAI\nCERES-Wheat\n[137]\nx−\nk =\n1\nN ∑N\ni=1 xi−\nk\nLAI, SM\nWOFOST\n[138,139]\n\
    ˆxi−\nk\n= f (ˆxk−1, uk−1) + wi\nk\nLAI, SM, VTCI\nDSSAT\n[11]\nP−\nk =\n1\nN−1\
    \ ∑N\ni=1\n\0xi−\nk − x−\nk\n\x01\0xi−\nk − x−\nk\n\x01⊤\nˆx−\nk =\n1\nN ∑N\n\
    i=1 ˆxi−\nk\nK = PxH⊤\0HPxH⊤ + R\n\x01−1\nPk = [I − KkH]P−\nk\nWater 2022, 14,\
    \ 889\n24 of 37\nTable 8. Summary of the main estimation techniques.\nMethod\n\
    Main Equations\nBasic Description\nEstimated Variables\nModel\nReferences\nPF\n\
    xi−\nk\n= f\n\0xi+\nk−1, ui\nk−1, k − 1\n\x01 + ηi\nk−1\nIn the particle ﬁlter,\
    \ a large number of particles are propagated through the nonlinear model,\nand\
    \ the posterior distribution is reconstructed. A PF is suitable for nonlinear\
    \ systems with\nnon-Gaussian observations. It is computationally expensive, but\
    \ it is amenable to parallel\ncomputation.\nAGB, LAI\nSTICS\n[11]\nwi\nk = wi\n\
    k−1\np\n\x10\nyi\nk\n\f\f\fxi−\nk\n\x11\n∑N\ni=1 wi\nk p\n\x10\nyi\nk\n\f\f\f\
    xi−\nk\n\x11\nLAI\nDSSAT\nLSP-DSSAT\n[11]\n∑N\ni=1 wi\nk = 1\nRZSM\nLSP-DSSAT\n\
    [140]\nxk = ∑N\ni=1 xi−\nk wi\nkδ\n\0xk − xi−\nk\n\x01\nVF\nˆp(zk|y1:k) ∝ p(yk|zk)p(zk)\n\
    The variational ﬁlter aims at approximating the posterior distribution with a\
    \ parametric\ndensity of an assumed form. The primary mechanism of the VF is to\
    \ minimize the\nKullback–Leiber divergence between the assumed posterior distribution\
    \ and the\nhypothetically true posterior. This approximation approach lends itself\
    \ to an optimization\nproblem.\nLAI, HUR1, HUR2\nmini-STICS\n[136]\nq(zk) ∝ p(yk|zk)N\
    \ (⟨µk⟩, ⟨λk⟩)\nℓi\nk ∝ ∏N\nj=1 p\n\x10\nzj\nk\n\f\f\fzi\nk\n\x11\nˆzk = ∑N\n\
    i=1 ℓi\nkzi\nk\np(zk|y1:k−1) ∝ R\np(zk|zk−1)q(zk−1))dzk−1\nqk|k−1(zk) ∝ N\n\x12\
    \n⟨µk⟩qk|k−1, ⟨λk⟩qk|k−1\n\x13\n3DVAR\nJ(X) = (X − Xb)⊤B−1(X − Xb)\nVariational\
    \ assimilation is the iterative minimization of a cost function J(x). This solution\n\
    represents the a posteriori maximum likelihood estimate of the true state given\
    \ the\nbackground (previous forecast) and observations. The use of adjoint operations\
    \ (based on the\nchain rule for partial differentiation) allows the calculation\
    \ of the gradient of the cost function.\nLAI\nCERES-Maize\n[141]\n+(Y − HX)⊤R−1(Y\
    \ − HX)\n∇J(X) = 2B−1(X − Xb)\n−2H⊤R−1(Y − HX)\n4DVAR\nJ(X) = 1\n2 (X − Xb)⊤B−1(X\
    \ − Xb)\n4DVAR adds an extra time point in the cost function. 4DVAR is actually\
    \ a direct\ngeneralization of 3DVAR for handling observations that are distributed\
    \ in time.\nLAI\nWOFOST\n[11]\n+ 1\n2 (H(X) − Y)⊤R−1(H(X) − Y)\nLAI, NDVI\nDSSAT\n\
    [11]\n+ 1\n2 F(X)⊤C−1\nf F(X)\nXi = M(xi−1) + ηi\nδZ = AH⊤\0R = HAH⊤\x01−1\0H\n\
    \0xg\n\x01 − Y\n\x01\nHBM\np\n\0θD, θp, Y\n\f\fX\n\x01 ≈\nHierarchical Bayesian\
    \ modeling is based on the theoretical foundation of conditional\nprobability\
    \ distribution. The problem is decomposed into layers. Each layer is connected\
    \ by\nthe conditional probability, and the solution of a complex joint probability\
    \ problem is\nconverted into the solution of a series of simpler problems.\nNDVI\n\
    [142]\np(X1|Y1, θD) · · · p(Xn|Yn, θD)\np\n\0Y1\n\f\fθp, Y2, ..., Yn\n\x01 · ·\
    \ · p\n\0Yn\n\f\fθp\n\x01\np(θD)p\n\0θp\n\x01\nWater 2022, 14, 889\n25 of 37\n\
    The linear and extended Kalman ﬁltering techniques often result in difﬁculties\
    \ due to\nthe nonlinearity of the models, and particularly the threshold functions\
    \ that are often part\nof their expression. Moreover, the formulation of the uncertainty\
    \ in the model itself due to\nparameter, structural, and input uncertainty is\
    \ often difﬁcult [143].\nIn [137], the authors used an ensemble Kalman ﬁlter (EnKF)\
    \ in combination with\nthe CERES-Wheat crop-growth model with remote sensing data\
    \ in order to improve the\nestimation of LAI parameters. However, the authors\
    \ did not discuss the setup of the ﬁlter or\nthe convergence rate. In [140], the\
    \ authors implemented an EnKF to estimate the root-zone\nsoil moisture (RZSM)\
    \ in a coupled SVAT–vegetation model. They compared the results\nwith those of\
    \ four variants of particle ﬁlter implementations. The results showed a small\n\
    difference in the estimation capabilities of the ﬁlters, and the discussion was\
    \ centered on\nthe selection of the tuning parameters.\nSampling-based algorithms\
    \ and, particularly, the particle ﬁlter (PF) or sequential\nMonte Carlo ﬁlter\
    \ allow the estimation of information from sources that have non-Gaussian\nerrors.\
    \ In [144], a variant of the PF, which was called a convolution particle ﬁlter,\
    \ was tested\non two models, namely, STICS and LNAS, with several datasets.\n\
    The estimation of parameters and state variables can be carried out simultaneously.\n\
    For instance, in [136], three parameters and three state variables (LAI and soil\
    \ water\ncontent of two soil layers) of the mini-STICS model were estimated. Three\
    \ techniques\nwere used, namely, the EKF, PF, and VF. The improved performance\
    \ of the VF method\nwhen compared to that of the EKF and PF was demonstrated.\
    \ The variational ﬁlter had\na low computational complexity, and the convergence\
    \ speed of the state and parameter\nestimation could be adjusted independently.\
    \ However, the tests of the observers were\nprobably not fully conclusive, as\
    \ the initial estimates did not display errors (and without\ninitial errors, convergence\
    \ is not challenged).\n5.3. Illustrative Example: State Estimation with a Generic\
    \ Crop Model\nAs an illustration of a state estimation problem, an EKF is designed\
    \ for model (27)\nwith the parameter values given in Table 6. For the sake of\
    \ simplicity, the irrigation input\nu = 0.\nSome underlying assumptions are considered:\n\
    •\nThe water absorption rate of the plant is less than or equal to the rate of\
    \ loss of water\nfrom the pond, i.e., θ4 ≤ θ2;\n•\nThe dry matter accumulation\
    \ rate of the plant is approximately equal to the rate of\ndecrease in the water\
    \ inside the plant that goes toward photosynthesis, i.e., θ8 ≈ θ6;\n•\nThe rate\
    \ of water loss through transpiration is larger than the rate of water loss through\n\
    evaporation, i.e., θ5 > θ1;\n•\nThe degradation rate of the plant is larger than\
    \ the rate of water loss through evapora-\ntion, i.e., θ9 > θ1;\n•\nThe crop is\
    \ wheat on a short life cycle of 140 days under no stress conditions. Therefore,\n\
    water and nutrients are readily available and do not limit growth;\n•\nThere is\
    \ neither damage from pests and diseases nor any competition from weeds\ngrowing\
    \ in the ﬁeld;\n•\nx1 and x3 can be measured by existing technology, i.e., by\
    \ RS based on images, and\nthe measurements are collected daily.\nThe software\
    \ sensor is in charge of reconstructing x2 based on the model and the\nmeasurements\
    \ of the other state variables. The EKF design is based on the selection of\n\
    covariance matrices Q = 0.0001I and R =\n\x140.001\n0\n0\n0.01\n\x15\n, which\
    \ are based on an evaluation\nof the model and measurement noises. In Figure 8,\
    \ the performance of the observer is\nshown. Notice that the observer uses the\
    \ ﬁrst measurement values as initial conditions for\nthe measured variables. On\
    \ the other hand, the initial value of ˆx2 is intentionally taken far\naway from\
    \ the real trajectory to show the convergence speed of the observer (a test that\
    \ is\nseldom illustrated in the literature on state estimation in agricultural\
    \ applications).\nWater 2022, 14, 889\n26 of 37\n0\n50\n100\nx1 (mass day-1)\n\
    Field Capacity\nWilting point\nMeasurements\nReal\nEKF\n0\n10\n20\n30\n40\nx2\
    \ (mass day-1)\nReal\nEKF\n0\n20\n40\n60\n80\n100\n120\n140\nTime(days)\n0\n10\n\
    20\n30\nx3 (mass day-1)\nMeasurements\nReal\nEKF\nFigure 8. Evolution of the real\
    \ and estimated state variables. The initial conditions of the estimator\nare\
    \ the measured values of state variables x1 and x3, while ˆx2(0) = 40.\n6. Irrigation\
    \ Control\nIn this section, we review some control techniques that can be used\
    \ to improve and\npossibly optimize the irrigation of the ﬁeld. The manipulated\
    \ variable u(z, t) is the amount\nof water supplied in space and time, whereas\
    \ the output variable is the biomass production.\nHowever, in most cases, developers\
    \ do not consider biomass as an output variable. Instead,\nthey consider a variable\
    \ related to the soil water content, since models are mostly developed\nbased\
    \ on the soil behavior.\nA preliminary step to the design of an automatic irrigation\
    \ system is to verify if the\nstate variables can be controlled using the manipulated\
    \ variables. This issue is accounted\nfor by a property called controllability,\
    \ which represents the possibility of driving the\nstates of the system from any\
    \ initial value to a desired ﬁnal value in a ﬁnite time. This\nproperty is useful\
    \ for the control system designer; however, it was not considered in the\napplications\
    \ reviewed.\n6.1. Control Paradigms\nModels for irrigation control can be classiﬁed\
    \ into data-driven and mechanistic mod-\nels [16]. Data-driven approaches are\
    \ based on the collection of data from various sensors\nand the use of machine\
    \ learning techniques. On the other hand, the mechanistic approach\nis based on\
    \ the phenomenological models reviewed in the previous sections, which are\npossibly\
    \ simpliﬁed to account for only the main phenomena (those that will have a signiﬁ-\n\
    cant effect in a closed-loop operation). Many control techniques can be applied,\
    \ ranging\nfrom classical proportional integral derivative (PID) control to advanced\
    \ model predictive\ncontrol (MPC) [17].\nA classical feedback control structure\
    \ is presented in Figure 9. The error e(tk), i.e.,\nthe difference between the\
    \ reference r(tk) and the measurement signal y(tk), feeds the\ncontroller, which\
    \ computes the control action u(tk) sent to an actuator, e.g., a valve of a\n\
    sprinkler. A PID controller [145] generates the following control law:\nu(tk)\
    \ = Kp\n \ne(tk) + ∆t\nTi\nk\n∑\ni=0\ne(ti) + Td\n∆t(e(tk) − e(tk−1))\n!\n,\n\
    (29)\nWater 2022, 14, 889\n27 of 37\nwhere ∆t is the sampling time, Kp is the\
    \ proportional gain, Ti is the integration time constant,\nand Td is the derivative\
    \ time constant. This control law was implemented and tuned for\nirrigation using\
    \ the heuristic methodology in [146], and was further elaborated in [147],\nwhere\
    \ a dielectric tensiometer was used to regulate soil moisture in a strawberry\
    \ crop.\nController\nCrop-soil\nsystem\nw(tk)\nu(tk)\nSensor\nr(tk)\ne(tk)\nx(tk)\n\
    y(tk)\n+\n−\nFigure 9. Classical feedback control system. The signals u(tk) and\
    \ w(tk) represent the vectors of\nmanipulated and environmental inputs and y(tk)\
    \ represents the measured system output.\nModel-based control systems make use\
    \ of a hydrologic model, e.g., related to Equation (4),\nand some sensors of water\
    \ in soil. These elements are coupled to an irrigation scheduler\nto determine\
    \ the irrigation regime. The main problem is that the output variables (soil\n\
    moisture, humidity, or evapotranspiration) are related to crop growth, but not\
    \ to crop\nperformance, which makes irrigation solutions based on the maximization\
    \ of production\nsuboptimal [148,149]. As an alternative, in [9], the authors\
    \ described how hydrologic mod-\nels can be combined with crop-growth models,\
    \ such as APSIM (i.e., an SOM), to properly\naccount for multiple effects of water\
    \ on biomass production.\nModel predictive control (MPC) is a real-time optimal\
    \ control strategy based on the\nnumerical optimization of a cost function J (or\
    \ performance index) over a ﬁnite prediction\nhorizon [149]:\nJ =\nHp\n∑\ni=1\n\
    λxi(ri − xi)2 +\nHp−1\n∑\ni=0\nλui∆u2\ni ,\n(30)\nwhere xi is the ith controlled\
    \ variable, ri is the ith reference variable, ∆ui is the ith manipu-\nlated variable\
    \ move, and λxi and λui are weighting coefﬁcients, which allow the designer\n\
    to assign a relative importance to the reference tracking and control energy.\
    \ Hp is the\nprediction horizon. The main components of MPC are shown in Figure\
    \ 10.\nIn [150], the MPC is formulated based on a linear stochastic state-space\
    \ model of\nthe soil moisture that incorporates variables such as soil evapotranspiration\
    \ and deep\npercolation. A similar work is presented in [148], where the model\
    \ uses the soil moisture\ncontrol and the climatic factors to determine the optimal\
    \ amount of water required by\nthe crop while keeping soil moisture under speciﬁc\
    \ thresholds (avoiding water stress).\nMPC was also designed based on an SOM,\
    \ i.e., AquaCrop as a crop emulator, in [151].\nIn this work, the authors described\
    \ the design process and discussed the issues related\nto the implementation.\
    \ MPC can be improved, as proposed in [152], where the authors\npresented a data-driven\
    \ robust model predictive control (DDRMPC) approach for automatic\ncontrol of\
    \ irrigation. This control framework integrates a set of mechanistic models, which\n\
    describe dynamics in soil moisture variations, and data-driven models, which characterize\n\
    uncertainty in forecast errors of evapotranspiration and precipitation.\nWater\
    \ 2022, 14, 889\n28 of 37\n-\nr(tk)\nPredictive Controller\nOptimizer\nState\n\
    estimator\nCOM\n-\ny(tk)\nu(tk) -\nCrop–soil\nsystem\n?\nw(tk)\n-\nx(tk)\n\e\n\
    Sensor\nFigure 10. MPC generic diagram.\nData-driven systems are usually simple\
    \ and easy to implement. Their main advantage\nis that they do not require the\
    \ development of mechanistic models of the crop dynamics\n[148], and they can\
    \ be improved over time by optimal learning strategies [153]. In [154], the\n\
    authors presented an example of a soil moisture control based on continuous measurements\n\
    of soil water content. This system uses a soil water balance equation to calibrate\
    \ the model,\nand then generates an irrigation schedule by combining previous\
    \ knowledge that is updated\nby current measurements in an expert system framework.\
    \ However, the main drawback of\nthese approaches is that they are based on custom\
    \ solutions for speciﬁc areas and crops,\nwhich must be constantly calibrated/adapted,\
    \ and their extrapolation to new situations is\nnot straightforward.\nFuzzy logic\
    \ has been applied in various agricultural applications, such as irrigation\n\
    and fertilization. Thanks to its ﬂexibility, this approach allows a qualitative\
    \ and quantitative\ninterpretation of crop development, which can be deﬁned using\
    \ expert knowledge and\nﬁeld observations. A design of a fuzzy logic control (FLC)\
    \ for irrigation was presented\nin [155]. The stability of the closed-loop system\
    \ was analyzed using Lyapunov functions.\nAnother application of fuzzy control\
    \ was presented in [156], where a closed-loop control\nwas integrated with remote\
    \ sensing. In this work, the objective was to control the speed of\nthe irrigation\
    \ device (i.e., the central pivot) by sensing the soil moisture, soil temperature,\n\
    and NDVI.\nPID, MPC, and fuzzy logic controllers were compared in [157], where\
    \ a soil water\nbalance that included soil moisture, temperature, and evapotranspiration\
    \ was consid-\nered. However, the authors only provided general comments on the\
    \ applicability of such\nstrategies, without design guidelines to support the\
    \ comparison.\n6.2. Illustrative Example: PID and Model Predictive Control\nTo\
    \ illustrate an irrigation control application, let us consider the crop–soil\
    \ model\npresented in [158]. The discrete-time equations can be summarized as\
    \ follows:\nx1(k + 1) = x1(k) − (w1(k) − 0.2S)2\nw1(k) + 0.8S\n− θ1(x1(k) + w1(k)\
    \ − (w1(k) − 0.2S)2\nw1(k) + 0.8S\n− K1)\n− min(θ2(x1(k) − K2), w2(k)) + w1(k)\
    \ + u(k),\n(31a)\nx2(k + 1) = x2(k) + w3(k),\n(31b)\nx3(k + 1) = x3(k) + K3(1\
    \ − h(w3(k)))K4(1 − h(x1(k))),\n(31c)\nx4(k + 1) = x4(k) + K5K6w4(k)h(x1(k))\n\
    θ3\n1 + e−0.01(x2(k)−θ4) ,\n(31d)\nwhere the state variables are the water content\
    \ available in soil x1, the cumulative temper-\nature x2, the cumulative temperature\
    \ until maturity to reach 50% radiation interception\ndue to leaf senescence x3,\
    \ and the biomass x4. The independent inputs are the precipitation\nWater 2022,\
    \ 14, 889\n29 of 37\nw1, the reference evapotranspiration w2, the air temperature\
    \ w3, solar radiation w4, and the\nmanagement input, i.e., the amount of water\
    \ irrigated u.\nThe parameters K1, K2, K3, K4, K5 and K6 represent the maximum\
    \ water content at\nﬁeld capacity, the root water uptake, the maximum daily reduction\
    \ due to heat stress,\nthe maximum daily reduction due to drought stress, the\
    \ radiation-use efﬁciency, and the\nimpact of the CO2 growth rate on biomass,\
    \ respectively. θ1 is the drainage coefﬁcient, θ2 is\nthe water-holding capacity,\
    \ θ3 is the maximum fraction of radiation interception, and θ4\nis the cumulative\
    \ temperature requirement for leaf area development. h(·) represents an\nalgebraic\
    \ function computed by following the procedure described in [113].\nFor a wheat\
    \ crop in loamy soil, a comparison of four situations aimed at assessing\nthe\
    \ biomass production is presented. First, the model is used under no irrigation\
    \ policy\nto establish a minimum performance that is only bounded by environmental\
    \ conditions.\nSecond, the system is tested while following a ﬁxed irrigation\
    \ policy, which is a common\npractice in agriculture. Third, the model is used\
    \ in a control loop, as shown in Figure 9,\nusing a PID controller, and ﬁnally,\
    \ the model is used in an MPC strategy. The design of the\nPID controller is achieved\
    \ with the auto-tune algorithm in Matlab, whereas the MPC cost\nfunction targets\
    \ a maximization of the ﬁnal biomass in combination with the minimization\nof\
    \ the amount of water required to achieve it, i.e.,\nmin\nu(tk)\n− 1\nHp\nHp\n\
    ∑\nk=1\nx4(tk)\nx4,max(th) + λ\nth\n∑\nk=1\nu(tk)\nWmaxT\n(32a)\ns.t.\n0 ≤ u(tk)\
    \ ≤ Wmax\n(32b)\nwhere Hp is the prediction horizon in days, th is the harvest\
    \ time, λ is a weighting factor\nbetween the biomass proﬁtability and water expense,\
    \ and WmaxT = thWmax is the maximum\namount of water available for the entire\
    \ crop season. Notice that the proposed cost function\nconsiders the maximization\
    \ of biomass over a limited period Hp, whereas the minimization\nof the water\
    \ usage is considered over the full crop season. The reason for the short span\
    \ of\nmaximization is that biomass production is highly affected by rainfall,\
    \ while the availability\nof water for irrigation during the crop season is deﬁned\
    \ in advance. In addition, the\nweighting factor λ gives the designer the possibility\
    \ to limit the water usage based on the\nprice or availability of the resource.\n\
    The results of the comparison are shown in Figure 11 for the water in soil x1\
    \ and\nbiomass x4. Without irrigation, the amount of water in the soil reaches\
    \ a minimum, and\nbiomass production reaches the lowest level for the season.\
    \ For the case of ﬁxed irrigation,\na total of 340 mm of water is applied in the\
    \ full season. This irrigation policy increases the\nproduction by 70% with respect\
    \ to the no-irrigation case. However, when control actions\nare enforced, biomass\
    \ production and water consumption increase compared to the ﬁxed\nirrigation scenario.\
    \ When PID control is active, the reference is to keep the water in the\nsoil\
    \ at ﬁeld capacity, implying 405 mm of water, which is about 17% more water than\n\
    the ﬁxed irrigation. Nevertheless, this represents an increase in biomass production\
    \ of\n95% concerning the case of no irrigation. When the MPC is applied, the increase\
    \ in the\nproduction is about 93% with respect to the no-irrigation case by using\
    \ about 13 − % more\nwater than in the case of the ﬁxed irrigation policy. Hence,\
    \ PID increases production by 2%\nmore than MPC, but requires 6 − % more water.\
    \ MPC can be adjusted to relax the constraint\nrelated to the water used to reach\
    \ the same performance as that of the PID control regarding\nbiomass production.\
    \ The main advantage of MPC is the predictive capability, which can be\ncombined\
    \ with weather forecasts to reduce water usage to achieve production objectives.\n\
    Water 2022, 14, 889\n30 of 37\n0\n50\n100\n150\n200\nTime (days)\n20\n40\n60\n\
    80\n100\n120\n140\nx1(mm)\nNo irrigation\nFixed irrigation\nPID\nMPC\n0\n50\n\
    100\n150\n200\nTime (days)\n0\n1000\n2000\n3000\n4000\n5000\n6000\n7000\n8000\n\
    9000\nx4(ton h-1)\nNo irrigation\nFixed irrigation\nPID\nMPC\n(a)\n(b)\nFigure\
    \ 11. Comparative responses for (a) water in soil and (b) biomass with th = 197\
    \ days. The\nvalues of the PID parameters are Kp = 1.7 × 10−6, Ti = 0.0096, and\
    \ Td = 0.0024. For the MPC,\nλ = 0.01, Wmax = 2 mm/day, and Hp = 8 days.\n7. Spatial\
    \ Heterogeneity\nThe structure of cultivated ﬁelds across the world shows non-uniform\
    \ characteristics.\nThis can be attributed to the topography and soil properties\
    \ that change spatially and over\ntime. For a continuous modeling of speciﬁc soil\
    \ properties (related to state variables), the\nformalism of partial differential\
    \ equations (PDEs) provides an appropriate mathematical\nrepresentation. In general,\
    \ the variation of soil properties is considered only with respect to\ndepth,\
    \ and solvers of the corresponding PDEs have been developed (e.g., for seepage\
    \ [159]).\nAs an illustration of the above, let us consider the vertical water\
    \ movement presented\nin [160], where the soil moisture is computed using the\
    \ Richards equation, which is a\nnonlinear parabolic PDE that describes the movement\
    \ of water in an unsaturated zone. The\none-dimensional form of the Richards equation\
    \ is given by:\n∂θ\n∂t = ∂\n∂t\n\x14\nk ∂h\n∂z\n\x15\n+ ∂k\n∂z,\n(33)\nwhere θ\
    \ is the volumetric soil moisture, t is time, z is the vertical coordinate (positive\n\
    in the upward direction), k is the hydraulic conductivity, and h is the pressure\
    \ head. A\ndiscrete-time formulation is used with regard to the standard availability\
    \ of samples (i.e.,\ndaily) and the implementation of the models in dynamic simulation\
    \ algorithms. Moreover,\nspatial discretization of the soil into layers or compartments\
    \ is applied to the vertical water\nmovement, yielding fully discrete (in time\
    \ and space) simulators. In Section 2, we presented\nan example of such a model\
    \ using soil layers, i.e., AquaCrop. A general assumption is a\nﬂat land topography\
    \ with no signiﬁcant side movements of water.\nAn alternative to the PDE formalism\
    \ and the associated spatial discretization is the\nagent-based approach proposed\
    \ in [161]. In this work, the layers were treated as agents that\ninteracted with\
    \ their upper and lower neighbors, exchanging water downward through\ninﬁltration\
    \ or gravity and upward through evaporation or capillarity. The monitoring\nof\
    \ vertical water modeling is linked to the availability of sensors, especially\
    \ for direct\nmeasurements. This has limited the applicability of the models.\n\
    Partial differential equations have apparently not yet been used by the crop modeling\n\
    community to represent movements of water to the side, which is probably due to\
    \ the\nmultidimensional nature of the problem, the more advanced discretization\
    \ into ﬁnite\nelements or volumes, and the distributed instrumentation required\
    \ in order to develop\nmonitoring or control.\nInstead, other approaches are emerging,\
    \ such as the stochastic distribution approach [162]\nand agent-based modeling\
    \ [123]. In [162], the authors discussed modeling and monitoring\ncomplex systems\
    \ that vary in both space and time given a limited number of agents or\nsensors\
    \ providing measurements that are spread out across a large area. They described\
    \ the\nland using Gaussian process modeling and addressed data incorporation with\
    \ a machine\nWater 2022, 14, 889\n31 of 37\nlearning technique named Kernel Observers.\
    \ In [123], the idea was to represent the changes\nacross the surface thanks to\
    \ a discretization of the land into small patches that were linked\nby the side\
    \ exchange of water due to the saturation of its retention capacity and the runoff.\n\
    This latter representation is well suited for crops located in mountain slopes\
    \ or rugged\nterrains.\n8. Conclusions and Perspectives\nA vast body of knowledge\
    \ about dynamic modeling of crop–soil systems exists, which\nhas resulted in various\
    \ mathematical models and numerical simulators that allow the\nunderstanding and\
    \ prediction of biomass production as a function of environmental fac-\ntors and\
    \ human actions, such as fertilization and irrigation. This modeling approach\
    \ can\nbe complemented by various concepts of system and control theory to develop\
    \ efﬁcient\nmonitoring, control, and optimization tools. In this review article,\
    \ we attempted to draw\nan overview of these concepts, including model parameter\
    \ identiﬁcation, validation, un-\ncertainty analysis, observability analysis,\
    \ nonlinear state estimation, model-based control,\nexpert systems, and real-time\
    \ optimization.\nMoreover, predictive models can nowadays exploit various sources\
    \ of information\nprovided by ground sensors, aerial measurements, and satellite\
    \ imaging, resulting in a big-\ndata perspective and the incorporation of machine\
    \ learning techniques into the so-called\nsmart farming trend. An important aspect\
    \ to consider is stochasticity in environmental\ninputs, which is not a widespread\
    \ practice in current studies.\nThere are many appealing directions for future\
    \ research, including the design of\nstate estimation techniques that exploit\
    \ sensor networks and take account of uncertainty\nin the model description and\
    \ environmental inputs, the development of agent-based\nmodels describing soil\
    \ heterogeneity and incorporating distributed instrumentation and\nactuation in\
    \ a possibly asynchronous way, and the design of distributed model predictive\n\
    control to take full advantage of agent cooperation, real-time optimization, and\
    \ embedded\nsystem technology.\nAuthor Contributions: Conceptualization, N.Q.\
    \ and A.V.W.; Methodology, N.Q. and A.V.W.; Investi-\ngation, J.L.-J., N.Q., and\
    \ A.V.W.; Formal analysis, J.L.-J.; Software, J.L.-J.; Validation, J.L.-J., Funding\n\
    acquisition, N.Q. and A.V.W.; Project administration, N.Q. and A.V.W.; Supervision,\
    \ N.Q. and A.V.W.;\nWriting—original draft, J.L.-J.; Writing—review and editing,\
    \ N.Q. and A.V.W. All authors have read\nand agreed to the published version of\
    \ the manuscript.\nFunding: This research received no external funding.\nData\
    \ Availability Statement: The data presented in this study are available on request\
    \ from the\ncorresponding author.\nAcknowledgments: The ﬁrst author acknowledge\
    \ the support by COLCIENCIAS grant 727.\nConﬂicts of Interest: The authors declare\
    \ no conﬂict of interest.\nReferences\n1.\nCampanhola, C.; Pandey, S. Sustainable\
    \ Food and Agriculture: An Integrated Approach; Academic Press: Cambridge, MA,\
    \ USA, 2018.\n2.\nVelasco-Muñoz, J.F.; Aznar-Sánchez, J.A.; Belmonte-Ureña, L.J.;\
    \ Román-Sánchez, I.M. Sustainable water use in agriculture:\nA review of worldwide\
    \ research. Sustainability 2018, 10, 1084. [CrossRef]\n3.\nLamnabhi-Lagarrigue,\
    \ F.; Annaswamy, A.; Engell, S.; Isaksson, A.; Khargonekar, P.; Murray, R.M.;\
    \ Nijmeijer, H.; Samad, T.;\nTilbury, D.; Van den Hof, P. Systems & Control for\
    \ the future of humanity, research agenda: Current and future roles, impact and\n\
    grand challenges. Annu. Rev. Control 2017, 43, 1–64.\n4.\nNouri, H.; Stokvis,\
    \ B.; Galindo, A.; Blatchford, M.; Hoekstra, A.Y. Water scarcity alleviation through\
    \ water footprint reduction in\nagriculture: The effect of soil mulching and drip\
    \ irrigation. Sci. Total Environ. 2019, 653, 241–252. [CrossRef] [PubMed]\n5.\n\
    Ashofteh, P.S.; Bozorg-Haddad, O.; Loáiciga, H.A. Development of adaptive strategies\
    \ for irrigation water demand management\nunder climate change. J. Irrig. Drain.\
    \ Eng. 2017, 143, 04016077. [CrossRef]\n6.\nJones, J.W.; Antle, J.M.; Basso, B.;\
    \ Boote, K.J.; Conant, R.T.; Foster, I.; Godfray, H.C.J.; Herrero, M.; Howitt,\
    \ R.E.; Janssen, S.; et al.\nToward a new generation of agricultural system data,\
    \ models, and knowledge products: State of agricultural systems science.\nAgric.\
    \ Syst. 2017, 155, 269–288. [CrossRef]\nWater 2022, 14, 889\n32 of 37\n7.\nJones,\
    \ J.W.; Antle, J.M.; Basso, B.; Boote, K.J.; Conant, R.T.; Foster, I.; Godfray,\
    \ H.C.J.; Herrero, M.; Howitt, R.E.; Janssen, S.; et al.\nBrief history of agricultural\
    \ systems modeling. Agric. Syst. 2017, 155, 240–254. [CrossRef] [PubMed]\n8.\n\
    Jin, X.; Kumar, L.; Li, Z.; Feng, H.; Xu, X.; Yang, G.; Wang, J. A review of data\
    \ assimilation of remote sensing and crop models.\nEur. J. Agron. 2018, 92, 141–152.\
    \ [CrossRef]\n9.\nSiad, S.M.; Iacobellis, V.; Zdruli, P.; Gioia, A.; Stavi, I.;\
    \ Hoogenboom, G. A review of coupled hydrologic and crop growth models.\nAgric.\
    \ Water Manag. 2019, 224, 105746. [CrossRef]\n10.\nZhou, H.; Zhao, W. Modeling\
    \ soil water balance and irrigation strategies in a ﬂood-irrigated wheat-maize\
    \ rotation system. A case\nin dry climate, China. Agric. Water Manag. 2019, 221,\
    \ 286–302. [CrossRef]\n11.\nHuang, J.; Gómez-Dans, J.L.; Huang, H.; Ma, H.; Wu,\
    \ Q.; Lewis, P.E.; Liang, S.; Chen, Z.; Xue, J.H.; Wu, Y.; et al. Assimilation\
    \ of\nremote sensing into crop growth models: Current status and perspectives\
    \ . Agric. For. Meteorol. 2019, 276–277, 107609. [CrossRef]\n12.\nKarthikeyan,\
    \ L.; Chawla, I.; Mishra, A.K. A review of remote sensing applications in agriculture\
    \ for food security: Crop growth\nand yield, irrigation, and crop losses. J. Hydrol.\
    \ 2020, 586, 124905. [CrossRef]\n13.\nLiakos, K.G.; Busato, P.; Moshou, D.; Pearson,\
    \ S.; Bochtis, D. Machine learning in agriculture: A review. Sensors 2018, 18,\
    \ 2674.\n[CrossRef] [PubMed]\n14.\nLytos, A.; Lagkas, T.; Sarigiannidis, P.; Zervakis,\
    \ M.; Livanos, G. Towards smart farming: Systems, frameworks and exploitation\n\
    of multiple sources. Comput. Netw. 2020, 172, 107147. [CrossRef]\n15.\nCobbenhagen,\
    \ A.; Antunes, D.; van de Molengraft, M.; Heemels, W. Opportunities for control\
    \ engineering in arable precision\nagriculture. Annu. Rev. Control. 2021, 51,\
    \ 47–55. [CrossRef]\n16.\nRomero, R.; Muriel, J.; García, I.; de la Peña, D.M.\
    \ Research on automatic irrigation control: State of the art and recent results.\n\
    Agric. Water Manag. 2012, 114, 59–66. [CrossRef]\n17.\nMcCarthy, A.C.; Hancock,\
    \ N.H.; Raine, S.R. Advanced process control of irrigation: The current state\
    \ and an analysis to aid\nfuture development. Irrig. Sci. 2013, 31, 183–192. [CrossRef]\n\
    18.\nConde, G.; Quijano, N.; Ocampo-Martinez, C. Modeling and control in open-channel\
    \ irrigation systems: A review. Annu. Rev.\nControl. 2021, 51, 163–171. [CrossRef]\n\
    19.\nDi Paola, A.; Valentini, R.; Santini, M. An overview of available crop growth\
    \ and yield models for studies and assessments in\nagriculture. J. Sci. Food Agric.\
    \ 2016, 96, 709–714. [CrossRef]\n20.\nRossiter, D. Biophysical models in land\
    \ evaluation. In Encyclopedia of Land Use, Land cCover and Soil Sciences: Land\
    \ Evaluation;\nEOLSS Publishers/UNESCO, Oxford, UK, 2009; Volume 2, pp. 181–195.\n\
    21.\nKeating, B.A.; Thorburn, P.J. Modelling crops and cropping systems—Evolving\
    \ purpose, practice and prospects. Eur. J. Agron.\n2018, 100, 163–176. [CrossRef]\n\
    22.\nWalters, J.P.; Archer, D.W.; Sassenrath, G.F.; Hendrickson, J.R.; Hanson,\
    \ J.D.; Halloran, J.M.; Vadas, P.; Alarcon, V.J. Exploring\nagricultural production\
    \ systems and their fundamental components with system dynamics modelling.\nEcol.\
    \ Model. 2016,\n333, 51–65. [CrossRef]\n23.\nBruinsma, J. World Agriculture: Towards\
    \ 2015/2030: An FAO Perspective; Routledge: London, UK, 2017.\n24.\nYu, L.; Gao,\
    \ X.; Zhao, X. Global synthesis of the impact of droughts on crops’ water-use\
    \ efﬁciency (WUE): Towards both high\nWUE and productivity. Agric. Syst. 2020,\
    \ 177, 102723. [CrossRef]\n25.\nWilliams, J.R.; Izaurralde, R.; Singh, V.; Frevert,\
    \ D. The APEX model. In Watershed Models; CRC Press: Boca Raton, FL, USA, 2006;\n\
    pp. 437–482.\n26.\nKeating, B.A.; Carberry, P.S.; Hammer, G.L.; Probert, M.E.;\
    \ Robertson, M.J.; Holzworth, D.; Huth, N.I.; Hargreaves, J.N.; Meinke,\nH.; Hochman,\
    \ Z.; et al. An overview of APSIM, a model designed for farming systems simulation.\
    \ Eur. J. Agron. 2003, 18, 267–288.\n[CrossRef]\n27.\nSteduto, P.; Hsiao, T.C.;\
    \ Raes, D.; Fereres, E. AquaCrop—The FAO Crop Model to Simulate Yield Response\
    \ to Water: I. Concepts\nand Underlying Principles. Agron. J. 2009, 101, 426–437.\
    \ [CrossRef]\n28.\nStöckle, C.O.; Donatelli, M.; Nelson, R. CropSyst, a cropping\
    \ systems simulation model.\nEur. J. Agron. 2003, 18, 289–307.\n[CrossRef]\n29.\n\
    Abrahamsen, P.; Hansen, S. Daisy: An open soil-crop-atmosphere system model. Environ.\
    \ Model. Softw. 2000, 15, 313–330.\n[CrossRef]\n30.\nLi, C.; Frolking, S.; Crocker,\
    \ G.J.; Grace, P.R.; Klír, J.; Körchens, M.; Poulton, P.R. Simulating trends in\
    \ soil organic carbon in\nlong-term experiments using the DNDC model. Geoderma\
    \ 1997, 81, 45–60. [CrossRef]\n31.\nGilhespy, S.L.; Anthony, S.; Cardenas, L.;\
    \ Chadwick, D.; del Prado, A.; Li, C.; Misselbrook, T.; Rees, R.M.; Salas, W.;\
    \ Sanz-Cobena,\nA.; et al. First 20 years of DNDC (DeNitriﬁcation DeComposition):\
    \ Model evolution. Ecol. Model. 2014, 292, 51–62. [CrossRef]\n32.\nJones, J.W.;\
    \ Hoogenboom, G.; Porter, C.H.; Boote, K.J.; Batchelor, W.D.; Hunt, L.; Wilkens,\
    \ P.W.; Singh, U.; Gijsman, A.J.; Ritchie,\nJ.T. The DSSAT cropping system model.\
    \ Eur. J. Agron. 2003, 18, 235–265. [CrossRef]\n33.\nWilliams, J.; Jones, C.;\
    \ Kiniry, J.; Spanel, D.A. The EPIC crop growth model. Trans. ASAE 1989, 32, 497–0511.\
    \ [CrossRef]\n34.\nBasso, B.; Ritchie, J.T. Simulating Crop Growth and Biogeochemical\
    \ Fluxes in Response to Land Management Using the SALUS Model;\nOxford University\
    \ Press: Oxford, UK, 2015; Volume 2015.\n35.\nBrisson, N.; Mary, B.; Ripoche,\
    \ D.; Jeuffroy, M.H.; Ruget, F.; Nicoullaud, B.; Gate, P.; Devienne-Barret, F.;\
    \ Antonioletti, R.; Durr, C.;\net al. STICS: A generic model for the simulation\
    \ of crops and their water and nitrogen balances. I. Theory and parameterization\n\
    applied to wheat and corn. Agronomie 1998, 18, 311–346. [CrossRef]\nWater 2022,\
    \ 14, 889\n33 of 37\n36.\nde Wit, C.T. Transpiration and Crop Yields; Technical\
    \ Report; Wageningen University, Wageningen, The Netherlands, 1958.\n37.\nKroes,\
    \ J.; Van Dam, J.; Bartholomeus, R.; Groenendijk, P.; Heinen, M.; Hendriks, R.;\
    \ Mulder, H.; Supit, I.; Van Walsum, P. SWAP\nVersion 4; Technical Report; Wageningen\
    \ Environmental Research: Wageningen, The Netherlands, 2017.\n38.\nVan Diepen,\
    \ C.v.; Wolf, J.; Van Keulen, H.; Rappoldt, C. WOFOST: A simulation model of crop\
    \ production. Soil Use Manag. 1989,\n5, 16–24. [CrossRef]\n39.\nAber, J.D.; Federer,\
    \ C.A. A generalized, lumped-parameter model of photosynthesis, evapotranspiration\
    \ and net primary\nproduction in temperate and boreal forest ecosystems. Oecologia\
    \ 1992, 92, 463–474. [CrossRef] [PubMed]\n40.\nDe Wit, C. Potential Photosynthesis\
    \ Crop Surfaces; Neth. J. Agric. Sci. 1959, 7, 141–149.\n41.\nJiang, T.; Dou,\
    \ Z.; Liu, J.; Gao, Y.; Malone, R.W.; Chen, S.; Feng, H.; Yu, Q.; Xue, G.; He,\
    \ J. Simulating the Inﬂuences of Soil Water\nStress on Leaf Expansion and Senescence\
    \ of Winter Wheat. Agric. For. Meteorol. 2020, 291, 108061. [CrossRef]\n42.\n\
    Woli, P.; Jones, J.W.; Ingram, K.T.; Fraisse, C.W. Agricultural Reference Index\
    \ for Drought (ARID). Agron. J. 2012, 104, 287–300.\n[CrossRef]\n43.\nZhao, C.;\
    \ Liu, B.; Xiao, L.; Hoogenboom, G.; Boote, K.J.; Kassie, B.T.; Pavan, W.; Shelia,\
    \ V.; Kim, K.S.; Hernandez-Ochoa, I.M.; et al.\nA SIMPLE crop model. Eur. J. Agron.\
    \ 2019, 104, 97–106. [CrossRef]\n44.\nHolzworth, D.P.; Huth, N.I.; deVoil, P.G.;\
    \ Zurcher, E.J.; Herrmann, N.I.; McLean, G.; Chenu, K.; van Oosterom, E.J.; Snow,\
    \ V.;\nMurphy, C.; et al. APSIM—Evolution towards a new generation of agricultural\
    \ systems simulation. Environ. Model. Softw. 2014,\n62, 327–350. [CrossRef]\n\
    45.\nWang, E.; Martre, P.; Zhao, Z.; Ewert, F.; Maiorano, A.; Rötter, R.P.; Kimball,\
    \ B.A.; Ottman, M.J.; Wall, G.W.; White, J.W.; et al.\nThe uncertainty of crop\
    \ yield projections is reduced by improved temperature response functions. Nat.\
    \ Plants 2017, 3, 17102.\n[CrossRef]\n46.\nDonatelli, M.; Magarey, R.D.; Bregaglio,\
    \ S.; Willocquet, L.; Whish, J.P.; Savary, S. Modelling the impacts of pests and\
    \ diseases on\nagricultural systems. Agric. Syst. 2017, 155, 213–224. [CrossRef]\n\
    47.\nRitchie, J. A user-orientated model of the soil water balance in wheat. In\
    \ Wheat Growth and Modelling; Springer: Berlin/Heidelberg,\nGermany, 1985; pp.\
    \ 293–305.\n48.\nCameron, K.; Di, H.J.; Moir, J. Nitrogen losses from the soil/plant\
    \ system: A review. Ann. Appl. Biol. 2013, 162, 145–173.\n[CrossRef]\n49.\nShibu,\
    \ M.; Leffelaar, P.; Van Keulen, H.; Aggarwal, P. LINTUL3, a simulation model\
    \ for nitrogen-limited situations: Application\nto rice. Eur. J. Agron. 2010,\
    \ 32, 255–271. [CrossRef]\n50.\nThornley, J.H.; France, J. Mathematical Models\
    \ in Agriculture: Quantitative Methods for the Plant, Animal and Ecological Sciences;\
    \ Cabi:\nWallingford, UK, 2007.\n51.\nZhang, S.; Tao, F.; Zhang, Z. Uncertainty\
    \ from model structure is larger than that from model parameters in simulating\
    \ rice\nphenology in China. Eur. J. Agron. 2017, 87, 30–39. [CrossRef]\n52.\n\
    Wallach, D.; Thorburn, P.J. Estimating uncertainty in crop model predictions:\
    \ Current situation and future prospects. Eur. J.\nAgron. 2017, 88, A1–A7. [CrossRef]\n\
    53.\nSowe, S.K.; Simmon, E.; Zettsu, K.; de Vaulx, F.; Bojanova, I. Cyber-Physical-Human\
    \ Systems: Putting People in the Loop. IT Prof.\n2016, 18, 10–13. [CrossRef]\n\
    54.\nMittelbach, H.; Lehner, I.; Seneviratne, S.I. Comparison of four soil moisture\
    \ sensor types under ﬁeld conditions in Switzerland. J.\nHydrol. 2012, 430, 39–49.\
    \ [CrossRef]\n55.\nKashyap, B.; Kumar, R. Sensing Methodologies in Agriculture\
    \ for Soil Moisture and Nutrient Monitoring. IEEE Access 2021,\n9, 14095–14121.\
    \ [CrossRef]\n56.\nZare, E.; Arshad, M.; Zhao, D.; Nachimuthu, G.; Triantaﬁlis,\
    \ J. Two-dimensional time-lapse imaging of soil wetting and drying\ncycle using\
    \ EM38 data across a ﬂood irrigation cotton ﬁeld. Agric. Water Manag. 2020, 241,\
    \ 106383. [CrossRef]\n57.\nZare, E.; Wang, J.; Zhao, D.; Arshad, M.; Triantaﬁlis,\
    \ J. Scope to map available water content using proximal sensed electromagnetic\n\
    induction and gamma-ray spectrometry data. Agric. Water Manag. 2021, 247, 106705.\
    \ [CrossRef]\n58.\nQu, Y.; Zhu, Y.; Han, W.; Wang, J.; Ma, M. Crop leaf area index\
    \ observations with a wireless sensor network and its potential for\nvalidating\
    \ remote sensing products. IEEE J. Sel. Top. Appl. Earth Obs. Remote Sens. 2013,\
    \ 7, 431–444. [CrossRef]\n59.\nViña, A.; Gitelson, A.A.; Nguy-Robertson, A.L.;\
    \ Peng, Y. Comparison of different vegetation indices for the remote assessment\
    \ of\ngreen leaf area index of crops. Remote Sens. Environ. 2011, 115, 3468–3478.\
    \ [CrossRef]\n60.\nLi, X.; Liu, Q.; Yang, R.; Zhang, H.; Zhang, J.; Cai, E. The\
    \ design and implementation of the leaf area index sensor. Sensors 2015,\n15,\
    \ 6250–6269. [CrossRef] [PubMed]\n61.\nNeale, C.M.U.; Geli, H.M.E.; Kustas, W.P.;\
    \ Alﬁeri, J.G.; Gowda, P.H.; Evett, S.R.; Prueger, J.H.; Hipps, L.E.; Dulaney,\
    \ W.P.; Chávez,\nJ.L.; et al. Soil water content estimation using a remote sensing\
    \ based hybrid evapotranspiration modeling approach. Adv. Water\nResour. 2012,\
    \ 50, 152–161. [CrossRef]\n62.\nDalezios, N.R.; Dercas, N.; Spyropoulos, N.V.;\
    \ Psomiadis, E. Remotely sensed methodologies for crop water availability and\n\
    requirements in precision farming of vulnerable agriculture. Water Resour. Manag.\
    \ 2019, 33, 1499–1519. [CrossRef]\n63.\nCampos, I.; González-Gómez, L.; Villodre,\
    \ J.; González-Piqueras, J.; Suyker, A.E.; Calera, A. Remote sensing-based crop\
    \ biomass\nwith water or light-driven crop growth models in wheat commercial ﬁelds.\
    \ Field Crop. Res. 2018, 216, 175–188. [CrossRef]\n64.\nMeng, B.; Ge, J.; Liang,\
    \ T.; Yang, S.; Gao, J.; Feng, Q.; Cui, X.; Huang, X.; Xie, H. Evaluation of remote\
    \ sensing inversion error for\nthe above-ground biomass of alpine meadow grassland\
    \ based on multi-source satellite data. Remote Sens. 2017, 9, 372. [CrossRef]\n\
    Water 2022, 14, 889\n34 of 37\n65.\nKumar, L.; Mutanga, O. Remote sensing of above-ground\
    \ biomass. Remote Sens. 2017, 9, 935. [CrossRef]\n66.\nLu, D.; Chen, Q.; Wang,\
    \ G.; Liu, L.; Li, G.; Moran, E. A survey of remote sensing-based aboveground\
    \ biomass estimation methods\nin forest ecosystems. Int. J. Digit. Earth 2016,\
    \ 9, 63–105. [CrossRef]\n67.\nKhanal, S.; Fulton, J.; Shearer, S. An overview\
    \ of current and potential applications of thermal remote sensing in precision\n\
    agriculture. Comput. Electron. Agric. 2017, 139, 22–32. [CrossRef]\n68.\nLu, L.;\
    \ Kuenzer, C.; Wang, C.; Guo, H.; Li, Q. Evaluation of three MODIS-derived vegetation\
    \ index time series for dryland\nvegetation dynamics monitoring. Remote Sens.\
    \ 2015, 7, 7597–7614. [CrossRef]\n69.\nShen, L.; He, Y.; Guo, X. Suitability of\
    \ the normalized difference vegetation index and the adjusted transformed soil-adjusted\n\
    vegetation index for spatially characterizing loggerhead shrike habitats in North\
    \ American mixed prairie. J. Appl. Remote Sens.\n2013, 7, 073574. [CrossRef]\n\
    70.\nRen, H.; Zhou, G.; Zhang, F. Using negative soil adjustment factor in soil-adjusted\
    \ vegetation index (SAVI) for aboveground\nliving biomass estimation in arid grasslands.\
    \ Remote Sens. Environ. 2018, 209, 439–445. [CrossRef]\n71.\nChao, Z.; Liu, N.;\
    \ Zhang, P.; Ying, T.; Song, K. Estimation methods developing with remote sensing\
    \ information for energy crop\nbiomass: A comparative review. Biomass Bioenergy\
    \ 2019, 122, 414–425. [CrossRef]\n72.\nAmaral, L.R.; Molin, J.P.; Portz, G.; Finazzi,\
    \ F.B.; Cortinove, L. Comparison of crop canopy reﬂectance sensors used to identify\n\
    sugarcane biomass and nitrogen status. Precis. Agric. 2015, 16, 15–28. [CrossRef]\n\
    73.\nKrienke, B.; Ferguson, R.B.; Schlemmer, M.; Holland, K.; Marx, D.; Eskridge,\
    \ K. Using an unmanned aerial vehicle to evaluate\nnitrogen variability and height\
    \ effect with an active crop canopy sensor. Precis. Agric. 2017, 18, 900–915.\
    \ [CrossRef]\n74.\nPeng, J.; Loew, A.; Zhang, S.; Wang, J.; Niesel, J. Spatial\
    \ downscaling of satellite soil moisture data using a vegetation temperature\n\
    condition index. IEEE Trans. Geosci. Remote Sens. 2015, 54, 558–566. [CrossRef]\n\
    75.\nCaldwell, T.G.; Bongiovanni, T.; Cosh, M.H.; Halley, C.; Young, M.H. Field\
    \ and laboratory evaluation of the CS655 soil water\ncontent sensor. Vadose Zone\
    \ J. 2018, 17, 1–16. [CrossRef]\n76.\nBittelli, M. Measuring soil water content:\
    \ A review. HortTechnology 2011, 21, 293–300. [CrossRef]\n77.\nZhao, Y.; Tong,\
    \ R.j.; Chen, M.Q.; Xia, F. Relative humidity sensor based on hollow core ﬁber\
    \ ﬁlled with GQDs-PVA. Sens. Actuators\nB Chem. 2019, 284, 96–102. [CrossRef]\n\
    78.\nChe, Y.; Ma, S.; Xing, F.; Li, S.; Dai, Y. An improvement of the retrieval\
    \ of temperature and relative humidity proﬁles from a\ncombination of active and\
    \ passive remote sensing. Meteorol. Atmos. Phys. 2019, 131, 681–695. [CrossRef]\n\
    79.\nYao, X.; Yao, X.; Jia, W.; Tian, Y.; Ni, J.; Cao, W.; Zhu, Y. Comparison\
    \ and intercalibration of vegetation indices from different\nsensors for monitoring\
    \ above-ground plant nitrogen uptake in winter wheat. Sensors 2013, 13, 3109–3130.\
    \ [CrossRef]\n80.\nYang, B.; Wang, M.; Sha, Z.; Wang, B.; Chen, J.; Yao, X.; Cheng,\
    \ T.; Cao, W.; Zhu, Y. Evaluation of aboveground nitrogen content of\nwinter wheat\
    \ using digital imagery of unmanned aerial vehicles. Sensors 2019, 19, 4416. [CrossRef]\
    \ [PubMed]\n81.\nSU, S.L.; Singh, D.; Baghini, M.S. A critical review of soil\
    \ moisture measurement. Measurement 2014, 54, 92–105. [CrossRef]\n82.\nFritz,\
    \ S.; See, L.; Bayas, J.C.L.; Waldner, F.; Jacques, D.; Becker-Reshef, I.; Whitcraft,\
    \ A.; Baruth, B.; Bonifacio, R.; Crutchﬁeld, J.;\net al. A comparison of global\
    \ agricultural monitoring systems and current gaps. Agric. Syst. 2019, 168, 258–272.\
    \ [CrossRef]\n83.\nChauhan, S.; Darvishzadeh, R.; Boschetti, M.; Pepe, M.; Nelson,\
    \ A. Remote sensing-based crop lodging assessment: Current\nstatus and perspectives.\
    \ ISPRS J. Photogramm. Remote Sens. 2019, 151, 124–140. [CrossRef]\n84.\nLi, X.;\
    \ McCarty, G.W. Application of topographic analyses for mapping spatial patterns\
    \ of soil properties. In Geospatial Analyses of\nEarth Observation (EO) Data;\
    \ IntechOpen: London, UK, 2019. [CrossRef]\n85.\nSreeja, B.; Manoj Kumar, S.;\
    \ Sherubha, P.; Sasirekha, S. Crop monitoring using wireless sensor networks.\
    \ Mater. Today Proc. 2020.\n[CrossRef]\n86.\nThakur, D.; Kumar, Y.; Kumar, A.;\
    \ Singh, P.K. Applicability of wireless sensor networks in precision agriculture:\
    \ A review. Wirel.\nPers. Commun. 2019, 107, 471–512. [CrossRef]\n87.\nCui, X.;\
    \ Guo, X.; Wang, Y.; Wang, X.; Zhu, W.; Shi, J.; Lin, C.; Gao, X. Application\
    \ of remote sensing to water environmental\nprocesses under a changing climate.\
    \ J. Hydrol. 2019, 574, 892–902. [CrossRef]\n88.\nLiu, C.A.; Chen, Z.X.; Yun,\
    \ S.H.A.O.; Chen, J.S.; Hasi, T.; PAN, H.Z. Research advances of SAR remote sensing\
    \ for agriculture\napplications: A review. J. Integr. Agric. 2019, 18, 506–525.\
    \ [CrossRef]\n89.\nBabaeian, E.; Sadeghi, M.; Jones, S.B.; Montzka, C.; Vereecken,\
    \ H.; Tuller, M. Ground, proximal, and satellite remote sensing of\nsoil moisture.\
    \ Rev. Geophys. 2019, 57, 530–616. [CrossRef]\n90.\nTenzin, S.; Siyang, S.; Pobkrut,\
    \ T.; Kerdcharoen, T. Low cost weather station for climate-smart agriculture.\
    \ In Proceedings\nof the 2017 9th international conference on knowledge and smart\
    \ technology (KST), Chonburi, Thailand, 1–4 February 2017;\npp. 172–177.\n91.\n\
    Walter, E.; Pronzato, L. Identiﬁcation of Parametric Models from Experimental\
    \ Data; Springer: Berlin/Heidelberg, Germany, 1997.\n92.\nKeesman, K.J. System\
    \ Identiﬁcation: An Introduction; Springer Science & Business Media: Berlin/Heidelberg,\
    \ Germany, 2011.\n93.\nWieland, F.G.; Hauber, A.L.; Rosenblatt, M.; Tönsing, C.;\
    \ Timmer, J. On structural and practical identiﬁability. Curr. Opin. Syst.\nBiol.\
    \ 2021, 25, 60–69. [CrossRef]\n94.\nBellu, G.; Saccomani, M.P.; Audoly, S.; D’Angiò,\
    \ L. DAISY: A new software tool to test global identiﬁability of biological and\n\
    physiological systems. Comput. Methods Programs Biomed. 2007, 88, 52–61. [CrossRef]\n\
    95.\nChis, O.; Banga, J.R.; Balsa-Canto, E. GenSSI: A software toolbox for structural\
    \ identiﬁability analysis of biological models.\nBioinformatics 2011, 27, 2610–2611.\
    \ [CrossRef]\nWater 2022, 14, 889\n35 of 37\n96.\nHong, H.; Ovchinnikov, A.; Pogudin,\
    \ G.; Yap, C. SIAN: Software for structural identiﬁability analysis of ODE models.\
    \ Bioinfor-\nmatics 2019, 35, 2873–2874. [CrossRef]\n97.\nVillaverde, A.F. Observability\
    \ and structural identiﬁability of nonlinear biological systems. Complexity 2019,\
    \ 2019. [CrossRef]\n98.\nMonod, H.; Naud, C.; Makowski, D. Uncertainty and sensitivity\
    \ analysis for crop models. In Working with Dynamic Crop Models:\nEvaluation,\
    \ Analysis, Parameterization, and Applications; Elsevier: Amsterdam, The Netherlands,\
    \ 2006; Volume 4, pp. 55–100.\n99.\nLamboni, M.; Makowski, D.; Lehuger, S.; Gabrielle,\
    \ B.; Monod, H. Multivariate global sensitivity analysis for dynamic crop\nmodels.\
    \ Field Crop. Res. 2009, 113, 312–320. [CrossRef]\n100. Sarrazin, F.; Pianosi,\
    \ F.; Wagener, T. Global Sensitivity Analysis of environmental models: Convergence\
    \ and validation. Environ.\nModel. Softw. 2016, 79, 135–152. [CrossRef]\n101.\
    \ Gunarathna, M.; Sakai, K.; Nakandakari, T.; Momii, K.; Kumari, M. Sensitivity\
    \ Analysis of Plant-and Cultivar-Speciﬁc Parameters\nof APSIM-Sugar Model: Variation\
    \ between Climates and Management Conditions. Agronomy 2019, 9, 242. [CrossRef]\n\
    102. Lauvernet, C.; Hascoet, L.; Le Dimet, F.X.; Baret, F. Using Automatic Differentiation\
    \ to study the sensitivity of a crop model. In\nRecent Advances in Algorithmic\
    \ Differentiation; Springer: Berlin/Heidelberg, Germany, 2012; pp. 59–69.\n103.\
    \ Brisson, N.; Gary, C.; Justes, E.; Roche, R.; Mary, B.; Ripoche, D.; Zimmer,\
    \ D.; Sierra, J.; Bertuzzi, P.; Burger, P.; et al. An overview\nof the crop model\
    \ STICS. Eur. J. Agron. 2003, 18, 309–332. [CrossRef]\n104. Vanuytrecht, E.; Raes,\
    \ D.; Steduto, P.; Hsiao, T.C.; Fereres, E.; Heng, L.K.; Vila, M.G.; Moreno, P.M.\
    \ AquaCrop: FAO’s crop water\nproductivity and yield response model. Environ.\
    \ Model. Softw. 2014, 62, 351–360. [CrossRef]\n105. Tittonell, P.; Corbeels, M.;\
    \ Van Wijk, M.T.; Giller, K.E. FIELD—A summary simulation model of the soil–crop\
    \ system to analyse\nlong-term resource interactions and use efﬁciencies at farm\
    \ scale. Eur. J. Agron. 2010, 32, 10–21. [CrossRef]\n106. Tremblay, M.; Wallach,\
    \ D. Comparison of parameter estimation methods for crop models. Agronomie 2004,\
    \ 24, 351–365. [CrossRef]\n107. Wallach, D.; Buis, S.; Lecharpentier, P.; Bourges,\
    \ J.; Clastre, P.; Launay, M.; Bergez, J.E.; Guerif, M.; Soudais, J.; Justes,\
    \ E. A package\nof parameter estimation methods and implementation for the STICS\
    \ crop-soil model. Environ. Model. Softw. 2011, 26, 386–394.\n[CrossRef]\n108.\
    \ Dumont, B.; Leemans, V.; Mansouri, M.; Bodson, B.; Destain, J.P.; Destain, M.F.\
    \ Parameter identiﬁcation of the STICS crop model,\nusing an accelerated formal\
    \ MCMC approach. Environ. Model. Softw. 2014, 52, 121–135. [CrossRef]\n109. Wallach,\
    \ D.; Nissanka, S.P.; Karunaratne, A.S.; Weerakoon, W.; Thorburn, P.J.; Boote,\
    \ K.J.; Jones, J.W. Accounting for both\nparameter and model structure uncertainty\
    \ in crop model predictions of phenology: A case study on rice. Eur. J. Agron.\
    \ 2017,\n88, 53–62. [CrossRef]\n110. Vrugt, J.A.; Ter Braak, C.J. DREAM (D): An\
    \ adaptive Markov Chain Monte Carlo simulation algorithm to solve discrete,\n\
    noncontinuous, and combinatorial posterior parameter estimation problems.\nHydrol.\
    \ Earth Syst. Sci. 2011, 15, 3701–3713.\n[CrossRef]\n111. Martí, R.; Resende,\
    \ M.G.; Ribeiro, C.C. Multi-start methods for combinatorial optimization. Eur.\
    \ J. Oper. Res. 2013, 226, 1–8.\n[CrossRef]\n112. Floudas, C.A.; Gounaris, C.E.\
    \ A review of recent advances in global optimization. J. Glob. Optim. 2009, 45,\
    \ 3–38. [CrossRef]\n113. Wallach, D.; Makowski, D.; Jones, J.W.; Brun, F. Working\
    \ with Dynamic Crop Models: Methods, Tools and Examples for Agriculture and\n\
    Environment; Academic Press: Cambridge, MA, USA, 2018.\n114. Yan, L.; Jin, J.;\
    \ Wu, P. Impact of parameter uncertainty and water stress parameterization on\
    \ wheat growth simulations using\nCERES-Wheat with GLUE. Agric. Syst. 2020, 181,\
    \ 102823. [CrossRef]\n115. Li, Z.; He, J.; Xu, X.; Jin, X.; Huang, W.; Clark,\
    \ B.; Yang, G.; Li, Z. Estimating genetic parameters of DSSAT-CERES model with\
    \ the\nGLUE method for winter wheat (Triticum aestivum L.) production. Comput.\
    \ Electron. Agric. 2018, 154, 213–221. [CrossRef]\n116. Jones, J.W.; He, J.; Boote,\
    \ K.J.; Wilkens, P.; Porter, C.; Hu, Z. Estimating DSSAT cropping system cultivar-speciﬁc\
    \ parameters using\nBayesian techniques. Methods Introd. Syst. Model. Into Agric.\
    \ Res. 2011, 2, 365–393.\n117. Seidel, S.J.; Palosuo, T.; Thorburn, P.; Wallach,\
    \ D. Towards improved calibration of crop models—Where are we now and where\n\
    should we go? Eur. J. Agron. 2018, 94, 25–35. [CrossRef]\n118. Zhang, T.; Su,\
    \ J.; Liu, C.; Chen, W.H. Bayesian calibration of AquaCrop model for winter wheat\
    \ by assimilating UAV multi-spectral\nimages. Comput. Electron. Agric. 2019, 167,\
    \ 105052. [CrossRef]\n119. Tennøe, S.; Halnes, G.; Einevoll, G.T. Uncertainpy:\
    \ A python toolbox for uncertainty quantiﬁcation and sensitivity analysis in\n\
    computational neuroscience. Front. Neuroinform. 2018, 12, 49. [CrossRef] [PubMed]\n\
    120. Herman, J.; Usher, W. SALib: An open-source Python library for sensitivity\
    \ analysis. J. Open Source Softw. 2017, 2, 97. [CrossRef]\n121. Woli, P.; Jones,\
    \ J.W.; Ingram, K.T. Assessing the Agricultural Reference Index for Drought (ARID)\
    \ Using Uncertainty and\nSensitivity Analyses. Agron. J. 2013, 105, 150–160. [CrossRef]\n\
    122. Huang, D.; Wang, J.; Khayatnezhad, M. Estimation of actual evapotranspiration\
    \ using soil moisture balance and remote sensing.\nIran. J. Sci. Technol. Trans.\
    \ Civ. Eng. 2021, 45, 2779–2786. [CrossRef]\n123. Lopez-Jimenez, J.; Quijano,\
    \ N.; Vande Wouwer, A. An Agent-Based Crop Model Framework for Heterogeneous Soils.\
    \ Agronomy\n2021, 11, 85. [CrossRef]\n124. Bogaerts, P.; Vande Wouwer, A. Software\
    \ sensors for bioprocesses. ISA Trans. 2003, 42, 547–558. [CrossRef]\n125. Goffaux,\
    \ G.; Vande Wouwer, A. Bioprocess state estimation: Some classical and less classical\
    \ approaches. In Control and Observer\nDesign for Nonlinear Finite and Inﬁnite\
    \ Dimensional Systems; Springer: Berlin/Heidelberg, Germany, 2005; pp. 111–128.\n\
    Water 2022, 14, 889\n36 of 37\n126. Villaverde, A.F.; Tsiantis, N.; Banga, J.R.\
    \ Full observability and estimation of unknown inputs, states and parameters of\
    \ nonlinear\nbiological models. J. R. Soc. Interface 2019, 16, 20190043. [CrossRef]\n\
    127. Zeitz, M. Observability canonical (phase-variable) form for non-linear time-variable\
    \ systems. Int. J. Syst. Sci. 1984, 15, 949–958.\n[CrossRef]\n128. Gauthier, J.P.;\
    \ Kupka, I.A. Observability and observers for nonlinear systems.\nSIAM J. Control.\
    \ Optim. 1994, 32, 975–994.\n[CrossRef]\n129. Moreno, J.A.; Rocha-Cózatl, E.;\
    \ Wouwer, A.V. A dynamical interpretation of strong observability and detectability\
    \ concepts\nfor nonlinear systems with unknown inputs: Application to biochemical\
    \ processes. Bioprocess Biosyst. Eng. 2014, 37, 37–49.\n[CrossRef] [PubMed]\n\
    130. Díaz-González, V.; Rojas-Palma, A.; Carrasco-Benavides, M. How Does Irrigation\
    \ Affect Crop Growth? A Mathematical Modeling\nApproach. Mathematics 2022, 10,\
    \ 151. [CrossRef]\n131. Bannister, R. A review of operational methods of variational\
    \ and ensemble-variational data assimilation. Q. J. R. Meteorol. Soc.\n2017, 143,\
    \ 607–633. [CrossRef]\n132. Dorigo, W.A.; Zurita-Milla, R.; de Wit, A.J.; Brazile,\
    \ J.; Singh, R.; Schaepman, M.E. A review on reﬂective remote sensing and data\n\
    assimilation techniques for enhanced agroecosystem modeling. Int. J. Appl. Earth\
    \ Obs. Geoinf. 2007, 9, 165–193. [CrossRef]\n133. Sedano, F.; Kempeneers, P.;\
    \ Hurtt, G. A Kalman ﬁlter-based method to generate continuous time series of\
    \ medium-resolution\nNDVI images. Remote Sens. 2014, 6, 12381–12408. [CrossRef]\n\
    134. Lü, H.; Yu, Z.; Zhu, Y.; Drake, S.; Hao, Z.; Sudicky, E.A. Dual state-parameter\
    \ estimation of root zone soil moisture by optimal\nparameter estimation and extended\
    \ Kalman ﬁlter data assimilation. Adv. Water Resour. 2011, 34, 395–406. [CrossRef]\n\
    135. Agyeman, B.T.; Bo, S.; Sahoo, S.R.; Yin, X.; Liu, J.; Shah, S.L. Soil moisture\
    \ map construction by sequential data assimilation using\nan extended Kalman ﬁlter.\
    \ J. Hydrol. 2021, 598, 126425. [CrossRef]\n136. Mansouri, M.; Dumont, B.; Destain,\
    \ M.F. Modeling and prediction of nonlinear environmental system using Bayesian\
    \ methods.\nComput. Electron. Agric. 2013, 92, 16–31. [CrossRef]\n137. Rui, L.;\
    \ Li, C.j.; Dong, Y.y.; Feng, L.; Wang, J.h.; Yang, X.d.; Pan, Y.c. Assimilation\
    \ of remote sensing and crop model for LAI\nestimation based on ensemble Kaiman\
    \ Filter. Agric. Sci. China 2011, 10, 1595–1602.\n138. Zhao, Y.; Chen, S.; Shen,\
    \ S. Assimilating remote sensing information with crop model using Ensemble Kalman\
    \ Filter for improving\nLAI monitoring and yield estimation. Ecol. Model. 2013,\
    \ 270, 30–42. [CrossRef]\n139. Huang, J.; Sedano, F.; Huang, Y.; Ma, H.; Li, X.;\
    \ Liang, S.; Tian, L.; Zhang, X.; Fan, J.; Wu, W. Assimilating a synthetic Kalman\n\
    ﬁlter leaf area index series into the WOFOST model to improve regional winter\
    \ wheat yield estimation. Agric. For. Meteorol. 2016,\n216, 188–202. [CrossRef]\n\
    140. Nagarajan, K.; Judge, J.; Graham, W.D.; Monsivais-Huertero, A. Particle ﬁlter-based\
    \ assimilation algorithms for improved\nestimation of root-zone soil moisture\
    \ under dynamic vegetation conditions. Adv. Water Resour. 2011, 34, 433–447. [CrossRef]\n\
    141. Fang, H.; Liang, S.; Hoogenboom, G.; Teasdale, J.; Cavigelli, M. Corn-yield\
    \ estimation through assimilation of remotely sensed\ndata into the CSM-CERES-Maize\
    \ model. Int. J. Remote Sens. 2008, 29, 3011–3032. [CrossRef]\n142. Yildirak,\
    \ K.; Kalaylıoglu, Z.; Mermer, A. Bayesian estimation of crop yield function:\
    \ Drought based wheat prediction model for\ntigem farms. Environ. Ecol. Stat.\
    \ 2015, 22, 693–704. [CrossRef]\n143. Nychka, D.; Anderson, J.L. Data assimilation.\
    \ In Handbook of Spatial Statistics; CRC Press: Boca Raton, FL, USA, 2010; pp.\
    \ 477–492.\n144. Chen, Y.; Cournède, P.H. Data assimilation to reduce uncertainty\
    \ of crop model prediction with convolution particle ﬁltering.\nEcol. Model. 2014,\
    \ 290, 165–177. [CrossRef]\n145. Visioli, A. Practical PID Control; Springer Science\
    \ & Business Media: Berlin/Heidelberg, Germany, 2006.\n146. Goodchild, M.; Kühn,\
    \ K.; Jenkins, M.; Burek, K.; Button, A. A method for precision closed-loop irrigation\
    \ using a modiﬁed PID\ncontrol algorithm. Sens. Transducers 2015, 188, 61.\n147.\
    \ Goodchild, M.S.; Jenkins, M.D.; Whalley, W.R.; Watts, C.W. A novel dielectric\
    \ tensiometer enabling precision PID-based irrigation\ncontrol of polytunnel-grown\
    \ strawberries in coir. Biosyst. Eng. 2018, 165, 70–76. [CrossRef]\n148. Lozoya,\
    \ C.; Mendoza, C.; Aguilar, A.; Román, A.; Castelló, R. Sensor-based model driven\
    \ control strategy for precision irrigation.\nJ. Sens. 2016, 2016, 9784071 . [CrossRef]\n\
    149. Lozoya, C.; Mendoza, C.; Mejía, L.; Quintana, J.; Mendoza, G.; Bustillos,\
    \ M.; Arras, O.; Solís, L. Model predictive control for\nclosed-loop irrigation.\
    \ Ifac Proc. Vol. 2014, 47, 4429–4434. [CrossRef]\n150. Balbis, L. Economic Model\
    \ Predictive Control for Irrigation Systems. In Proceedings of the 2019 8th International\
    \ Conference on\nModeling Simulation and Applied Optimization (ICMSAO), Manama,\
    \ Bahrain, 5–17 April 2019; pp. 1–4.\n151. Delgoda, D.; Malano, H.; Saleem, S.K.;\
    \ Halgamuge, M.N. Irrigation control based on model predictive control (MPC):\
    \ Formulation\nof theory and validation using weather forecast data and AQUACROP\
    \ model. Environ. Model. Softw. 2016, 78, 40–53. [CrossRef]\n152. Shang, C.; Chen,\
    \ W.H.; Stroock, A.D.; You, F. Robust model predictive control of irrigation systems\
    \ with active uncertainty\nlearning and data analytics. IEEE Trans. Control. Syst.\
    \ Technol. 2019, 28, 1493–1504. [CrossRef]\n153. Winkler, D.A.; Carreira-Perpiñán,\
    \ M.Á.; Cerpa, A.E. Plug-and-play irrigation control at scale. In Proceedings\
    \ of the 2018 17th\nACM/IEEE International Conference on Information Processing\
    \ in Sensor Networks (IPSN), Porto, Portugal, 11–13 April 2018;\npp. 1–12.\n154.\
    \ Liu, Z.; Xu, Q. An automatic irrigation control system for soilless culture\
    \ of lettuce. Water 2018, 10, 1692. [CrossRef]\nWater 2022, 14, 889\n37 of 37\n\
    155. Chrouta, J.; Chakchouk, W.; Zaafouri, A.; Jemli, M. Modeling and control\
    \ of an irrigation station process using heterogeneous\ncuckoo search algorithm\
    \ and fuzzy logic controller. IEEE Trans. Ind. Appl. 2018, 55, 976–990. [CrossRef]\n\
    156. Mendes, W.R.; Araújo, F.M.U.; Dutta, R.; Heeren, D.M. Fuzzy control system\
    \ for variable rate irrigation using remote sensing.\nExpert Syst. Appl. 2019,\
    \ 124, 13–24. [CrossRef]\n157. Marinescu, T.; Arghira, N.; Hossu, D.; Fagarasan,\
    \ I.; Stamatescu, I.; Stamatescu, G.; Caloﬁr, V.; Iliescu, S. Advanced control\n\
    strategies for irrigation systems. In Proceedings of the 2017 9th IEEE International\
    \ Conference on Intelligent Data Acquisition and\nAdvanced Computing Systems:\
    \ Technology and Applications (IDAACS), Bucharest, Romania, 21–23 September 2017;\
    \ Volume 2,\npp. 843–848.\n158. Lopez-Jimenez, J.; Quijano, N.; Vande Wouwer,\
    \ A. Towards agent-based modeling of crop irrigation. In Proceedings of the\n\
    11th International Conference on Simulation and Modelling in the Food and Bio-Industry\
    \ (FOODSIM), Ghent, Belgium, 6–10\nSeptember 2020; pp. 185–189.\n159. Thieu, N.;\
    \ Fredlund, D.; Hung, V. General partial differential equation solvers for saturated-unsaturated\
    \ seepage. In Unsaturated\nSoils for Asia; CRC Press: Boca Raton, FL, USA, 2020;\
    \ pp. 201–206.\n160. Rai, P.K.; Tripathi, S. Gaussian process for estimating parameters\
    \ of partial differential equations and its application to the\nRichards equation.\
    \ Stoch. Environ. Res. Risk Assess. 2019, 33, 1629–1649. [CrossRef]\n161. Mewes,\
    \ B.; Schumann, A.H. IPA (v1): A framework for agent-based modelling of soil water\
    \ movement. Geosci. Model Dev. 2018,\n11, 2175–2187. [CrossRef]\n162. Whitman,\
    \ J.E.; Maske, H.; Kingravi, H.A.; Chowdhary, G. Evolving Gaussian Processes and\
    \ Kernel Observers for Learning and\nControl in Spatiotemporally Varying Domains:\
    \ With Applications in Agriculture, Weather Monitoring, and Fluid Dynamics.\n\
    IEEE Control Syst. Mag. 2021, 41, 30–69. [CrossRef]\n"
  inline_citation: '>'
  journal: Water (Basel)
  limitations: '>'
  pdf_link: https://www.mdpi.com/2073-4441/14/6/889/pdf?version=1647444247
  publication_year: 2022
  relevance_score1: 0
  relevance_score2: 0
  title: 'Dynamic Modeling of Crop–Soil Systems to Design Monitoring and Automatic
    Irrigation Processes: A Review with Worked Examples'
  verbatim_quote1: '>'
  verbatim_quote2: '>'
  verbatim_quote3: '>'
